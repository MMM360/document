(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1538:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var r=n(0),o=n.n(r),a=n(32),i=n(647),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={signType:r.props.signType||"login"},r.handleChangeSignType=function(e){r.setState({signType:e})},u(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),c(t,[{key:"render",value:function(){var e=this.props.onClose;return o.a.createElement(a.b,{className:"signFlowModal",onClose:e},o.a.createElement(i.a,{signType:this.state.signType,onChangeSignType:this.handleChangeSignType}))}}]),t}()},2119:function(e,t,n){},2120:function(e,t,n){},2195:function(e,t,n){},2831:function(e,t,n){"use strict";n.r(t);var r,o,a,i,c,u=n(1),l=n.n(u),s=n(0),p=n.n(s),f=n(13),d=n(196),h=n(94),m=n(4),b=n(132),y=n(9),v=n(63),g=n(102),E=n(435),w=n(436),C=n(79),O=(n(2195),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),P=(i=["","s 后可重发"],c=["","s 后可重发"],Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(c)}})));function N(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var T,k,_=Object(f.connect)(function(e){return{isIOS:e.env.userAgent.iOS}})((a=o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),S(t,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.startAtOnce,r=e.interceptTime,o=e.resetText,a=e.manualValidateError,i=e.onChange,c=e.validations,u=e.countDownEndEvent,l=e.reStartTime,s=e.isIOS,f=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["countDownEvent","startAtOnce","interceptTime","resetText","manualValidateError","onChange","validations","countDownEndEvent","reStartTime","isIOS"]);return p.a.createElement("div",{className:"SignFlow SignFlow-smsBindPhoneInputContainer"},p.a.createElement(C.a,O({name:"digits",className:"SignFlow-smsBindPhoneInput",type:s?"tel":"number",errorMessageClassName:"SignFlow-smsBindPhoneInputErrorMask",placeholder:"输入 6 位验证码",manualValidateError:a,onChange:i,validations:[{type:"required",message:"请填写验证码",className:"SignFlow-smsInputBindPhoneRequiredErrorMask"}].concat(N(c||[]))},f)),p.a.createElement(E.a,{className:"SignFlow-smsBindPhoneInputButton",preset:"plain",initialText:"发送验证码",resetText:o,countingText:Object(w.a)(P,"count"),startAtOnce:n,event:t,countDownEndEvent:u,interceptTime:r,reStartTime:l}))}}]),t}(),o.propTypes={countDownEvent:l.a.func.isRequired,startAtOnce:l.a.bool,interceptTime:l.a.number,resetText:l.a.string,manualValidateError:l.a.string},o.defaultProps={startAtOnce:!1,resetText:"重发验证码"},r=a))||r,j=n(10),B=(n(2119),n(2120),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var I,R,A=(k=T=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=D(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,showFooter:!1,sendValidationCodeButtonText:"发送验证码",identifyingCodeError:null},r.testPhoneNo=function(){var e=r.state,t=e.selectedCountry.code,n=e.phoneNo;return"+86"!==t||/^\d{11}$/.test(n)},r.handleChange=function(e){return function(t){r.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t))}},r.handleSendDigits=function(e){var t=r.props.requestPhoneVerificationCode,n=r.state,o=n.selectedCountry.code,a=n.phoneNo,i=n.manualError;if(y.default.trackEvent(e.target,{action:"GetCaptcha"}),r.testPhoneNo())return t(""+o+a).then(function(){r.setState({manualError:null})}).catch(function(e){var t=e.payload,n=(t=void 0===t?{}:t).message;return r.setState({manualError:n,smsInputInterceptTime:Date.now()})});return r.setState({manualError:"请输入正确的手机号"===i?" 请输入正确的手机号":"请输入正确的手机号",smsInputInterceptTime:Date.now()})},r.handleSubmit=function(e){var t=e.phoneNo,n=e.digits,o=r.props,a=o.updatePhoneNumber,i=o.onSuccess,c=o.onNeedUnbind,u=r.state,l=u.selectedCountry.code,s=u.identifyingCodeError;a(""+l+t,n).then(function(e){var n=e.payload,r=n.data;if(n.success)return i();var o=r.bindedAccountFullname,a=r.requestAccountFullname;return c({phoneNumber:t,bindName:o,requiredName:a})}).catch(function(e){var t=e.payload,n=(t=void 0===t?{}:t).code,o=t.message;n===j.t&&r.setState({identifyingCodeError:s===o?" "+o:o})})},r.handleZaOK=function(e){y.default.trackEvent(e.target,{action:"Ok"})},r.renderContent=function(){var e=r.state,t=e.smsInputInterceptTime,n=e.manualError,o=e.sendValidationCodeButtonText,a=e.identifyingCodeError;return p.a.createElement("div",{ref:function(e){r.container=e}},p.a.createElement(v.b,{className:"SignFlowActive SignFlow BindPhoneForm",onSubmit:r.handleSubmit},!1,p.a.createElement(g.a,{type:"register",supportedCountriesShown:!0,manualValidateError:n,onSelect:r.handleChange("selectedCountry"),onChange:r.handleChange("phoneNo")}),p.a.createElement(_,{key:"sms-input",resetText:o,interceptTime:t,countDownEvent:r.handleSendDigits,manualValidateError:a}),p.a.createElement("div",{className:"BindPhone-helpWrapper"},p.a.createElement(m.c,{className:"BindPhone-helpText",preset:"link",onClick:function(){r.setState({showFooter:!0})}},"需要帮助？")),p.a.createElement(m.c,{className:"SignFlowActive-sendDigits",preset:"primary",color:"blue",type:"submit",onClick:r.handleZaOK},"确认")))},D(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),B(t,[{key:"componentDidMount",value:function(){y.default.setModule(this.container,{module:"BindPhoneForm"}),y.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose,t=this.state.showFooter;return p.a.createElement(b.b,{title:"设置手机号",subtitle:"绑定手机后，你就可以使用知乎的提问、回答、评论等功能。",footer:t?"如需要帮助，请联系 i@zhihu.com，我们会尽快帮你解决":null,onClose:e,size:"default"},this.renderContent())}}]),t}(),T.propTypes={requestPhoneVerificationCode:l.a.func.isRequired,updatePhoneNumber:l.a.func.isRequired,onClose:l.a.func.isRequired,onSuccess:l.a.func.isRequired,onNeedUnbind:l.a.func.isRequired},k),q=n(37),F=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function U(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var x,M,V=(R=I=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=U(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.zaKnowMore=function(e){y.default.trackEvent(e.target,{action:"OpenUrl",name:"了解更多"})},r.toBindPhone=function(e){var t=r.props.onBindPhone;y.default.trackEvent(e.target,{action:"OpenUrl",name:"去绑定手机"}),t()},r.handleClose=function(e){var t=r.props,n=t.onClose,o=t.config.canWrite;y.default.trackEvent(e.target,{action:"Cancel",name:o?"暂不绑定":"取消"}),n()},r.renderContent=function(){var e=r.props.config,t=e.tip,n=e.canWrite;return p.a.createElement("div",{ref:function(e){r.container=e}},p.a.createElement("p",null,t,p.a.createElement(q.a,{preset:"link",target:"_blank",href:"https://zhuanlan.zhihu.com/p/27257715",onClick:r.zaKnowMore},"了解更多")),p.a.createElement("div",{className:"BindPhone-buttonSection"},p.a.createElement(q.a,{className:"BindPhone-button",onClick:r.handleClose},n?"暂不绑定":"取消"),p.a.createElement(m.c,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:r.toBindPhone},"去绑定手机")))},U(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),F(t,[{key:"componentDidMount",value:function(){y.default.setModule(this.container,{module:"BindPhoneForm"}),y.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose;return p.a.createElement(b.b,{className:!1,title:"绑定手机",onClose:e,size:"default"},this.renderContent())}}]),t}(),I.propTypes={config:l.a.object,onClose:l.a.func,onBindPhone:l.a.func},R),z=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function W(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var H,L,K=(M=x=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=W(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.handleCancel=function(e){var t=r.props.onClose;y.default.trackEvent(e.target,{action:"Cancel",name:"不绑定"}),t()},W(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),z(t,[{key:"componentDidMount",value:function(){y.default.setModule(this.container,{module:"BindMailForm"}),y.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props.onClose;return p.a.createElement(b.b,{className:!1,title:"手机号绑定成功",onClose:t,size:"default"},p.a.createElement("div",{ref:function(t){e.container=t}},p.a.createElement("p",null,"由于你此前绑定的邮箱未经验证，未来请使用手机号登录知乎。"),p.a.createElement(m.c,{className:"BindPhone-remindLoginWithPhoneButton",onClick:this.handleCancel,preset:"primary",color:"blue"},"知道了")))}}]),t}(),x.propTypes={onClose:l.a.func},M),G=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var J,Z,$=(L=H=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=Y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.handleCancel=function(e){var t=r.props.onCancel;y.default.trackEvent(e.target,{action:"Click",name:"暂不绑定"}),t()},r.handleConfirm=function(e){var t=r.props.onConfirm;y.default.trackEvent(e.target,{action:"Click",name:"确认解绑"}),t()},Y(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),G(t,[{key:"componentDidMount",value:function(){y.default.setModule(this.container,{module:"BindPhoneFailForm"}),y.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.phoneNumber,o=t.bindName,a=t.requiredName;return p.a.createElement(b.b,{className:!1,title:"绑定失败",onClose:n,size:"default"},p.a.createElement("div",{ref:function(t){e.container=t}},p.a.createElement("p",null,"你所输入的手机号 ",r," 已经被绑定到帐号「",o,"」。"),!1,p.a.createElement("p",null,"你可以选择将该手机号从该帐号中解绑，并绑定至当前帐号「",a,"」。"),!1,p.a.createElement("p",null,p.a.createElement("b",null,"解绑后，你将无法再通过手机号登录原帐号「",o,"」。")),p.a.createElement("div",{className:"BindPhone-buttonSection"},p.a.createElement(m.c,{className:"BindPhone-button",onClick:this.handleConfirm},"确认解绑"),p.a.createElement(m.c,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel},"暂不绑定"))))}}]),t}(),H.propTypes={onClose:l.a.func.isRequired,onCancel:l.a.func.isRequired,onConfirm:l.a.func.isRequired,phoneNumber:l.a.string.isRequired,bindName:l.a.string.isRequired,requiredName:l.a.string.isRequired},L),Q=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function X(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ee=(Z=J=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=X(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.handleUnbind=function(e){var t=r.props,n=t.onSuccess,o=t.monopolizePhoneNumber,a=t.showNotification;y.default.trackEvent(e.target,{action:"Click",name:"确认解绑"}),o().then(function(){return a("绑定成功！","white"),n()})},r.handleCancel=function(e){var t=r.props.onCancel;y.default.trackEvent(e.target,{action:"Click",name:"暂不绑定"}),t()},X(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),Q(t,[{key:"componentDidMount",value:function(){y.default.setModule(this.container,{module:"BindPhoneVerifyForm"}),y.default.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.bindName;return p.a.createElement(b.b,{className:!1,title:"解绑手机",onClose:n,size:"default"},p.a.createElement("div",{ref:function(t){e.container=t}},p.a.createElement("p",null,p.a.createElement("b",null,"解绑操作无法撤销。")),!1,p.a.createElement("p",null,"如果你没有其他登录方式，你将无法再使用帐号「",r,"」。"),p.a.createElement("div",{className:"BindPhone-buttonSection"},p.a.createElement(m.c,{className:"BindPhone-button",onClick:this.handleUnbind},"确认解绑"),p.a.createElement(m.c,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel},"暂不绑定"))))}}]),t}(),J.propTypes={onClose:l.a.func.isRequired,onSuccess:l.a.func.isRequired,onCancel:l.a.func.isRequired,bindName:l.a.string.isRequired,showNotification:l.a.func.isRequired,monopolizePhoneNumber:l.a.string.isRequired},Z),te=n(90),ne=n(18),re=n(14);n.d(t,"default",function(){return pe});var oe,ae,ie,ce=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function ue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var le="LOGIN_WITH_PHONE",se="NEED_UNBIND",pe=Object(h.b)()(oe=Object(f.connect)(function(e,t){var n=e.account,r=t.currentUser,o=r.isActive,a=r.email;return{account:n,hasActiveEmail:o&&a,needShowLoginWithPhoneNumber:!o&&!!a,config:j.G}},{requestPhoneVerificationCode:te.l,updatePhoneNumber:te.v,monopolizePhoneNumber:te.i,showNotification:re.g,getUnlockRequest:te.g,unlockTicketByDigits:te.q,requestUnlockTicket:te.m,unlockTicketByPassword:te.r,loadCurrentUser:ne.j})(oe=Object(h.a)({load:function(e){return e.loadCurrentUser("email,is_active")},shouldLoad:function(e){if(!e.currentUser)return!1;var t=e.currentUser,n=t.email,r=t.isActive;return void 0===n||void 0===r}})((ie=ae=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=ue(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={},r.handleBindPhoneSuccess=function(){var e=r.props,t=e.needShowLoginWithPhoneNumber,n=e.showNotification,o=e.onToggle;return t?r.goToStep(le)():(n("绑定成功！","white"),setTimeout(function(){return location.reload()},2e3),o())},r.handleNeedUnbind=function(e){var t=e.bindName,n=e.phoneNumber,o=e.requiredName;return r.setState({bindName:t,phoneNumber:n,requiredName:o,step:se})},r.goToStep=function(e){return function(){return r.setState({step:e})}},r.handleCloseWithReload=function(){return location.reload()},ue(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),ce(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.getUnlockRequest,r=t.hasActiveEmail,o=t.shown,a=t.account,i=a.errorStatus,c=a.challenge,u=document.querySelector(".VerificationDialogModalHeader");if(e.shown&&!o){n();var l="";l=r?"CONFIRM_BIND_PHONE":i&&!u&&c&&c.length?"SAFETY_VERIFICATION":"BIND_PHONE",this.setState({step:l})}}},{key:"render",value:function(){var e=this.props,t=e.shown,n=e.requestPhoneVerificationCode,r=e.updatePhoneNumber,o=e.monopolizePhoneNumber,a=e.showNotification,i=e.config,c=e.account,u=e.unlockTicketByDigits,l=e.requestUnlockTicket,s=e.unlockTicketByPassword,f=e.onToggle,h=this.state,m=h.step,b=h.bindName,y=h.phoneNumber,v=h.requiredName;return t?"CONFIRM_BIND_PHONE"===m?p.a.createElement(V,{onBindPhone:this.goToStep("SAFETY_VERIFICATION"),onClose:f,config:i}):"BIND_PHONE"===m?p.a.createElement(A,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onNeedUnbind:this.handleNeedUnbind,requestPhoneVerificationCode:n,updatePhoneNumber:r}):m===le?p.a.createElement(K,{onClose:this.handleCloseWithReload}):m===se?p.a.createElement($,{onClose:f,onCancel:this.goToStep("BIND_PHONE"),onConfirm:this.goToStep("CONFIRM_UNBIND"),bindName:b,phoneNumber:y,requiredName:v}):"CONFIRM_UNBIND"===m?p.a.createElement(ee,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onCancel:this.goToStep("BIND_PHONE"),bindName:b,monopolizePhoneNumber:o,showNotification:a}):"SAFETY_VERIFICATION"===m?p.a.createElement(d.a,{isShown:!0,account:c,unlockTicketByDigits:u,requestUnlockTicket:l,unlockTicketByPassword:s,onClose:f,onSuccess:this.goToStep("BIND_PHONE"),zaModuleName:"BindMailForm"}):null:null}}]),t}(),ae.propTypes={shown:l.a.bool.isRequired,onToggle:l.a.func.isRequired,needShowLoginWithPhoneNumber:l.a.bool.isRequired,config:l.a.object.isRequired,requestPhoneVerificationCode:l.a.func.isRequired,updatePhoneNumber:l.a.func.isRequired,monopolizePhoneNumber:l.a.func.isRequired},oe=ie))||oe)||oe)||oe},2833:function(e,t,n){"use strict";n.r(t);var r,o,a,i=n(1),c=n.n(i),u=n(0),l=n.n(u),s=n(13),p=n(4),f=n(537),d=n(18),h=n(63),m=n(102),b=n(160),y=(n(2119),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}());var v,g,E=Object(s.connect)(function(e){var t=e.active;return{sendDigitsError:t.sendDigitsError,activeConfirmSucceeded:t.activeConfirmSucceeded,activeConfirmError:t.activeConfirmError}},{getUnlockTicketAndDigits:f.c,activeUserByEmail:f.a,validateAndActiveUserByDigits:f.d,activeUser:d.b})((a=o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkUserAccountType=function(e){return e.email?"email":"noInfo"},n.handleChange=function(e,t){n.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t))},n.handleChangeSmsType=function(){n.setState(function(e){var t=e.smsType;return{smsType:"text"===t?"voice":"text",smsBackUpName:"text"===t?"短信":"语音",reStartTime:Date.now()}})},n.handleCountDownEndEvent=function(){n.setState({smsBackUpDisplay:!0})},n.handleSendDigits=function(){var e=n.props.getUnlockTicketAndDigits,t=n.state,r=t.selectedCountry.code,o=t.phoneNo,a=t.smsType;n.setState({manualError:null},function(){if(o)return e({newPhoneNo:""+r+o,smsType:a}),void n.setState({smsBackUpDisplay:!1});n.setState({manualError:"请输入手机号",smsInputInterceptTime:Date.now()})})},n.handleSubmit=function(e){var t=n.props,r=t.email,o=t.activeUserByEmail,a=t.validateAndActiveUserByDigits,i=t.onClose,c=n.state,u=c.accountType,l=c.selectedCountry.code,s=e.username,p=e.digits;"email"===u?(o({email:r}),"function"==typeof i&&i()):a({newPhoneNo:""+l+s,digits:p})},n.parseServerError=function(){var e=n.props,t=e.activeConfirmError,r=e.sendDigitsError,o=t||{},a=o.username,i=o.digits,c=(r||{}).username;return{usernameServerError:a||c,digitsServerError:i}},n.renderAccountInfo=function(){var e=n.props.email,t=n.state,r=t.accountType,o=t.manualError,a=n.parseServerError().usernameServerError;return"noInfo"!==r?l.a.createElement("div",{className:"SignFlowActive-account"},e,"email"===r&&l.a.createElement("a",{target:"_blank",href:"/settings/account",className:"SignFlowActive-editEmail"},"修改邮箱")):l.a.createElement(m.a,{type:"digits",supportedCountriesShown:!0,manualValidateError:a||o,onSelect:function(e){return n.handleChange("selectedCountry",e)},onChange:function(e){return n.handleChange("phoneNo",e)}})},n.state={accountType:n.checkUserAccountType(e),selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,smsType:"text",smsBackUpName:"语音",smsBackUpDisplay:!0,reStartTime:-1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),y(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.sendDigitsError,r=t.onClose,o=t.activeUser,a=e.activeConfirmSucceeded,i=e.sendDigitsError;a?(r(),o()):!n&&i&&(this.setState({smsInputInterceptTime:Date.now()}),this.handleCountDownEndEvent())}},{key:"render",value:function(){var e=this.state,t=e.accountType,n=e.smsInputInterceptTime,r=e.smsType,o=e.smsBackUpName,a=e.smsBackUpDisplay,i=e.reStartTime,c=this.parseServerError().digitsServerError;return l.a.createElement(h.b,{className:"SignFlowActive SignFlow",onSubmit:this.handleSubmit},this.renderAccountInfo(),"email"!==t&&[l.a.createElement(b.a,{key:"sms-input",manualValidateError:c,interceptTime:n,countDownEvent:this.handleSendDigits,countDownEndEvent:this.handleCountDownEndEvent,smsType:r,reStartTime:i}),a&&l.a.createElement("div",{key:"smsBackUp-button",className:"SignFlowActive-options"},l.a.createElement(p.c,{preset:"plain",className:"SignFlowActive-cutSmsType",onClick:this.handleChangeSmsType},"接收"+o+"验证码"))],l.a.createElement(p.c,{className:"email"===t?"SignFlowActive-sendEmail":"SignFlowActive-sendDigits",preset:"primary",color:"blue",type:"submit"},"email"===t?"发送激活邮件":"激活"))}}]),t}(),o.propTypes={email:c.a.string,sendDigitsError:c.a.object,getUnlockTicketAndDigits:c.a.func,activeUserByEmail:c.a.func,validateAndActiveUserByEmail:c.a.func,activeConfirmSucceeded:c.a.bool,activeConfirmError:c.a.object,onClose:c.a.func},r=a))||r,w=n(32),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var P,N,T=(g=v=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={snackbar:null},r.handleSetSnackbar=function(e){return r.setState({snackbar:e})},S(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),O(t,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.onClose,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["shown","onClose"]);return l.a.createElement(w.b,{className:"SignFlow-modal",title:"激活帐号",subtitle:"为了正常使用知乎的提问、回答、评论和编辑功能，请绑定你的手机",onClose:n,maskClosable:!1,footer:this.state.snackbar},t&&l.a.createElement(E,C({onClose:n,onSetSnackbar:this.handleSetSnackbar},r)))}}]),t}(),v.propTypes={shown:c.a.bool.isRequired,onClose:c.a.func.isRequired},g),k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var j,B,D=(N=P=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),_(t,[{key:"render",value:function(){var e=this.props,t=e.isInModal,n=e.shown,r=e.onClose,o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["isInModal","shown","onClose"]);return l.a.createElement("div",null,t?l.a.createElement(T,k({onClose:r,shown:n},o)):l.a.createElement(E,o))}}]),t}(),P.propTypes={isInModal:c.a.bool,shown:c.a.bool,onClose:c.a.func},P.defaultProps={isInModal:!1},N),I=(n(430),D),R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var q=(B=j=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),A(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["type"]),r=R({isInModal:!0},n);return l.a.createElement("div",{className:"SignFlowModal"},l.a.createElement(I,R({},r,{shown:"active"===t})))}}]),t}(),j.propTypes={type:c.a.oneOf(["initial","active"]),onClose:c.a.func.isRequired},B);t.default=q}}]);
//# sourceMappingURL=main.signflow.50bc68a978b7a28a23c9.js.map