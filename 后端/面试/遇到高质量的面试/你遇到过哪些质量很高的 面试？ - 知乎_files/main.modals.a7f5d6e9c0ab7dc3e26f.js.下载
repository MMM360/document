(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1574:function(e,t,n){"use strict";var o=n(1),r=n.n(o),a=n(0),i=n.n(a),s=n(2),l=n.n(s),c=n(26),u=n.n(c),p=n(59),m=n.n(p),d=n(1585),f=n(1714),h=n(1591),v=(n(1604),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var y=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.state={isInputing:!1,value:a.props.value||""},a.handleChange=function(e){a.setState({value:Object(d.cutStringWidth)(e.target.value,30)})},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),v(t,[{key:"componentWillReceiveProps",value:function(e){e.value&&e.value!==this.state.value&&this.setState({value:e.value})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isInputing,o=t.value,r=this.props.onChange,a=!n&&!o,s=!n&&o;return i.a.createElement("div",{className:"Editable-VideoTitleInput-container"},i.a.createElement(h.a,null,i.a.createElement("div",{className:l()("Editable-VideoTitleInput-innerContainer",{"Editable-VideoTitleInput-innerContainer--isBeforeIconShown":a}),onClick:function(){return e.setState({isInputing:!0})}},a&&i.a.createElement(f.a,{className:"Editable-VideoTitleInput-beforeIcon",center:!0}),!n&&i.a.createElement("div",{className:l()("Editable-VideoTitleInput-value",{"Editable-VideoTitleInput-value--noContent":!o})},o||"好的标题可以获得更多的推荐及关注者"),n&&i.a.createElement("input",{className:"Editable-VideoTitleInput",value:o,ref:function(e){e&&e.focus()},placeholder:"标题长度不超过 15 个字",onChange:this.handleChange,onBlur:function(t){e.setState({isInputing:!1}),r(t.target.value)}}),s&&i.a.createElement(f.a,{className:"Editable-VideoTitleInput-afterIcon",center:!0}))))}}]),t}(),b=n(1575),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var w=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.state={shown:!1},a.handleObserve=function(e){(e[0].isIntersecting||e[0].intersectionRatio>0)&&a.setState({shown:!0})},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),g(t,[{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.rootMargin,o=e.children;return this.state.shown?o:i.a.createElement(b.a,{rootMargin:n,onObserve:this.handleObserve,threshold:[0,.1]},t||i.a.createElement("div",{style:{height:"1px"}}))}}]),t}();w.propTypes={placeholder:r.a.element,rootMargin:r.a.string},w.defaultProps={rootMargin:"200px"};var C=w,E=n(1715),O=n(1605),k=n.n(O),P=function(e){var t=e.className;return i.a.createElement("svg",{viewBox:"0 0 72 72",className:t},i.a.createElement("circle",{cx:"36",cy:"36",fill:"#fff",fillOpacity:".95",r:"36"}),i.a.createElement("path",{d:"M50.835 37.06L29.477 49.97a1.203 1.203 0 0 1-1.664-.43 1.25 1.25 0 0 1-.17-.631V23.091c0-.682.543-1.234 1.213-1.234.219 0 .433.06.62.173l21.359 12.91a1.245 1.245 0 0 1 0 2.12z",fill:"#444",fillRule:"nonzero"}))},S=(n(1606),function(){return i.a.createElement("div",{className:"VideoCardPlayButton"},i.a.createElement(P,{className:"VideoCardPlayButton-icon"}))}),_=function(e){var t=e.fileSize;return i.a.createElement("div",{className:"VideoCardPlayButton-withFileSize--outer"},i.a.createElement("span",{className:"VideoCardPlayButton-withFileSize"},i.a.createElement(E.a,{center:!0,size:14}),t?k()(t,{decimalPlaces:1,unit:"MB"}):"流量播放"))};function j(e){var t=e.thumbnail,n=e.isLens,o=e.canPlay;return n||o?t&&"string"==typeof t?i.a.createElement("img",{src:t,alt:"视频封面"}):t:i.a.createElement(P,{className:"VideoCard-playIcon VideoCard-playIcon--nonLens"})}n(1607);var N=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var T=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.state={isMobile:!1,playerShown:!1,playerLoading:!1},a.handlePlay=function(e){e.preventDefault();var t=a.props,n=t.interactive,o=t.isConverting,r=t.isLens,i=t.playerUrl,s=t.onPlayFailed,l=t.onLensPlay,c=t.onBeforePlay;n&&!o&&(i||!s?c?Promise.resolve(c()).then(function(e){!1!==e&&a.play()}):r&&l&&l()||a.play():s())},a.handlePlayerLoad=function(){a.loadingCount--,0===a.loadingCount&&a.setState({playerLoading:!1})},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),N(t,[{key:"componentDidMount",value:function(){this.setState({isMobile:m()(navigator.userAgent).Mobile})}},{key:"canPlay",value:function(){var e=this.props,t=e.isPlayable,n=e.playerUrl;return t&&n}},{key:"inlinePlayer",value:function(){var e=this.props,t=e.interactive,n=e.isLens,o=e.onLensPlay,r=e.onBeforePlay,a=this.state.isMobile;return t&&(n?!(o||r):a)}},{key:"showContent",value:function(){var e=this.props,t=e.isLens,n=e.title,o=e.isVideoTitleEditable,r=this.state.isMobile;return!o&&(t?Boolean(n):!(r&&this.canPlay()))}},{key:"showDescription",value:function(){var e=this.props.isLens;return this.showContent()&&!e}},{key:"play",value:function(){var e=this.props.onPlay;this.loadingCount=2,this.setState({playerShown:!0,playerLoading:!0}),setTimeout(this.handlePlayerLoad,1e3),e&&e()}},{key:"renderContent",value:function(){var e=this.props,t=e.interactive,n=e.isLens,o=e.title,r=e.thumbnail,a=e.source,s=e.url,c=e.showPlayButton,u=e.usePlayButtonWithFileSize,p=e.fileSize,m=e.rightBottomButton,d=e.isVideoTitleEditable,f=e.onVideoTitleChange,h=e.isConverting,v=this.canPlay(),b=this.inlinePlayer(),g=i.a.createElement(j,{thumbnail:r,isLens:n,canPlay:v}),w=c&&!h&&(u?i.a.createElement(_,{fileSize:p}):i.a.createElement(S,null)),C=i.a.createElement("div",{className:"VideoCard-layout"},v?i.a.createElement("div",{className:"VideoCard-video"},i.a.createElement("div",{className:"VideoCard-video-content"},b?this.renderPlayer():i.a.createElement("div",{className:l()("VideoCard-thumbnail",{"VideoCard-thumbnail--placeholder":!r}),onClick:this.handlePlay},g,w,m))):i.a.createElement("div",{className:"VideoCard-poster"},g),this.showContent()&&i.a.createElement("div",{className:"VideoCard-content"},i.a.createElement("div",{className:"VideoCard-title"},o),this.showDescription()&&i.a.createElement("div",{className:"VideoCard-description"},a&&i.a.createElement("span",{className:"VideoCard-source"},a),i.a.createElement("span",{className:"VideoCard-badge"},"视频"))),d&&i.a.createElement(y,{value:o,onChange:f}));return n?C:t?i.a.createElement("a",{className:"VideoCard-link",href:s,target:"_blank",rel:"noopener noreferrer"},C):i.a.createElement("div",{className:"VideoCard-link"},C)}},{key:"renderPlayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,n=t.source,o=t.playerUrl,r=t.onIframeRef,a=t.useMSE,s=u.a.stringify({autoplay:e&&"lens"===n,useMSE:a});return i.a.createElement(C,{placeholder:i.a.createElement("div",{className:"VideoCard-player"})},i.a.createElement("div",{className:"VideoCard-player"},i.a.createElement("iframe",{ref:r,frameBorder:0,allowFullScreen:!0,src:o+"?"+s,onLoad:this.handlePlayerLoad})))}},{key:"render",value:function(){var e=this.props,t=e.interactive,n=e.isConverting,o=this.state,r=o.isMobile,a=o.playerShown,s=o.playerLoading;return i.a.createElement("div",{className:l()("VideoCard",{"VideoCard--converting":n,"VideoCard--interactive":t,"VideoCard--mobile":r})},this.renderContent(),a&&i.a.createElement("div",{className:l()("VideoCard-overlay",{"is-loading":s})},this.renderPlayer(!0)),i.a.createElement("div",{className:l()("VideoCard-mask",{"is-shown":s})}))}}]),t}();T.propTypes={interactive:r.a.bool,showPlayButton:r.a.bool,usePlayButtonWithFileSize:r.a.bool,fileSize:r.a.number,onPlay:r.a.func,onPlayFailed:r.a.func,onLensPlay:r.a.func,onBeforePlay:r.a.func,rightBottomButton:r.a.oneOfType([r.a.element,r.a.string]),thumbnail:r.a.oneOfType([r.a.element,r.a.string])},T.defaultProps={interactive:!0,showPlayButton:!0};var R=T;n.d(t,"b",function(){return R}),n.d(t,"a",function(){return P})},1575:function(e,t,n){"use strict";var o=n(1),r=n.n(o),a=n(0),i=n(17),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();"undefined"!=typeof window&&n(693);var l=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.handleObserve=function(e){var t=a.props.onObserve;t&&t(e)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),s(t,[{key:"componentDidMount",value:function(){this.target=Object(i.findDOMNode)(this),this.observer=this.createObserver(),this.observer.observe(this.target)}},{key:"componentWillUnmount",value:function(){this.target&&this.observer.unobserve(this.target)}},{key:"createObserver",value:function(){var e=this.props,t={root:e.root,rootMargin:e.rootMargin,threshold:e.threshold};return new window.IntersectionObserver(this.handleObserve,t)}},{key:"render",value:function(){return this.props.children}}]),t}();l.propTypes={root:r.a.object,rootMargin:r.a.string,threshold:r.a.oneOfType([r.a.number,r.a.arrayOf(r.a.number)]),onObserve:r.a.func},t.a=l},1581:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(17),i=n(9),s=n(97),l=n(404),c=n(133),u=n(1583),p=n(386),m=n(2),d=n.n(m),f=n(60),h=n.n(f),v=n(71),y=n.n(v),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.a;return function(n){return h()(function(o){function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(o)));return i.key=t(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,r.a.Component),b(a,[{key:"render",value:function(){return r.a.createElement(n,Object.assign({},this.props,(t={},o=e,a=this.key,o in t?Object.defineProperty(t,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[o]=a,t)));var t,o,a}}]),a}(),n)}},w=n(1612),C=n(398),E=n.n(C),O=function(e,t){return function(n){var o,a=(o=[],{value:{},listen:function(e){o.push(e)},unlisten:function(e){o=o.filter(function(t){return t!==e})},emit:function(e){this.value=e,o.forEach(function(t){return t(e)})}}),i=Object(w.createSubscription)({getCurrentValue:function(e){return e.value},subscribe:function(e,t){return e.listen(t),function(){return e.unlisten(t)}}}),s=function(e,t){return e?E()(e,function(e){return function(){return t(e.apply(void 0,arguments))}}):{dispatch:t}}(t,function(e){return a.emit(e(a.value))}),l=Object.assign(function(t){return r.a.createElement(i,{source:a},function(o){return r.a.createElement(n,Object.assign({},t,e({value:o,source:a},t),s))})},{source:a});return h()(l,n)}},k=n(20),P=n.n(k);var S=void 0;!function(e){e[e.Initial=0]="Initial",e[e.Loading=1]="Loading",e[e.Ok=2]="Ok",e[e.Failed=3]="Failed"}(S||(S={}));var _=function(e){return r.a.createElement("svg",Object.assign({width:60,height:60,viewBox:"0 0 60 60"},e),r.a.createElement("g",{fill:"none",fillRule:"evenodd"},r.a.createElement("ellipse",{fill:"#000",opacity:.45,cx:30,cy:30,rx:30,ry:30}),r.a.createElement("ellipse",{stroke:"#FFF",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4,1,4",cx:30,cy:30,rx:26,ry:26}),r.a.createElement("svg",Object.assign({x:16,y:18.5},e),r.a.createElement("path",{d:"M12.842 12.981V11.4H7.64v1.653h3.27v.272c-.018 1.881-1.442 3.147-3.516 3.147-2.382 0-3.876-1.846-3.876-4.834 0-2.936 1.485-4.79 3.832-4.79 1.732 0 2.936.835 3.428 2.364h1.977c-.43-2.566-2.522-4.201-5.405-4.201-3.55 0-5.845 2.601-5.845 6.644 0 4.096 2.268 6.654 5.863 6.654 3.322 0 5.475-2.083 5.475-5.327zM17.518 18V5.317H15.55V18h1.97zm5.142 0v-5.256h5.449v-1.74h-5.45V7.11h5.95V5.317h-7.918V18h1.969z",fill:"#fff"}))))},j=function(e){return r.a.createElement("svg",Object.assign({width:"60px",height:"60px",viewBox:"0 0 60 60",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("ellipse",{fill:"#000000",opacity:"0.45",cx:"30",cy:"30",rx:"30",ry:"30"}),r.a.createElement("ellipse",{stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.5",cx:"30",cy:"30",rx:"26",ry:"26"}),r.a.createElement("ellipse",{stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4,1,4",cx:"30",cy:"30",rx:"26",ry:"26"},r.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 30 30",to:"90 30 30",dur:"0.3s"}),r.a.createElement("animate",{attributeName:"opacity",from:"1",to:"0",dur:"0.3",fill:"freeze"}))),r.a.createElement("svg",{x:"16",y:"18.5"},r.a.createElement("g",{fill:"#ffffff"},r.a.createElement("path",{x:"100",y:"100",d:"M12.8422852,12.9814453 L12.8422852,11.3994141 L7.63916016,11.3994141 L7.63916016,13.0517578 L10.9086914,13.0517578 L10.9086914,13.3242188 C10.8911133,15.2050781 9.46728516,16.4707031 7.39306641,16.4707031 C5.01123047,16.4707031 3.51708984,14.625 3.51708984,11.6367188 C3.51708984,8.70117188 5.00244141,6.84667969 7.34912109,6.84667969 C9.08056641,6.84667969 10.284668,7.68164062 10.7768555,9.2109375 L12.7543945,9.2109375 C12.3237305,6.64453125 10.2319336,5.00976562 7.34912109,5.00976562 C3.79833984,5.00976562 1.50439453,7.61132812 1.50439453,11.6542969 C1.50439453,15.75 3.77197266,18.3076172 7.36669922,18.3076172 C10.6889648,18.3076172 12.8422852,16.2246094 12.8422852,12.9814453 Z M17.5180664,18 L17.5180664,5.31738281 L15.5493164,5.31738281 L15.5493164,18 L17.5180664,18 Z M22.659668,18 L22.659668,12.7441406 L28.1088867,12.7441406 L28.1088867,11.0039062 L22.659668,11.0039062 L22.659668,7.11035156 L28.6098633,7.11035156 L28.6098633,5.31738281 L20.690918,5.31738281 L20.690918,18 L22.659668,18 Z"}))),r.a.createElement("path",{d:"M56,30 C56,15.6405965 44.3594035,4 30,4",stroke:"#FFFFFF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0",fill:"none"},r.a.createElement("animate",{attributeName:"opacity",from:"0",to:"1",dur:".6",fill:"freeze"}),r.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 30 30",to:"360 30 30",dur:"1.625s",repeatCount:"indefinite"})))},N=function(e){return r.a.createElement("svg",Object.assign({width:60,height:60,viewBox:"0 0 60 60"},e),r.a.createElement("g",{fill:"none",fillRule:"evenodd"},r.a.createElement("ellipse",{fill:"#282828",opacity:.45,cx:30,cy:30,rx:30,ry:30}),r.a.createElement("path",{d:"M41.552 18.93A15.954 15.954 0 0 0 30 14c-8.837 0-16 7.163-16 16s7.163 16 16 16c7.811 0 14.315-5.597 15.72-13",stroke:"#FFF",strokeWidth:2,strokeLinecap:"round"}),r.a.createElement("path",{d:"M45.108 16.236c.44-.33.797-.151.797.4v7.005c0 .55-.358.73-.797.4L40.7 20.736c-.44-.33-.439-.866 0-1.195l4.407-3.305z",fill:"#FFF"})))},T=(n(1627),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var R=function(){return new Promise(requestAnimationFrame)},I=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.handleClick=function(e){var t=a.props,n=t.gifKey,o=t.src,r=t.onSuccess,i=t.onFailed,l=t.onClick,c=t.loadState,u=t.isPlaying;l&&l(e),a.canPlay?a.props.updateGif({gifKey:n,isPlaying:!u}):c!==S.Loading&&(a.props.updateGif({gifKey:n,loadState:S.Loading}),Promise.all([Object(s.loadImage)(o),R().then(R)]).then(function(){r&&r(),a.props.updateGif({gifKey:n,isPlaying:!0,loadState:S.Ok})}).catch(function(e){i&&i(e),a.props.updateGif({gifKey:n,loadState:S.Failed})}))},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),T(t,[{key:"componentWillUnmount",value:function(){this.props.removeGif({gifKey:this.props.gifKey})}},{key:"render",value:function(){var e=this.props,t=e.poster,n=e.src,o=e.size,a=e.loadState,i=e.isPlaying,s=this.canPlay&&i,l=a===S.Loading,c=a===S.Failed,u=void 0;return l?u=r.a.createElement(j,{className:"GifPlayer-icon"}):c?u=r.a.createElement(N,{className:"GifPlayer-icon"}):i||(u=r.a.createElement(_,{className:"GifPlayer-icon"})),u&&(this.lastIcon=u),r.a.createElement("div",{className:d()("GifPlayer",{isPlaying:i}),"data-size":o,onClick:this.handleClick},r.a.createElement("img",{className:"column-gif",role:"presentation",src:s?n:t,"data-thumbnail":t,"data-size":o}),u||this.lastIcon)}},{key:"canPlay",get:function(){return this.props.loadState===S.Ok}}]),t}();I.defaultProps={isPlaying:!1,loadState:S.Initial};var x=g("gifKey")(O(function(e,t){return e.value[t.gifKey]},{updateGif:function(e){return function(t){var n,o,r,a=e.gifKey,i=e.isPlaying,s=P()(e,["gifKey","isPlaying"]),l=Object.assign({},t);if(i){var c=!0,u=!1,p=void 0;try{for(var m,d=Object.keys(l)[Symbol.iterator]();!(c=(m=d.next()).done);c=!0){var f=m.value,h=l[f];f!==a&&h.isPlaying&&(l[f]=Object.assign({},h,{isPlaying:!1}))}}catch(e){u=!0,p=e}finally{try{!c&&d.return&&d.return()}finally{if(u)throw p}}}return Object.assign({},l,(n={},o=a,r=Object.assign({},t[a],{isPlaying:i},s),o in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,n))}},removeGif:function(e){return function(t){var n=Object.assign({},t);return delete n[e.gifKey],n}}})(I)),L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},A=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var B,D,F=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=o=M(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.onSuccess=function(){i.default.trackEvent(o,{action:"StatusReport",element:"Card"},{status:{result:"Success",event:{action:"Click"}}})},o.onFailed=function(){i.default.trackEvent(o,{action:"StatusReport",element:"Card"},{status:{result:"Fail",event:{action:"Click"}}})},M(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),A(t,[{key:"componentDidMount",value:function(){var e=this;i.default.setModule(this,{module:"GifItem"}),Object(p.onViewedOnce)(Object(a.findDOMNode)(this),function(){i.default.trackCardShow(e,{element:"Card"})})}},{key:"render",value:function(){var e=this.props.data;return r.a.createElement(x,L({onSuccess:this.onSuccess,onFailed:this.onFailed},e))}}]),t}(),z=(n(1628),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),V=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function U(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var q={fail:"image_web_fail",success:"image_web_success",timeout:"image_web_timeout"};function W(e,t){var n=q[e]+"_"+t.type,o={monitor:{type:"Event",imgResourceErrorInfo:{error_description:n,img_url:t.url,img_from:"web"}}};i.default.trackMonitor({name:n},o)}var H=(B=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=U(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),D.call(o),U(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),V(t,[{key:"componentDidMount",value:function(){this.mount()}},{key:"componentWillUpdate",value:function(e){this.props.html!==e.html&&this.unmount()}},{key:"componentDidUpdate",value:function(e){e.html!==this.props.html&&this.mount()}},{key:"componentWillUnmount",value:function(){this.unmount()}},{key:"mount",value:function(){var e=this;this.gifNodes=Array.from(this.root.getElementsByTagName("img")).filter(function(e){return!e.getAttribute("eeimg")&&e.getAttribute("data-thumbnail")}).map(function(t){var n=document.createElement("div");n.className="RichText-gifPlaceholder",n.innerHTML=t.outerHTML,t.parentNode.replaceChild(n,t);var o={src:t.dataset.actualsrc||Object(s.imgUrl)(t.src,{extension:"gif",size:"b"}),poster:t.dataset.thumbnail,size:t.dataset.size};return Object(a.unstable_renderSubtreeIntoContainer)(e,e.renderGif(o),n),n}),this.mentionNodes=Array.from(this.root.querySelectorAll(".member_mention")).map(function(t){var n=t.getAttribute("data-hash"),o=t.textContent.replace(/^@/,""),r=document.createElement("span");return t.parentNode.replaceChild(r,t),Object(a.unstable_renderSubtreeIntoContainer)(e,e.renderMention({id:n,name:o}),r),r}),this.videoNodes=Array.from(this.root.querySelectorAll(".video-box, .video-link, .unprocessable_video")).map(function(t){var n=t.getAttribute("data-poster"),o="data:,"===n?"":n,r={title:t.getAttribute("data-name"),thumbnail:o,url:t.getAttribute("href"),src:t.getAttribute("data-src")};r=t.getAttribute("data-lens-id")?z({},r,{isLens:!0,id:t.getAttribute("data-lens-id"),isPlayable:!0}):z({},r,{isLens:!1,id:t.getAttribute("data-video-id"),isPlayable:"true"===t.getAttribute("data-video-playable")}),t.hasAttribute("data-lens-status")&&(r=z({},r,{error:{status:t.getAttribute("data-lens-status"),message:t.getAttribute("data-description")}}));var i=document.createElement("div");return t.parentNode.replaceChild(i,t),Object(a.unstable_renderSubtreeIntoContainer)(e,e.renderVideo(r),i),i})}},{key:"unmount",value:function(){this.gifNodes&&this.gifNodes.forEach(function(e){Object(a.unmountComponentAtNode)(e)}),this.mentionNodes&&this.mentionNodes.forEach(function(e){Object(a.unmountComponentAtNode)(e)}),this.videoNodes&&this.videoNodes.forEach(function(e){Object(a.unmountComponentAtNode)(e)})}},{key:"renderMention",value:function(e){return r.a.createElement(c.a,{noBadge:!0,user:e,target:"_blank"},"@",e.name)}},{key:"renderVideo",value:function(e){return r.a.createElement(u.a,{data:e})}},{key:"renderGif",value:function(e){return r.a.createElement(F,{data:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(l.a,z({onRef:function(t){e.root=t},onClick:this.handleGifPlayerClick},this.props,{onLoadImageSuccess:this.trackLoadImageSuccess,onLoadImageFail:this.trackLoadImageFail,onLoadImageTimeout:this.trackLoadImageTimeout}))}}]),t}(),D=function(){this.handleGifPlayerClick=function(e){var t=e.target;"IMG"===t.tagName&&(t.parentNode.classList.contains("isPlaying")||t.dataset.thumbnail&&i.default.trackEvent(t,{action:"Click",element:"Image"}))},this.trackLoadImageFail=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return W.apply(void 0,["fail"].concat(t))},this.trackLoadImageSuccess=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return W.apply(void 0,["success"].concat(t))},this.trackLoadImageTimeout=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return W.apply(void 0,["timeout"].concat(t))}},B);t.a=H},1583:function(e,t,n){"use strict";var o={};n.r(o),n.d(o,"DOM",function(){return d}),n.d(o,"PLAYER",function(){return f});var r={};n.r(r),n.d(r,"PLAYER",function(){return h});var a=n(0),i=n.n(a),s=n(13),l=n(1608),c=n.n(l),u=n(1575),p=n(1574),m=n(1596),d={PLAY:"event/dom/play",PLAYING:"event/dom/playing",PAUSE:"event/dom/pause",ENDED:"event/dom/ended",TIMEUPDATE:"event/dom/timeupdate",ERROR:"event/dom/error",WAITING:"event/dom/waiting"},f={QUALITY_CHANGE:"event/player/quality-change",REQUEST_PLAY:"event/player/request-play",REQUEST_PAUSE:"event/player/request-pause",PLAY_COUNT:"event/player/play-count",PLAY_FAILED:"event/player/play-failed",ENTER_FULLSCREEN:"event/player/enter-fullscreen",EXIT_FULLSCREEN:"event/player/exit-fullscreen"},h={PLAY:"action/player/play",PAUSE:"action/player/pause",SET_VOLUME:"action/player/set-volume",ENTER_FULLSCREEN:"action/player/enter-fullscreen",EXIT_FULLSCREEN:"action/player/exit-fullscreen"},v="griffith";var y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=arguments[2];return{subscribeMessage:function(o){function r(r){var a=r.origin||r.originalEvent.origin,i="*"===t||t===a,s=r.data||{},l=s.from,c=s.id,u=s.payload;if(i&&l===v&&(!n||e===c)&&u){var p=u.messageName,m=u.data;p&&o(p,m,r.source)}}return window.addEventListener("message",r),{unsubscribe:function(){return window.removeEventListener("message",r)}}},dispatchMessage:function(n,o,r){n&&n.postMessage&&n.postMessage({from:v,id:e,payload:{messageName:o,data:r}},t||"*")}}},b=n(36),g=n(14),w=n(171),C=n(203),E=n(1584),O=n.n(E),k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},P=function(e,t){return e+(t?Date.now()-t:0)},S=function(e,t){return Math.abs(e-t)<.01},_={auto:"Auto",ld:"LD",sd:"SD",hd:"HD"},j={auto:"自动",ld:"低清",sd:"标清",hd:"超清"},N=[1,2,3,5,8,13];function T(e){var t="sd",n=0,o=null,r=0,a=null,i=!1,s=0,l=0,c=void 0;function u(i,s){e(i,k({play_event_identifier:o,duration:1e3*n,elapsed:P(r,a),video_quality:_[t]},s))}function p(){(++l<15?N.includes(l):l%15==0)&&u({action:"Playing"})}function m(){clearInterval(c)}return{handlePlayEvent:function(e){var t=e.currentTime,i=e.duration;n=i,S(t,0)&&(o=O()(),r=0),a=Date.now(),S(t,0)?u({action:"Play"}):u({action:"ResumePlay"}),l=0,m(),c=setInterval(p,1e3)},handlePauseEvent:function(e){var t=e.currentTime,n=e.duration;a&&(r+=Date.now()-a,a=null),S(t,n)?u({action:"EndPlay"}):u({action:"Pause"}),m()},handleQualityChangeEvent:function(e){var n=e.quality;u({action:"Switch",name:j[n]}),t=n},handleFragmentLoading:function(){i||(s=Date.now())},handleFragmentLoaded:function(){i||(i=!0,u({action:"Load"},{video_load_time:Date.now()-s}))},clearTick:m}}var R,I,x,L=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var M=Object(s.connect)(function(e,t){var n=t.data,o=n.isLens,r=n.id;if(o){var a=!1;if("undefined"!=typeof window){var i=e.env.userAgent.origin,s=Object(b.f)(e,{includeTablet:!0});"Chrome"!==c()(i).browser.name||s||(a="1"===Object(b.a)(e,"ls_fmp4"))}return{data:A({},t.data,{source:"lens",playerUrl:"https://www.zhihu.com/video/"+r}),useMSE:a}}return{data:e.video.data[r]||t.data}},{showNotification:g.g,loadVideo:w.c})(R=Object(C.a)(function(e){var t=e.data,n=t.isLens,o=t.id,r=t.isPlayable;return{module:"VideoItem",content:{type:"Video",sub_type:n?"SelfHosted":"Embedded",video_id:o,is_playable:Boolean(r)},trackCardShow:!0,view:{id:174}}})((I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));x.call(n);var o=e.trackEvent,r=e.data;return n.messageHelper=y(r.id,"*",!0),n.videoTracker=T(function(e,t){o(n,e,{play:t})}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),L(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=t.isLens,o=t.id,r=t.playerUrl,a=t.flvPlayerUrl,i=e.loadVideo;n||!o||r||a||i(o);var s=this.messageHelper.subscribeMessage;this.messageSubscription=s(this.handleMessage)}},{key:"componentWillUnmount",value:function(){this.messageSubscription.unsubscribe(),this.videoTracker.clearTick()}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,o=t.data.error,r=t.onBeforePlay,a=t.useMSE;return i.a.createElement("div",{className:"RichText-video"},o?i.a.createElement(m.a,n):i.a.createElement(u.a,{onObserve:this.handleObserve},i.a.createElement(p.b,A({},n,{onIframeRef:function(t){return e.iframe=t},onPlay:this.handlePlay,onPlayFailed:this.handlePlayFailed,onBeforePlay:r},a&&{useMSE:!0}))))}}]),t}(),x=function(){var e=this;this.pauseVideoInIframe=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.messageHelper.dispatchMessage(t.contentWindow,r.PLAYER.PAUSE,{dontApplyOnFullScreen:n})},this.pauseAllOtherVideos=function(){Array.from(document.querySelectorAll("iframe")).filter(function(t){return t!==e.iframe}).forEach(function(t){return e.pauseVideoInIframe(t)})},this.handleMessage=function(t,n){var r=e.videoTracker,a=r.handlePlayEvent,i=r.handlePauseEvent,s=r.handleQualityChangeEvent,l=r.handleFragmentLoading,c=r.handleFragmentLoaded;switch(t){case o.DOM.PLAY:e.pauseAllOtherVideos(),a(n);break;case o.DOM.PAUSE:i(n);break;case o.PLAYER.QUALITY_CHANGE:s(n);break;case"fragment-loading":l(n);break;case"fragment-loaded":c(n)}},this.handleObserve=function(t){t[0].intersectionRatio<=0&&e.iframe&&e.pauseVideoInIframe(e.iframe,!0)},this.handlePlay=function(){e.props.trackEvent(e,{action:"Play",element:"Video"})},this.handlePlayFailed=function(){(0,e.props.showNotification)("视频加载失败，请刷新页面重试","red")}},R=I))||R)||R;t.a=M},1584:function(e,t,n){var o=n(1610),r=n(1611);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[a+s]=i[s];return t||r(i)}},1585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1601);t.getHexRandom=o.getHexRandom,t.sliceString=o.sliceString,t.stringWidth=o.stringWidth,t.cutStringWidth=o.cutStringWidth},1586:function(e,t,n){"use strict";var o=n(1),r=n.n(o),a=n(0),i=n.n(a),s=n(2),l=n.n(s),c=n(97),u=n(293),p=n(59),m=n.n(p),d=n(139),f=(n(1626),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var h={top:10,left:20},v={top:0,left:0};var y=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={transEnded:!1,rect:null,translate:null,scale:null,url:null},e.getBoundingClientRect=function(){var t=e.props,n=t.img,o=t.data,r=n.getBoundingClientRect(),a=r.left,i=r.top,s=r.width,l=r.height,c=o.width,u=o.height,p={left:a,top:i,width:s,height:l},m=1;return c>u?(p.height=l,m=l/u,p.width=c*m,p.left=a+(s-p.width)/2,p.top=i+(l-p.height)/2):c<u&&(p.width=s,m=s/c,p.height=u*m,p.left=a+(s-p.width)/2,p.top=i+(l-p.height)/2),p},e.handleClick=e.handleClick.bind(e),e.handleTransEnd=e.handleTransEnd.bind(e),e.handleOriginLoad=e.handleOriginLoad.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),f(t,[{key:"componentWillMount",value:function(){u.hide();var e=this.props,t=e.img,n=e.isOriginalUrl,o=this.loadImg=new Image;o.src=Object(c.imgUrl)(t.dataset.original,"r"),o.addEventListener("load",this.handleOriginLoad),this.setState({rect:!1===n?this.getBoundingClientRect():t.getBoundingClientRect()})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.img,n=t.dataset.rawwidth,o=t.naturalWidth;setTimeout(function(){return e.setState(Object.assign({},e.computeTransition(e.state.rect,{width:n||o})))})}},{key:"componentWillUnmount",value:function(){this.loadImg.removeEventListener("load",this.handleOriginLoad),u.show()}},{key:"handleClick",value:function(){this.setState({translate:null,scale:null})}},{key:"handleTransEnd",value:function(){var e=this.state,t=e.translate,n=e.scale,o=this.props.onClose;t&&n?(this.setState({transEnded:!0}),this.scrollNode.style.overflow="auto"):o()}},{key:"handleOriginLoad",value:function(e){this.setState({url:e.target.src})}},{key:"computeTransition",value:function(e,t){var n=this.props,o=n.transitionType,r=n.data,a=m()(navigator.userAgent).Mobile?v:h,i=a.top,s=a.left,l=window,c={left:0,top:0,width:l.innerWidth,height:l.innerHeight},u=function(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}(c),p={width:c.width-2*s,height:c.height-2*i},d={},f={},y=void 0;return 1===o?(d.width=p.width>r.width?r.width:p.width,y=d.width/r.width,d.height=r.height*y,f={x:(p.width-d.width)/2+s,y:d.height<p.height?(p.height-d.height)/2+i:h.top}):(d.width=p.width>t.width?t.width:p.width,y=d.width/e.width,d.height=e.height*y,f={x:u.x-e.width/2,y:(d.height<p.height?u.y:h.top+d.height/2)-e.height/2}),{translate:f,scale:y}}},{key:"render",value:function(){var e=this,t=this.props,n=t.img,o=t.isOriginalUrl,r=t.data,a=t.transitionType,s=t.className,u=this.state,p=u.translate,f=u.scale,y=u.rect,b=u.url,g=u.transEnded,w=p&&f,C=1,E="",O=void 0;if(1===a){var k=(m()(navigator.userAgent).Mobile?v:h).left;O=Math.min(window.innerWidth-2*k,r.width);var P=y.width/O;E=w?"translate3d("+p.x+"px, "+p.y+"px, 0) scale3d(1, 1, 1) ":"translate3d("+y.left+"px, "+y.top+"px, 0) scale3d("+P+", "+P+", 1) ",C=w?1:0}else E=w?"translate3d("+p.x+"px ,"+p.y+"px,0) scale3d("+f+","+f+",1) ":"translate3d("+y.left+"px,"+y.top+"px,0)";return i.a.createElement(d.a,null,i.a.createElement("div",{className:l()("ImageView",s,{"is-active":w}),style:{paddingBottom:h.top},onClick:this.handleClick},i.a.createElement("div",{className:"ImageView-inner",ref:function(t){e.scrollNode=t}},i.a.createElement("img",{ref:function(t){e.imgEl=t},src:!1===o?Object(c.imgUrl)(n.dataset.original,"r"):g&&b||n.src,className:l()("ImageView-img",{"ImageView-transformOrigin":1===a}),style:{width:O||y.width,transform:E,opacity:C},onTransitionEnd:this.handleTransEnd,alt:"preview"}))))}}]),t}();y.propTypes={img:r.a.object.isRequired,onClose:r.a.func.isRequired},t.a=y},1587:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n(20),r=n.n(o),a=n(1),i=n.n(a),s=n(0),l=n.n(s),c=n(2),u=n.n(c),p=(n(1641),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),p(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.onRef,o=r()(e,["className","onRef"]);return l.a.createElement("ul",Object.assign({ref:n,role:"tablist",className:u()("Tabs",t)},o))}}]),t}();function d(e){var t=e.className,n=e.meta,o=e.children,a=r()(e,["className","meta","children"]),i=s.Children.only(o),c=i.type.displayName,p={className:u()("Tabs-link",i.props.className)};return void 0!==n&&(p.children=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s.Children.toArray(i.props.children)),[l.a.createElement("span",{key:"meta",className:"Tabs-meta"},n)])),"Link"!==c&&"IndexLink"!==c||(p.activeClassName="is-active"),l.a.createElement("li",Object.assign({role:"tab",className:u()("Tabs-item",t,{"Tabs-item--noMeta":void 0===n})},a),Object(s.cloneElement)(i,p))}d.propTypes={meta:i.a.node},t.b=m},1591:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(0),r=n.n(o),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),a(t,[{key:"handleEvent",value:function(e){e.stopPropagation()}},{key:"render",value:function(){return r.a.createElement("div",{onBeforeInput:this.handleEvent,onBlur:this.handleEvent,onCompositionEnd:this.handleEvent,onCompositionStart:this.handleEvent,onCopy:this.handleEvent,onCut:this.handleEvent,onDragEnd:this.handleEvent,onDragEnter:this.handleEvent,onDragLeave:this.handleEvent,onDragOver:this.handleEvent,onDragStart:this.handleEvent,onDrop:this.handleEvent,onFocus:this.handleEvent,onInput:this.handleEvent,onKeyDown:this.handleEvent,onKeyPress:this.handleEvent,onKeyUp:this.handleEvent,onMouseUp:this.handleEvent,onPaste:this.handleEvent,onSelect:this.handleEvent,onClick:this.handleEvent},this.props.children)}}]),t}()},1593:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(2),i=n.n(a),s=(n(1642),function(e){var t=e.avatar,n=e.bottom,o=e.button,a=e.className,s=e.height,l=e.icon,c=e.inline,u=e.right,p=e.style,m=void 0===p?{}:p,d=e.title,f=e.width,h=Object.assign({},m);return f&&(h.width=f+"px"),s&&(h.height=s+"px"),n&&(h.marginBottom=n+"px"),u&&(h.marginRight=u+"px"),r.a.createElement("div",{className:i()("Holder",a,{"Holder--inline":c,"Holder--title":d,"Holder--icon":l,"Holder--button":o,"Holder--avatar":t}),style:h})});n.d(t,"a",function(){return s})},1595:function(e,t){(function(t){e.exports=t}).call(this,{})},1596:function(e,t,n){"use strict";var o=n(1),r=n.n(o),a=n(0),i=n.n(a),s=n(1574),l=(n(1609),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),l(t,[{key:"renderThumbnail",value:function(){var e=this.props.error;return i.a.createElement("div",{className:"VideoErrorCard-thumbnail"},i.a.createElement("div",{className:"VideoErrorCard-error"},e.message||"错误"))}},{key:"render",value:function(){var e=this.props,t=e.isLens,n=e.id;return i.a.createElement("div",{className:"VideoErrorCard"},i.a.createElement(s.b,Object.assign({},this.props,t&&{playerUrl:"https://www.zhihu.com/video/"+n},{thumbnail:this.renderThumbnail(),showPlayButton:!1,onBeforePlay:function(){return!1}})))}}]),t}();c.propTypes={error:r.a.object.isRequired},t.a=c},1601:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1602));function a(e){return"string"==typeof e&&e?Array.from(e).reduce(function(e,t){var n=t.codePointAt(0);return e+(r.default(n)?2:1)},0):0}t.getHexRandom=function(e){return Array.from({length:e}).map(function(){return Math.floor(16*Math.random()).toString(16).toUpperCase()}).join("")},t.sliceString=function(e,t){return e.length>t?e.slice(0,t)+"...":e},t.stringWidth=a,t.cutStringWidth=function(e,t){if("string"!=typeof e||"number"!=typeof t||a(e)<=t)return e;for(var n="",o=0;a(e.slice(0,o+1))<=t;)o++,n=e.slice(0,o);return n}},1602:function(e,t,n){"use strict";var o=n(1603);e.exports=function(e){return!o(e)&&(e>=4352&&(e<=4447||9001===e||9002===e||11904<=e&&e<=12871&&12351!==e||12880<=e&&e<=19903||19968<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510||110592<=e&&e<=110593||127488<=e&&e<=127569||131072<=e&&e<=262141))}},1603:function(e,t,n){"use strict";e.exports=Number.isNaN||function(e){return e!=e}},1604:function(e,t,n){},1605:function(e,t,n){"use strict";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */e.exports=function(e,t){if("string"==typeof e)return l(e);if("number"==typeof e)return s(e,t);return null},e.exports.format=s,e.exports.parse=l;var o=/\B(?=(\d{3})+(?!\d))/g,r=/(?:\.0*|(\.[^0]+)0+)$/,a={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},i=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function s(e,t){if(!Number.isFinite(e))return null;var n=Math.abs(e),i=t&&t.thousandsSeparator||"",s=t&&t.unitSeparator||"",l=t&&void 0!==t.decimalPlaces?t.decimalPlaces:2,c=Boolean(t&&t.fixedDecimals),u=t&&t.unit||"";u&&a[u.toLowerCase()]||(u=n>=a.pb?"PB":n>=a.tb?"TB":n>=a.gb?"GB":n>=a.mb?"MB":n>=a.kb?"KB":"B");var p=(e/a[u.toLowerCase()]).toFixed(l);return c||(p=p.replace(r,"$1")),i&&(p=p.replace(o,i)),p+s+u}function l(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,n=i.exec(e),o="b";return n?(t=parseFloat(n[1]),o=n[4].toLowerCase()):(t=parseInt(e,10),o="b"),Math.floor(a[o]*t)}},1606:function(e,t,n){},1607:function(e,t,n){},1608:function(e,t,n){var o;!function(r,a){"use strict";var i="model",s="name",l="type",c="vendor",u="version",p="mobile",m="tablet",d={extend:function(e,t){var n={};for(var o in e)t[o]&&t[o].length%2==0?n[o]=t[o].concat(e[o]):n[o]=e[o];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(){for(var e,t,n,o,r,a,i,s=0,l=arguments;s<l.length&&!a;){var c=l[s],u=l[s+1];if(void 0===e)for(o in e={},u)u.hasOwnProperty(o)&&("object"==typeof(r=u[o])?e[r[0]]=void 0:e[r]=void 0);for(t=n=0;t<c.length&&!a;)if(a=c[t++].exec(this.getUA()))for(o=0;o<u.length;o++)i=a[++n],"object"==typeof(r=u[o])&&r.length>0?2==r.length?"function"==typeof r[1]?e[r[0]]=r[1].call(this,i):e[r[0]]=r[1]:3==r.length?"function"!=typeof r[1]||r[1].exec&&r[1].test?e[r[0]]=i?i.replace(r[1],r[2]):void 0:e[r[0]]=i?r[1].call(this,i,r[2]):void 0:4==r.length&&(e[r[0]]=i?r[3].call(this,i.replace(r[1],r[2])):void 0):e[r]=i||void 0;s+=2}return e},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var o=0;o<t[n].length;o++)if(d.has(t[n][o],e))return"?"===n?void 0:n}else if(d.has(t[n],e))return"?"===n?void 0:n;return e}},h={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},v={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s,u],[/(opios)[\/\s]+([\w\.]+)/i],[[s,"Opera Mini"],u],[/\s(opr)\/([\w\.]+)/i],[[s,"Opera"],u],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[s,u],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[s,"IE"],u],[/(edge)\/((\d+)?[\w\.]+)/i],[s,u],[/(yabrowser)\/([\w\.]+)/i],[[s,"Yandex"],u],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],u],[/(micromessenger)\/([\w\.]+)/i],[[s,"WeChat"],u],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[u,[s,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,/(.+)/,"$1 WebView"],u],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[u,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[s,u],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[s,"UCBrowser"],u],[/(dolfin)\/([\w\.]+)/i],[[s,"Dolphin"],u],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s,"Chrome"],u],[/;fbav\/([\w\.]+);/i],[u,[s,"Facebook"]],[/fxios\/([\w\.-]+)/i],[u,[s,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[u,[s,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[u,s],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[u,f.str,h.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[s,u],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],u],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[i,c,[l,m]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[c,"Apple"],[l,m]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[c,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[c,i,[l,m]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[i,[c,"Amazon"],[l,m]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[i,f.str,h.device.amazon.model],[c,"Amazon"],[l,p]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,c,[l,p]],[/\((ip[honed|\s\w*]+);/i],[i,[c,"Apple"],[l,p]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[c,i,[l,p]],[/\(bb10;\s(\w+)/i],[i,[c,"BlackBerry"],[l,p]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[i,[c,"Asus"],[l,m]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[c,"Sony"],[i,"Xperia Tablet"],[l,m]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[c,"Sony"],[i,"Xperia Phone"],[l,p]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[c,i,[l,"console"]],[/android.+;\s(shield)\sbuild/i],[i,[c,"Nvidia"],[l,"console"]],[/(playstation\s[34portablevi]+)/i],[i,[c,"Sony"],[l,"console"]],[/(sprint\s(\w+))/i],[[c,f.str,h.device.sprint.vendor],[i,f.str,h.device.sprint.model],[l,p]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[c,i,[l,m]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[c,[i,/_/g," "],[l,p]],[/(nexus\s9)/i],[i,[c,"HTC"],[l,m]],[/(nexus\s6p)/i],[i,[c,"Huawei"],[l,p]],[/(microsoft);\s(lumia[\s\w]+)/i],[c,i,[l,p]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[c,"Microsoft"],[l,"console"]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[c,"Microsoft"],[l,p]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[c,"Motorola"],[l,p]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[c,"Motorola"],[l,m]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[c,d.trim],[i,d.trim],[l,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[c,"Samsung"],[l,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[i,[c,"Sharp"],[l,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[c,"Samsung"],i,[l,m]],[/smart-tv.+(samsung)/i],[c,[l,"smarttv"],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[c,"Samsung"],i,[l,p]],[/sie-(\w+)*/i],[i,[c,"Siemens"],[l,p]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[c,"Nokia"],i,[l,p]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[i,[c,"Acer"],[l,m]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[c,"LG"],i,[l,m]],[/(lg) netcast\.tv/i],[c,i,[l,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[i,[c,"LG"],[l,p]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[c,"Lenovo"],[l,m]],[/linux;.+((jolla));/i],[c,i,[l,p]],[/((pebble))app\/[\d\.]+\s/i],[c,i,[l,"wearable"]],[/android.+;\s(glass)\s\d/i],[i,[c,"Google"],[l,"wearable"]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[i,/_/g," "],[c,"Xiaomi"],[l,p]],[/android.+a000(1)\s+build/i],[i,[c,"OnePlus"],[l,p]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,d.lowerize],c,i]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[u,[s,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,u],[/rv\:([\w\.]+).*(gecko)/i],[u,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[u,f.str,h.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[u,f.str,h.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[s,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],u],[/\((series40);/i],[s],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],u],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],u],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,u],[/(haiku)\s(\w+)/i],[s,u],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[u,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s,"Mac OS"],[u,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[s,u]]},y=function(e,t){if(!(this instanceof y))return new y(e,t).getResult();var n=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),o=t?d.extend(v,t):v;return this.getBrowser=function(){var e=f.rgx.apply(this,o.browser);return e.major=d.major(e.version),e},this.getCPU=function(){return f.rgx.apply(this,o.cpu)},this.getDevice=function(){return f.rgx.apply(this,o.device)},this.getEngine=function(){return f.rgx.apply(this,o.engine)},this.getOS=function(){return f.rgx.apply(this,o.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};y.VERSION="0.7.12",y.BROWSER={NAME:s,MAJOR:"major",VERSION:u},y.CPU={ARCHITECTURE:"architecture"},y.DEVICE={MODEL:i,VENDOR:c,TYPE:l,CONSOLE:"console",MOBILE:p,SMARTTV:"smarttv",TABLET:m,WEARABLE:"wearable",EMBEDDED:"embedded"},y.ENGINE={NAME:s,VERSION:u},y.OS={NAME:s,VERSION:u},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=y),t.UAParser=y):n(1595)?void 0===(o=function(){return y}.call(t,n,t,e))||(e.exports=o):r.UAParser=y;var b=r.jQuery||r.Zepto;if(void 0!==b){var g=new y;b.ua=g.getResult(),b.ua.get=function(){return g.getUA()},b.ua.set=function(e){g.setUA(e);var t=g.getResult();for(var n in t)b.ua[n]=t[n]}}}("object"==typeof window?window:this)},1609:function(e,t,n){},1610:function(e,t,n){(function(t){var n,o=t.crypto||t.msCrypto;if(o&&o.getRandomValues){var r=new Uint8Array(16);n=function(){return o.getRandomValues(r),r}}if(!n){var a=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}e.exports=n}).call(this,n(33))},1611:function(e,t){for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,r=n;return r[e[o++]]+r[e[o++]]+r[e[o++]]+r[e[o++]]+"-"+r[e[o++]]+r[e[o++]]+"-"+r[e[o++]]+r[e[o++]]+"-"+r[e[o++]]+r[e[o++]]+"-"+r[e[o++]]+r[e[o++]]+r[e[o++]]+r[e[o++]]+r[e[o++]]+r[e[o++]]}},1612:function(e,t,n){"use strict";e.exports=n(1613)},1613:function(e,t,n){"use strict";
/** @license React v16.4.1
 * create-subscription.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var o=n(383),r=n(0);function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.createSubscription=function(e){var t=e.getCurrentValue,n=e.subscribe;return function(e){function r(){var n,o;if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return n=o=a(this,e.call.apply(e,[this].concat(s))),o.state={source:o.props.source,value:null!=o.props.source?t(o.props.source):void 0},o._hasUnmounted=!1,o._unsubscribe=null,a(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,e),r.getDerivedStateFromProps=function(e,n){return e.source!==n.source?{source:e.source,value:null!=e.source?t(e.source):void 0}:null},r.prototype.componentDidMount=function(){this.subscribe()},r.prototype.componentDidUpdate=function(e,t){this.state.source!==t.source&&(this.unsubscribe(t),this.subscribe())},r.prototype.componentWillUnmount=function(){this.unsubscribe(this.state),this._hasUnmounted=!0},r.prototype.render=function(){return this.props.children(this.state.value)},r.prototype.subscribe=function(){var e=this,r=this.state.source;if(null!=r){var a=n(r,function(t){e._hasUnmounted||e.setState(function(e){return t===e.value||r!==e.source?null:{value:t}})});"function"!=typeof a&&function(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);o(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}("266"),this._unsubscribe=a,(a=t(this.props.source))!==this.state.value&&this.setState({value:a})}},r.prototype.unsubscribe=function(){"function"==typeof this._unsubscribe&&this._unsubscribe(),this._unsubscribe=null},r}(r.Component)}},1620:function(e,t,n){e.exports=n(1801)()},1625:function(e,t,n){"use strict";var o,r,a,i=n(0),s=n.n(i),l=n(1),c=n.n(l),u=n(13),p=n(1819),m=n(38),d=n(18),f=n(73),h=(n(1675),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b,g={all:"开放评论",censor:"预审评论",nobody:"关闭评论"},w={all:"允许任何人评论",follower:"允许关注我的人评论",censor:"评论由我筛选后显示",followee:"允许我关注的人评论",paid:"付费用户可评论",nobody:"关闭评论"},C=Object(u.connect)(function(e){return{isOrg:Object(d.f)(e)}})((a=r=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClickOption=function(e){var t=o.props,n=t.isOrg,r=t.target,a=t.onChange,i=t.current;if(e!==i)if(r){var s=r.id;r.adminClosedComment?Object(f.b)("此内容无法更改评论权限",{theme:"red-ghost"}):n||"censor"!==e&&"censor"!==i?a(s,e):Object(f.a)("你确定要更改评论权限吗？",{content:"censor"===e?"更改后，已有评论不变，新评论需要经过筛选才会公开显示":"更改后，所有待筛选评论都会被公开显示出来"}).then(function(){return a(s,e)}).catch(function(){return null})}else a(e)},o.getCommentPermission=function(){var e=o.props.target,t=e&&"answer"===e.type&&"paid"===e.answerType;return Object.keys(w).filter(function(n){if("paid"!==n||t)return"follower"!==n||e&&"article"===e.type}).reduce(function(e,t){return h({},e,(n={},o=t,r=w[t],o in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,n));var n,o,r},{})},y(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),v(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isOrg,o=t.current,r=n?g:this.getCommentPermission();return s.a.createElement(i.Fragment,null,Object.keys(r).map(function(t){var n=t===o;return s.a.createElement(m.b,{key:t,onClick:function(){return e.handleClickOption(t)},className:"CommentPermission-item"},n&&s.a.createElement(p.a,{text:!0,center:!0}),r[t])}))}}]),t}(),r.propTypes={current:c.a.string.isRequired,target:c.a.object,onChange:c.a.func.isRequired},o=a))||o,E=n(32),O=n(1676),k=n.n(O),P=n(203),S=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var _=Object(P.a)({view:{id:3038},trackCardShow:!0})(b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),S(t,[{key:"render",value:function(){return s.a.createElement("img",{src:k.a,style:{maxWidth:"200px",marginTop:"30px"},alt:"delete-comment-success"})}}]),t}())||b;_.showModal=function(e){E.b.open(function(t){var n=(e||{}).reportText;return setTimeout(t,2e3),s.a.createElement(E.b,{title:"举报成功",onClose:t},s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement("div",null,n||"你的举报我们已经收到，处理完成后将会私信告知处理结果。"),s.a.createElement(_,null)))})};var j=_,N=n(4),T=n(206),R=(n(1677),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function I(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var x=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=I(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={reportModalShown:!1},o.handleSubmit=function(){var e=o.props,t=e.id,n=e.onDelete,r=e.onClose;n(t),r()},o.handleReportModalOpen=function(){return o.setState({reportModalShown:!0})},o.handleReportModalClose=function(){o.setState({reportModalShown:!1}),o.handleSubmit()},o.handleSuccess=function(){o.handleSubmit()},I(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),R(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.shown,o=e.onClose,r=e.reportAndDeleteExperiment;return s.a.createElement(i.Fragment,null,s.a.createElement(E.b,{title:"你确定要删除这条评论吗？",closeButton:null,maskClosable:!1,hotKeyClosable:!1,onClose:o,footer:r&&s.a.createElement("div",{className:"CommentDeleteAndReport-extra"},"评论若构成举报条件可以",s.a.createElement(N.c,{preset:"link",onClick:this.handleReportModalOpen},"删除并举报"))},n&&s.a.createElement(E.a,{direction:"horizontal"},s.a.createElement(N.c,{onClick:o},"取消"),s.a.createElement(N.c,{preset:"primary",color:"blue",onClick:this.handleSubmit},"确定"))),s.a.createElement(T.a,{title:"删除成功，请选择举报理由",subtitle:"",shown:this.state.reportModalShown,type:"comment",urlToken:t,zaEnabled:!0,onSuccess:this.handleSuccess,onClose:this.handleReportModalClose}))}}]),t}();n.d(t,"c",function(){return C}),n.d(t,"a",function(){return x}),n.d(t,"b",function(){return j})},1626:function(e,t,n){},1627:function(e,t,n){},1628:function(e,t,n){},1640:function(e,t,n){"use strict";var o,r,a=n(1),i=n.n(a),s=n(0),l=n.n(s),c=n(59),u=n.n(c),p=n(17),m=n(9),d=n(416),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=(r=o=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleViewed=function(){var e=o.props.extra;setTimeout(function(){m.default.trackCardShow(o,{},e)})},o.trackEvent=function(e,t,n){m.default.trackEvent(e,t,h({},o.props.extra,n))},v(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),f(t,[{key:"componentDidMount",value:function(){this.setModule()}},{key:"componentDidUpdate",value:function(){this.setModule()}},{key:"setModule",value:function(){var e=this.props,t=e.module,n=e.index,o=e.isAd,r=e.moduleName,a=e.content,i=e.list,s=e.card,l=e.attachedInfoBytes;if(t){var c=Object(p.findDOMNode)(this);c&&m.default.setModule(c,{module:t,index:n,is_ad:o,module_name:r},function(e,t,n,o){return e?{card:{content:e}}:h({},t&&{card:t},n&&{list:n},o&&{attached_info_bytes:o})}(a,s,i,l))}}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.trackCardShow,o=e.children,r="string"==typeof o.type?o:Object(s.cloneElement)(o,{trackEvent:this.trackEvent});return n?l.a.createElement(d.a,{id:t,onViewed:this.handleViewed},r):r}}]),t}(),o.propTypes={id:i.a.string,module:i.a.string,index:i.a.string,isAd:i.a.bool,content:i.a.object,extra:i.a.object,trackCardShow:i.a.bool,attachedInfoBytes:i.a.string},o.defaultProps={id:null,module:null,index:null,isAd:!1,content:null,extra:null,attachedInfoBytes:null,trackCardShow:!1},r);!function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}}();var b=n(132),g=n(396),w=n(78);n(1674);n.d(t,"a",function(){return N});var C,E,O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _={zhihu:"注册或登录",wechat:"使用微信快速登录",weibo:"使用微博快速登录",qq:"使用 QQ 快速登录"},j={qq:"qqconn",weibo:"sina",wechat:"wechat_mp"},N=(E=C=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.jumpToOAuthUrl=function(e){var t=o.props,n=t.redirectUrl,r=void 0===n?location.href:n,a=t.edition,i=t.utm,s=Object(w.b)(r,a,i),l=s.utmSource,c=s.refSource,p=u()(navigator.userAgent).isZhihu;location.href="zhihu"!==e?"https://www.zhihu.com/oauth/redirect/login/"+j[e]+"?next=/oauth/account_callback&from="+encodeURIComponent(r)+"&utm_source="+l+"&ref_source="+c:p?"zhihu://signin?next="+r:"https://www.zhihu.com/signin?next="+r+(l?"?utm_source="+l:"")},o.renderSignButtons=function(){var e=o.props.buttons;return"string"==typeof e?o.renderSingleSignButton({name:e}):e.map(function(e){return"string"==typeof e?o.renderSingleSignButton({name:e}):"object"===(void 0===e?"undefined":k(e))?o.renderSingleSignButton(e):null})},o.renderSingleSignButton=function(e){var t=e.name,n=e.text,r=e.fill,a=e.color,i="#fff"===r||"#ffffff"===r;return-1===Object.keys(_).indexOf(t)?null:l.a.createElement("button",{className:"SignInModal-button-"+t,key:t,style:{backgroundColor:r,borderColor:i?"#0f88eb":r,color:i?"#0f88eb":a},onClick:function(){o.jumpToOAuthUrl(t)}},n||_[t])},S(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),P(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.utm,o=e.edition,r=o.yidianzixun,a=o.baidu,i=e.urlScheme,s=this.props.title||(a||!i?"":"打开 App 或")+"登录后继续操作";return r&&(s="打开知乎 App 继续操作"),l.a.createElement(b.b,{size:"small",className:"SignInModal",title:s,onClose:t},l.a.createElement(y,{module:"SignForm",moduleName:s,trackCardShow:!0},l.a.createElement("div",{className:"SignInModal-content"},i&&!a&&l.a.createElement(g.a,O({className:"SignInModal-openInAppButton",href:i},n),"立即打开",r?"":" App"),!r&&this.renderSignButtons())))}}]),t}(),C.propTypes={onClose:i.a.func.isRequired,urlScheme:i.a.string,redirectUrl:i.a.string,edition:i.a.object,buttons:i.a.oneOfType([i.a.array,i.a.string])},C.defaultProps={buttons:["zhihu"],edition:{},utm:{}},E)},1641:function(e,t,n){},1642:function(e,t,n){},1644:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(2),i=n.n(a);n(1680);t.a=function(e){var t=e.header,n=e.options,o=e.className,a=e.onRef,s=e.showOptions,l=void 0===s||s;return r.a.createElement("div",{className:i()("Topbar",o,!1),ref:a},r.a.createElement("div",{className:"Topbar-title"},t),l&&r.a.createElement("div",{className:"Topbar-options"},n))}},1674:function(e,t,n){},1675:function(e,t,n){},1676:function(e,t,n){e.exports=n.p+"assets/deleteComment.97d8abc0.gif"},1677:function(e,t,n){},1680:function(e,t,n){},1698:function(e,t,n){"use strict";t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=l(n(1803)),a=l(n(0)),i=l(n(1620)),s=(l(n(1804)),n(1805));function l(e){return e&&e.__esModule?e:{default:e}}i.default.any,i.default.func,i.default.node;var c=function(e){function t(n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n,r));return a.performAppear=function(e,t){a.currentlyTransitioningKeys[e]=!0,t.componentWillAppear?t.componentWillAppear(a._handleDoneAppearing.bind(a,e,t)):a._handleDoneAppearing(e,t)},a._handleDoneAppearing=function(e,t){t.componentDidAppear&&t.componentDidAppear(),delete a.currentlyTransitioningKeys[e];var n=(0,s.getChildMapping)(a.props.children);n&&n.hasOwnProperty(e)||a.performLeave(e,t)},a.performEnter=function(e,t){a.currentlyTransitioningKeys[e]=!0,t.componentWillEnter?t.componentWillEnter(a._handleDoneEntering.bind(a,e,t)):a._handleDoneEntering(e,t)},a._handleDoneEntering=function(e,t){t.componentDidEnter&&t.componentDidEnter(),delete a.currentlyTransitioningKeys[e];var n=(0,s.getChildMapping)(a.props.children);n&&n.hasOwnProperty(e)||a.performLeave(e,t)},a.performLeave=function(e,t){a.currentlyTransitioningKeys[e]=!0,t.componentWillLeave?t.componentWillLeave(a._handleDoneLeaving.bind(a,e,t)):a._handleDoneLeaving(e,t)},a._handleDoneLeaving=function(e,t){t.componentDidLeave&&t.componentDidLeave(),delete a.currentlyTransitioningKeys[e];var n=(0,s.getChildMapping)(a.props.children);n&&n.hasOwnProperty(e)?a.keysToEnter.push(e):a.setState(function(t){var n=o({},t.children);return delete n[e],{children:n}})},a.childRefs=Object.create(null),a.state={children:(0,s.getChildMapping)(n.children)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},t.prototype.componentDidMount=function(){var e=this.state.children;for(var t in e)e[t]&&this.performAppear(t,this.childRefs[t])},t.prototype.componentWillReceiveProps=function(e){var t=(0,s.getChildMapping)(e.children),n=this.state.children;for(var o in this.setState({children:(0,s.mergeChildMappings)(n,t)}),t){var r=n&&n.hasOwnProperty(o);!t[o]||r||this.currentlyTransitioningKeys[o]||this.keysToEnter.push(o)}for(var a in n){var i=t&&t.hasOwnProperty(a);!n[a]||i||this.currentlyTransitioningKeys[a]||this.keysToLeave.push(a)}},t.prototype.componentDidUpdate=function(){var e=this,t=this.keysToEnter;this.keysToEnter=[],t.forEach(function(t){return e.performEnter(t,e.childRefs[t])});var n=this.keysToLeave;this.keysToLeave=[],n.forEach(function(t){return e.performLeave(t,e.childRefs[t])})},t.prototype.render=function(){var e=this,t=[],n=function(n){var o=e.state.children[n];if(o){var i="string"!=typeof o.ref,s=e.props.childFactory(o),l=function(t){e.childRefs[n]=t};s===o&&i&&(l=(0,r.default)(o.ref,l)),t.push(a.default.cloneElement(s,{key:n,ref:l}))}};for(var i in this.state.children)n(i);var s=o({},this.props);return delete s.transitionLeave,delete s.transitionName,delete s.transitionAppear,delete s.transitionEnter,delete s.childFactory,delete s.transitionLeaveTimeout,delete s.transitionEnterTimeout,delete s.transitionAppearTimeout,delete s.component,a.default.createElement(this.props.component,s,t)},t}(a.default.Component);c.displayName="TransitionGroup",c.propTypes={},c.defaultProps={component:"span",childFactory:function(e){return e}},t.default=c,e.exports=t.default},1699:function(e,t,n){"use strict";t.__esModule=!0,t.nameShape=void 0,t.transitionTimeout=function(e){var t="transition"+e+"Timeout",n="transition"+e;return function(e){if(e[n]){if(null==e[t])return new Error(t+" wasn't supplied to CSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof e[t])return new Error(t+" must be a number (in milliseconds)")}return null}};r(n(0));var o=r(n(1620));function r(e){return e&&e.__esModule?e:{default:e}}t.nameShape=o.default.oneOfType([o.default.string,o.default.shape({enter:o.default.string,leave:o.default.string,active:o.default.string}),o.default.shape({enter:o.default.string,enterActive:o.default.string,leave:o.default.string,leaveActive:o.default.string,appear:o.default.string,appearActive:o.default.string})])},1709:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(2),i=n.n(a),s=n(71),l=n.n(s),c=(n(1711),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var u=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.state={uid:l()()},a.handleChange=function(e){var t=e.target.files;t&&a.uploadFiles(t),a.setState({uid:l()()})},a.uploadFiles=function(e){var t=a.props.multiple,n=l()(),o=Array.prototype.slice.call(e);t?o.map(function(e){a.upload(e,n)}):a.upload(o[0],n)},a.upload=function(e,t){var n=a.props,o=n.beforeUpload,r=n.customUpload,i=n.onStart,s=n.onSuccess,l=n.onError,c=void 0;if(o&&(c=o(e)),!1!==c&&r){var u={file:e,uid:t,status:"uploading"};i&&i(u),Promise.resolve().then(function(){return r({file:e})}).then(function(e){s&&s(Object.assign({},u,{remoteInfo:e,status:"success"}))}).catch(function(e){l&&l(Object.assign({},u,{remoteInfo:e,status:"error"}))})}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),c(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.accept,o=e.multiple,a=e.disabled,s=e.onRef,l=e.onClick,c=e.children;return r.a.createElement("label",{className:i()("UploadPicture-wrapper",t)},r.a.createElement("input",{type:"file",accept:n,multiple:o,className:"UploadPicture-input",disabled:a,ref:s,onChange:this.handleChange,onClick:l}),c)}}]),t}();u.defaultProps={multiple:!1,disabled:!1},n.d(t,"a",function(){return u})},1711:function(e,t,n){},1714:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M18.453 7.992l-1.833-1.65.964-.978a1.223 1.223 0 0 1 1.73-.012l.005.006a1.24 1.24 0 0 1 .007 1.748l-.873.886zm-1.178 1.194l-5.578 5.66-1.935.697a.393.393 0 0 1-.504-.504l.697-1.935 5.488-5.567 1.832 1.65zM7.58 5.848l5.654.006-1.539 1.991-3.666.012A1.02 1.02 0 0 0 7 8.868v7.993c0 .558.46 1.01 1.029 1.01l7.941-.01c.568 0 1.03-.453 1.03-1.012v-4.061l2-1.442v6.002c0 1.397-1.2 2.501-2.62 2.501H7.574C6.153 19.85 5 18.717 5 17.32V8.35c0-1.397 1.16-2.502 2.58-2.502z"}))};i.defaultProps={name:"EditSurround"},t.a=i},1715:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M6 3.956v16.088C6 21.124 6.517 22 7.9 22c.326 0 .533-.087.896-.236L22 13.784c.571-.355 1.143-.87 1.143-1.784S22.57 10.571 22 10.216L8.796 2.236C8.433 2.087 8.226 2 7.9 2 6.514 2 6 2.876 6 3.956z"}))};i.defaultProps={name:"Play"},t.a=i},1785:function(e,t,n){"use strict";var o=a(n(1800)),r=a(n(1698));function a(e){return e&&e.__esModule?e:{default:e}}e.exports={TransitionGroup:r.default,CSSTransitionGroup:o.default}},1787:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z",fillRule:"evenodd"}))};i.defaultProps={name:"ArrowDown"},t.a=i},1796:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(2),i=n.n(a),s=n(4),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var c=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.handleClick=function(){var e=a.props;(0,e.onSelect)(e.page)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),l(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.isCurrent,o=e.className;return r.a.createElement(s.c,{preset:s.b.Plain,className:i()("PaginationButton",{"PaginationButton--current":n},o),onClick:this.handleClick,disabled:n},t)}}]),t}(),u=(n(1831),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.from({length:t},function(t,n){return n+e})},d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),u(t,[{key:"render",value:function(){var e,t=this.props,n=t.onSelect,o=t.className,a=t.clickCallback,s=this.props.current,l=this.props.total,u=a&&(e=a,function(){e.apply(void 0,arguments)})||n,d=function(e,t){var n="...";return t<=5?m(1,t):e>t-3?[1,n].concat(p(m(t-3,3)),[t]):e<=3?[1].concat(p(m(2,3)),[n,t]):[1,n].concat(p(m(e-Math.floor(1.5),3)),[n,t])}(s,l);return r.a.createElement("div",{className:i()("Pagination",o)},s>1&&s<=l&&r.a.createElement(c,{className:"PaginationButton-prev",onSelect:u,text:"上一页",page:s-1}),d.map(function(e,t){return"number"==typeof e?r.a.createElement(c,{onSelect:u,text:e,page:e,key:t,isCurrent:s===e}):r.a.createElement("button",{disabled:!0,key:t,className:"PaginationButton PaginationButton--ellipsis"},e)}),s>0&&s<l&&r.a.createElement(c,{className:"PaginationButton-next",onSelect:u,text:"下一页",page:s+1}))}}]),t}();d.defaultProps={current:1,total:1,onSelect:function(){}},n.d(t,"a",function(){return d})},1800:function(e,t,n){"use strict";t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=c(n(0)),a=c(n(1620)),i=c(n(1698)),s=c(n(1806)),l=n(1699);function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}l.nameShape.isRequired,a.default.bool,a.default.bool,a.default.bool,(0,l.transitionTimeout)("Appear"),(0,l.transitionTimeout)("Enter"),(0,l.transitionTimeout)("Leave");var p=function(e){function t(){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];return n=o=u(this,e.call.apply(e,[this].concat(i))),o._wrapChild=function(e){return r.default.createElement(s.default,{name:o.props.transitionName,appear:o.props.transitionAppear,enter:o.props.transitionEnter,leave:o.props.transitionLeave,appearTimeout:o.props.transitionAppearTimeout,enterTimeout:o.props.transitionEnterTimeout,leaveTimeout:o.props.transitionLeaveTimeout},e)},u(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){return r.default.createElement(i.default,o({},this.props,{childFactory:this._wrapChild}))},t}(r.default.Component);p.displayName="CSSTransitionGroup",p.propTypes={},p.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},t.default=p,e.exports=t.default},1801:function(e,t,n){"use strict";var o=n(405),r=n(383),a=n(1802);e.exports=function(){function e(e,t,n,o,i,s){s!==a&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=o,n.PropTypes=n,n}},1802:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1803:function(e,t){e.exports=function(){for(var e=arguments.length,t=[],n=0;n<e;n++)t[n]=arguments[n];if(0!==(t=t.filter(function(e){return null!=e})).length)return 1===t.length?t[0]:t.reduce(function(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}})}},1804:function(e,t,n){e.exports=n(31)(14)},1805:function(e,t,n){"use strict";t.__esModule=!0,t.getChildMapping=function(e){if(!e)return e;var t={};return o.Children.map(e,function(e){return e}).forEach(function(e){t[e.key]=e}),t},t.mergeChildMappings=function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var o={},r=[];for(var a in e)t.hasOwnProperty(a)?r.length&&(o[a]=r,r=[]):r.push(a);var i=void 0,s={};for(var l in t){if(o.hasOwnProperty(l))for(i=0;i<o[l].length;i++){var c=o[l][i];s[o[l][i]]=n(c)}s[l]=n(l)}for(i=0;i<r.length;i++)s[r[i]]=n(r[i]);return s};var o=n(0)},1806:function(e,t,n){"use strict";t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=m(n(1807)),a=m(n(1809)),i=m(n(698)),s=n(1810),l=m(n(0)),c=m(n(1620)),u=n(17),p=n(1699);function m(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=[];s.transitionEnd&&f.push(s.transitionEnd),s.animationEnd&&f.push(s.animationEnd);c.default.node,p.nameShape.isRequired,c.default.bool,c.default.bool,c.default.bool,c.default.number,c.default.number,c.default.number;var h=function(e){function t(){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=d(this,e.call.apply(e,[this].concat(a))),o.componentWillAppear=function(e){o.props.appear?o.transition("appear",e,o.props.appearTimeout):e()},o.componentWillEnter=function(e){o.props.enter?o.transition("enter",e,o.props.enterTimeout):e()},o.componentWillLeave=function(e){o.props.leave?o.transition("leave",e,o.props.leaveTimeout):e()},d(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){this.classNameAndNodeQueue=[],this.transitionTimeouts=[]},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(e){clearTimeout(e)}),this.classNameAndNodeQueue.length=0},t.prototype.transition=function(e,t,n){var o=(0,u.findDOMNode)(this);if(o){var i=this.props.name[e]||this.props.name+"-"+e,l=this.props.name[e+"Active"]||i+"-active",c=null,p=void 0;(0,r.default)(o,i),this.queueClassAndNode(l,o);var m=function(e){e&&e.target!==o||(clearTimeout(c),p&&p(),(0,a.default)(o,i),(0,a.default)(o,l),p&&p(),t&&t())};n?(c=setTimeout(m,n),this.transitionTimeouts.push(c)):s.transitionEnd&&(p=function(e,t){return f.length?f.forEach(function(n){return e.addEventListener(n,t,!1)}):setTimeout(t,0),function(){f.length&&f.forEach(function(n){return e.removeEventListener(n,t,!1)})}}(o,m))}else t&&t()},t.prototype.queueClassAndNode=function(e,t){var n=this;this.classNameAndNodeQueue.push({className:e,node:t}),this.rafHandle||(this.rafHandle=(0,i.default)(function(){return n.flushClassNameAndNodeQueue()}))},t.prototype.flushClassNameAndNodeQueue=function(){this.unmounted||this.classNameAndNodeQueue.forEach(function(e){e.node.scrollTop,(0,r.default)(e.node,e.className)}),this.classNameAndNodeQueue.length=0,this.rafHandle=null},t.prototype.render=function(){var e=o({},this.props);return delete e.name,delete e.appear,delete e.enter,delete e.leave,delete e.appearTimeout,delete e.enterTimeout,delete e.leaveTimeout,delete e.children,l.default.cloneElement(l.default.Children.only(this.props.children),e)},t}(l.default.Component);h.displayName="CSSTransitionGroupChild",h.propTypes={},t.default=h,e.exports=t.default},1807:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.classList?e.classList.add(t):(0,a.default)(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))};var o,r=n(1808),a=(o=r)&&o.__esModule?o:{default:o};e.exports=t.default},1808:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")},e.exports=t.default},1809:function(e,t,n){"use strict";function o(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}e.exports=function(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=o(e.className,t):e.setAttribute("class",o(e.className&&e.className.baseVal||"",t))}},1810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationEnd=t.animationDelay=t.animationTiming=t.animationDuration=t.animationName=t.transitionEnd=t.transitionDuration=t.transitionDelay=t.transitionTiming=t.transitionProperty=t.transform=void 0;var o,r=n(299);var a="transform",i=void 0,s=void 0,l=void 0,c=void 0,u=void 0,p=void 0,m=void 0,d=void 0,f=void 0,h=void 0,v=void 0;if(((o=r)&&o.__esModule?o:{default:o}).default){var y=function(){for(var e=document.createElement("div").style,t={O:function(e){return"o"+e.toLowerCase()},Moz:function(e){return e.toLowerCase()},Webkit:function(e){return"webkit"+e},ms:function(e){return"MS"+e}},n=Object.keys(t),o=void 0,r=void 0,a="",i=0;i<n.length;i++){var s=n[i];if(s+"TransitionProperty"in e){a="-"+s.toLowerCase(),o=t[s]("TransitionEnd"),r=t[s]("AnimationEnd");break}}!o&&"transitionProperty"in e&&(o="transitionend");!r&&"animationName"in e&&(r="animationend");return e=null,{animationEnd:r,transitionEnd:o,prefix:a}}();i=y.prefix,t.transitionEnd=s=y.transitionEnd,t.animationEnd=l=y.animationEnd,t.transform=a=i+"-"+a,t.transitionProperty=c=i+"-transition-property",t.transitionDuration=u=i+"-transition-duration",t.transitionDelay=m=i+"-transition-delay",t.transitionTiming=p=i+"-transition-timing-function",t.animationName=d=i+"-animation-name",t.animationDuration=f=i+"-animation-duration",t.animationTiming=h=i+"-animation-delay",t.animationDelay=v=i+"-animation-timing-function"}t.transform=a,t.transitionProperty=c,t.transitionTiming=p,t.transitionDelay=m,t.transitionDuration=u,t.transitionEnd=s,t.animationName=d,t.animationDuration=f,t.animationTiming=h,t.animationDelay=v,t.animationEnd=l,t.default={transform:a,end:s,property:c,timing:p,delay:m,duration:u}},1816:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm-.034 2.966c1.949 0 1.485 1.807 1.485 2.211 0 .115-.785 7.79-.785 7.79h-1.4s-.785-7.623-.785-7.738c0-.416-.463-2.263 1.485-2.263zm1.057 13.522c-.294.287-.647.43-1.056.43-.41 0-.762-.142-1.058-.43a1.429 1.429 0 0 1-.443-1.07c0-.41.148-.762.443-1.057a1.443 1.443 0 0 1 1.058-.442c.409 0 .762.143 1.056.43.296.287.443.644.443 1.07 0 .427-.147.783-.443 1.07z",fillRule:"evenodd"}))};i.defaultProps={name:"Alert"},t.a=i},1819:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z",fillRule:"evenodd"}))};i.defaultProps={name:"Check"},t.a=i},1831:function(e,t,n){},1904:function(e,t,n){"use strict";var o,r,a=n(0),i=n.n(a),s=n(1),l=n.n(s),c=n(2),u=n.n(c),p=n(1587),m=n(4),d=n(202),f=n(1644),h=n(2516),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b,g,w={normal:{text:"默认排序",value:"reverse"},reverse:{text:"时间排序",value:"normal"}},C=(r=o=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={text:"时间排序",value:"normal"},o.switchType=function(e){var t=o.state.value,n=o.props.onOrderChange,r=w[t],a=r.text,i=r.value;o.setState({text:a,value:i}),n&&n(i,e)},y(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),v(t,[{key:"render",value:function(){var e=this.state.text,t=this.props,n=t.isConversation,o=t.commentClosed;return t.shouldReverse?!n&&!o&&i.a.createElement(m.c,{preset:"plain",onClick:this.switchType,icon:h.a,label:"切换为"+e}):null}}]),t}(),o.propTypes={isConversation:l.a.bool,commentClosed:l.a.bool,onOrderChange:l.a.func,shouldReverse:l.a.bool},r),E=n(24),O=(n(2642),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var k=(g=b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),O(t,[{key:"render",value:function(){var e=this.props,t=e.commentPattern,n=e.onNavBack;return i.a.createElement("h2",{className:"CommentTopbar-title"},"bottom"!==t?i.a.createElement(m.c,{className:"CommentTopbar-back",preset:"plain",onClick:n},i.a.createElement(E.a,{className:"CommentTopbar-backIcon",name:"arrowLeft",left:!0,width:14,height:14}),"返回评论"):i.a.createElement("div",null,"查看对话"))}}]),t}(),b.propTypes={commentPattern:l.a.string,onNavBack:l.a.func},g);n(2643);n.d(t,"a",function(){return N});var P,S,_=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var N=(S=P=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=o=j(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.renderTopBarSwitch=function(){var e=o.props,t=e.isMobile,n=e.status,r=e.isConversation,a=e.commentCount,s=e.onOrderChange,l=e.commentClosed,c=e.shouldReverse;return!t&&Boolean(a&&!l)&&"reviewing"!==n&&i.a.createElement(C,{isConversation:r,onOrderChange:s,commentClosed:l,shouldReverse:c})},j(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),_(t,[{key:"renderTitle",value:function(){var e=this.props,t=e.commentCount,n=e.commentClosed,o=e.isConversation,r=e.onNavBack,s=e.targetLink,l=e.isCommentReviewer,c=e.reviewingCounts,f=e.onStatusChange,h=e.status,v=e.commentPattern,y=e.isOrg,b=e.isMobile,g=e.isBaidu;return o?i.a.createElement(k,{commentPattern:v,onNavBack:r}):l&&!n?i.a.createElement("div",{className:"CommentTopbar-tabsWrapper"},i.a.createElement(p.b,{className:"CommentTopbar-tabs"},i.a.createElement(p.a,{className:"CommentTopbar-tab","aria-controls":"CommentTopbar-open",meta:Object(d.formatNumber)(t)},i.a.createElement(m.c,{className:u()("CommentTopbar-tabButton",{"is-active":"open"===h}),onClick:function(){return f("open")}},"公开评论")),!b&&i.a.createElement(p.a,{className:"CommentTopbar-tab","aria-controls":"CommentTopbar-reviewing",meta:void 0===c?null:Object(d.formatNumber)(c)},i.a.createElement(m.c,{className:u()("CommentTopbar-tabButton",{"is-active":"reviewing"===h}),onClick:function(){return f("reviewing")}},"待"+(y?"审核":"筛选")+"评论"))),s):i.a.createElement(a.Fragment,null,i.a.createElement("h2",{className:"CommentTopbar-title"},t&&!n?Object(d.formatNumber)(t)+" 条评论":"还没有评论",s),g&&this.renderTopBarSwitch())}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.onRef,o=e.isMobile,r=e.isBaidu,a=e.options;return i.a.createElement(f.a,{className:u()("CommentTopbar",t),onRef:n,header:this.renderTitle(),options:r?a:this.renderTopBarSwitch(),showOptions:!o})}}]),t}(),P.propTypes={commentCount:l.a.oneOfType([l.a.number,l.a.string]),isConversation:l.a.bool,onNavBack:l.a.func,isCommentReviewer:l.a.bool,onStatusChange:l.a.func,onOrderChange:l.a.func,status:l.a.string,reviewingCounts:l.a.oneOfType([l.a.number,l.a.string]),targetLink:l.a.node,commentClosed:l.a.bool,commentPattern:l.a.string,isOrg:l.a.bool,isMobile:l.a.bool,isBaidu:l.a.bool,options:l.a.element,shouldReverse:l.a.bool},P.defaultProps={shouldReverse:!0},S)},1977:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm0-3.681a1.17 1.17 0 0 1-.846-.344 1.143 1.143 0 0 1-.354-.856c0-.328.118-.61.354-.847.236-.235.518-.353.846-.353.328 0 .61.115.846.344.236.23.354.515.354.856 0 .342-.118.626-.354.856-.236.229-.518.344-.846.344zm2.761-7.398c-.228.232-.637.621-1.227 1.17-.163.154-.295.29-.393.407a1.643 1.643 0 0 0-.22.32 1.614 1.614 0 0 0-.111.293c-.026.097-.066.267-.119.512-.09.518-.377.777-.857.777a.86.86 0 0 1-.63-.254c-.17-.17-.255-.421-.255-.755 0-.419.062-.78.187-1.087.125-.307.29-.576.497-.808.206-.231.485-.506.835-.825.307-.28.53-.49.666-.632.137-.142.252-.3.346-.474.093-.175.14-.364.14-.568 0-.399-.143-.735-.428-1.01-.286-.273-.655-.41-1.106-.41-.528 0-.917.138-1.166.414-.25.277-.46.684-.634 1.222-.163.563-.472.845-.928.845a.896.896 0 0 1-.68-.295c-.185-.197-.278-.41-.278-.64 0-.473.147-.952.44-1.438.292-.486.72-.888 1.28-1.207C10.683 6.16 11.339 6 12.087 6c.696 0 1.31.133 1.844.4a3.02 3.02 0 0 1 1.234 1.087c.291.459.436.957.436 1.495 0 .423-.083.794-.248 1.113a3.413 3.413 0 0 1-.59.826z",fillRule:"evenodd"}))};i.defaultProps={name:"Help"},t.a=i},1992:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M12 11l-3.716 3.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l4.249-4.512a.758.758 0 0 1 1.064 0l4.246 4.512a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063 0L12.002 11z",fillRule:"evenodd"}))};i.defaultProps={name:"ArrowUp"},t.a=i},1996:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z",fillRule:"evenodd"}))};i.defaultProps={name:"Like"},t.a=i},2137:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-2.762-5.37c.243.246.452.37.78.37.33 0 .576-.203.827-.443.25-.24 7.052-7.054 7.052-7.054a.988.988 0 0 0-.311-1.354.973.973 0 0 0-1.345.315l-6.222 6.077-2.31-2.418a.971.971 0 0 0-1.368-.19.988.988 0 0 0-.188 1.377s2.841 3.074 3.085 3.32z",fillRule:"evenodd"}))};i.defaultProps={name:"CheckCircle"},t.a=i},2150:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(0),r=n.n(o),a=n(140),i=(n(2641),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["PureComponent"]),i(t,[{key:"render",value:function(){var e=this.props.onRef;return r.a.createElement("div",{className:"Comments-pattern-loading",ref:e},r.a.createElement(a.a,null))}}]),t}()},2151:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.selectedKey,i=void 0===a?"selectedProps":a,s=n.dropedKey,l=void 0===s?"dropedProps":s;return Object.keys(e).reduce(function(n,a){var s=t.includes(a)?i:l;return o({},n,r({},s,o({},n[s],r({},a,e[a]))))},{})}},2152:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=function(e){return"article"===e?"Post":"book_review"===e?"BookReview":""+e.slice(0,1).toUpperCase()+e.slice(1)}},2374:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M17.007 11.504c0 .65-.13 1.26-.36 1.83l3 3.073S23 14.136 23 11.504C23 8.008 17.255 4 11.995 4c-1.4 0-2.741.25-3.982.701l2.161 2.16c.57-.23 1.18-.36 1.831-.36a5.004 5.004 0 0 1 5.002 5.003zM2.57 4.342l2.067 2.075C3.499 7.258 1 9.119 1 11.504c0 3.336 5.79 7.503 11.005 7.503 1.55 0 3.031-.3 4.382-.84l.42.42 2.125 2.118s.782.571 1.314 0-.074-1.305-.074-1.305L3.955 3.183s-.76-.742-1.385-.19c-.626.554 0 1.35 0 1.35zm4.963 4.96l1.55 1.552c-.05.21-.08.43-.08.65 0 1.66 1.341 3.001 3.002 3.001.22 0 .44-.03.65-.08l1.551 1.551c-.67.33-1.41.53-2.2.53a5.004 5.004 0 0 1-5.003-5.002c0-.79.2-1.53.53-2.201zm4.312-.78l3.151 3.152.02-.16c0-1.66-1.34-3.001-3.001-3.001l-.17.01z",opacity:".9",fillRule:"evenodd"}))};i.defaultProps={name:"EyeSlash"},t.a=i},2430:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M19.947 3.129c-.633.136-3.927.639-5.697.385-3.133-.45-4.776-2.54-9.949-.888-.997.413-1.277 1.038-1.277 2.019L3 20.808c0 .3.101.54.304.718a.97.97 0 0 0 .73.304c.275 0 .519-.102.73-.304.202-.179.304-.418.304-.718v-6.58c4.533-1.235 8.047.668 8.562.864 2.343.893 5.542.008 6.774-.657.397-.178.596-.474.596-.887V3.964c0-.599-.42-.972-1.053-.835z",fillRule:"evenodd"}))};i.defaultProps={name:"Report"},t.a=i},2502:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M1 11.5C1 15 7 19 12 19s11-4 11-7.5S17 4 12 4 1 8 1 11.5zm11 5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm-3-5c0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3-3 1.34-3 3z",fillRule:"evenodd"}))};i.defaultProps={name:"Eye"},t.a=i},2516:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M13.004 7V4.232c0-.405.35-.733.781-.733.183 0 .36.06.501.17l6.437 5.033c.331.26.376.722.1 1.033a.803.803 0 0 1-.601.264H2.75a.75.75 0 0 1-.75-.75V7.75A.75.75 0 0 1 2.75 7h10.254zm-1.997 9.999v2.768c0 .405-.35.733-.782.733a.814.814 0 0 1-.5-.17l-6.437-5.034a.702.702 0 0 1-.1-1.032.803.803 0 0 1 .6-.264H21.25a.75.75 0 0 1 .75.75v1.499a.75.75 0 0 1-.75.75H11.007z",fillRule:"evenodd"}))};i.defaultProps={name:"Switch"},t.a=i},2565:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M18 8c.1-3.308-2.592-6-5.9-6-3.308 0-6 2.692-6 6v2H5.002C4 10 4 11 4 11v9s0 2 2 2h12c2 0 2-1.97 2-1.97V11s0-1-1-1h-1V8zm-6-4c2.143.018 4.005 1.597 4 4v2H8V7.996C8.013 5.562 9.857 3.982 12 4z",fillRule:"evenodd"}))};i.defaultProps={name:"Lock"},t.a=i},2639:function(e,t,n){},2640:function(e,t,n){},2641:function(e,t,n){},2642:function(e,t,n){},2643:function(e,t,n){},2644:function(e,t,n){},2645:function(e,t,n){var o=n(438),r=n(170),a=n(439),i=Math.max,s=Math.min;e.exports=function(e,t,n){var l=null==e?0:e.length;if(!l)return-1;var c=l-1;return void 0!==n&&(c=a(n),c=n<0?i(l+c,0):s(c,l-1)),o(e,r(t,3),c,!0)}},2646:function(e,t,n){},2647:function(e,t,n){},2648:function(e,t,n){},2649:function(e,t,n){},2650:function(e,t,n){},2651:function(e,t,n){},2652:function(e,t,n){},2653:function(e,t,n){},2654:function(e,t,n){},2655:function(e,t){e.exports={attributes:{width:"72px",height:"58px",viewBox:"0 0 72 58"},content:'<defs>         <path d="M0.00434937116,11.7604183 C0.0014585125,11.8367351 0,11.9134174 0,11.9904392 L0,52.0095608 C0,55.3137533 2.68603825,58 5.99943435,58 L66.0005656,58 C69.3089213,58 72,55.317989 72,52.0095608 L72,11.9904392 C72,8.68624675 69.3139617,6 66.0005656,6 L31.1520961,6 L30.2346555,3.7077864 C29.4154984,1.66113281 26.9585394,0 24.7478675,0 L6.18638069,0 C2.86742525,0 0.139552484,2.68348852 0.0902454792,5.99373937 L0.00434937116,11.7604183 Z" id="path-1"></path>         <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="72" height="58" fill="white">             <use xlink:href="#path-1"></use>         </mask>     </defs>     <g id="空状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">         <g id="collection" transform="translate(-39.000000, -30.000000)" stroke="#E7EAF1">             <g transform="translate(39.000000, 30.000000)" id="Group-7">                 <g>                     <use id="Combined-Shape" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use>                     <path d="M36.4126782,38.4800003 L30.2669271,41.2927815 C29.7656337,41.522213 29.4096881,41.2718295 29.4738593,40.716584 L30.2498317,34.0024302 L25.6755762,29.0266708 C25.3024658,28.6208107 25.4306014,28.2049135 25.9785012,28.0943637 L32.6038296,26.7575697 L35.9225353,20.8696 C36.1932338,20.3893332 36.6283715,20.3826781 36.9028211,20.8696 L40.2215268,26.7575697 L46.8468552,28.0943637 C47.3872665,28.2034026 47.5280608,28.6151866 47.1497802,29.0266708 L42.5755247,34.0024302 L43.3514971,40.716584 C43.4147912,41.2642406 43.0666691,41.5253922 42.5584293,41.2927815 L36.4126782,38.4800003 Z" id="Star" stroke-width="3"></path>                 </g>             </g>         </g>     </g>'}},2656:function(e,t,n){},2657:function(e,t,n){},2658:function(e,t,n){},2659:function(e,t,n){},2660:function(e,t,n){},2661:function(e,t,n){},2662:function(e,t,n){},2663:function(e,t,n){},2811:function(e,t,n){},2812:function(e,t,n){},2813:function(e,t,n){},2814:function(e,t,n){},2818:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M16.464 4s.051-2-1.479-2H9C7.194 2 7.465 4 7.465 4H4.752c-2.57 0-2.09 3.5 0 3.5l1.213 13.027S5.965 22 7.475 22h8.987c1.502 0 1.502-1.473 1.502-1.473l1.2-13.027c2.34 0 2.563-3.5 0-3.5h-2.7zM8.936 18.5l-.581-9h1.802v9H8.936zm4.824 0v-9h1.801l-.61 9H13.76z",fillRule:"evenodd"}))};i.defaultProps={name:"Trash"},t.a=i},2819:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M22.959 17.22c-1.686-3.552-5.128-8.062-11.636-8.65-.539-.053-1.376-.436-1.376-1.561V4.678c0-.521-.635-.915-1.116-.521L1.469 10.67a1.506 1.506 0 0 0-.1 2.08s6.99 6.818 7.443 7.114c.453.295 1.136.124 1.135-.501V17a1.525 1.525 0 0 1 1.532-1.466c1.186-.139 7.597-.077 10.33 2.396 0 0 .396.257.536.257.892 0 .614-.967.614-.967z",fillRule:"evenodd"}))};i.defaultProps={name:"Reply"},t.a=i},2820:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(8),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M6.433 14.285l-.918 5.355c-.219 1.274.532 1.82 1.676 1.218l4.81-2.528 4.807 2.528c1.145.601 1.896.056 1.677-1.218l-.918-5.355 3.89-3.792c.925-.903.64-1.785-.64-1.97l-2.843-.414c-.538.583-4.195 4.547-5.757 6.12-.865.822-1.572.015-1.572.015l-1.92-1.906s-.405-.623.213-1.204c.62-.58 1.174-.193 1.174-.193l1.32 1.14 4.008-4.34-2.404-4.872c-.572-1.159-1.5-1.159-2.072 0L8.56 7.741l-5.376.781c-1.279.186-1.566 1.068-.64 1.971l3.89 3.792z",fillRule:"evenodd"}))};i.defaultProps={name:"Recommend"},t.a=i},2821:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(2),i=n.n(a),s=n(143),l=n.n(s),c=n(9),u=(n(446),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e){var t=e.currentTarget,n=t.getAttribute("href");c.default.trackEvent(t,{id:5109},{link:{url:n}})}var d=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=o=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),o.rootRef=r.a.createRef(),o.unobserve=l.a,o.renderTarget=function(){var e=o.props.item,t=e.content.target,n=t.text,a=t.link,i=e.id,s=e.target,l=e.target,c=(l=void 0===l?{}:l).id,u=l.target,p=void 0===u?{}:u,d=p.type;return s&&"comment"===s.type?o.renderCommentButton(n,{type:d,href:a,byComment:c,target:p,notificationId:i}):r.a.createElement("span",null,a?r.a.createElement("a",{href:a,onClick:m},n):r.a.createElement("span",null,n))},p(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),u(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.addObserve,n=e.item.attachInfo,o=this.rootRef.current;c.default.setModule(o,{module:"Content"},{attached_info_bytes:n}),this.unobserve=t(o)}},{key:"componentWillUnmount",value:function(){this.unobserve()}},{key:"renderCommentButton",value:function(e,t){var n=this,o=t.href,a=t.byComment,i=t.notificationId;return r.a.createElement("a",{href:o+(a?"#comment-"+a+"?notificationId="+i:""),onClick:function(e){m(e),e.preventDefault(),n.props.onCommentsModalOpen(t)}},e)}},{key:"render",value:function(){var e,t=this.props.item,n=t.content,o=n.verb,a=n.actors,s=t.isRead;return r.a.createElement("div",{ref:this.rootRef,className:i()("PushNotifications-item",{"PushNotifications-newItem":!s})},r.a.createElement("span",null,(e=a,Array.isArray(e)||(e=[e]),e.map(function(e,t){return r.a.createElement("span",{className:"PushNotifications-actor",key:t},e.link?r.a.createElement("a",{href:e.link,onClick:m},e.name):r.a.createElement("span",null,e.name))})))," ",o," ",this.renderTarget())}}]),t}();t.default=d},2829:function(e,t,n){"use strict";n.r(t);var o,r,a,i,s,l=n(1),c=n.n(l),u=n(0),p=n.n(u),m=n(9),d=n(132),f=n(2),h=n.n(f),v=n(1547),y=n(4),b=n(32),g=(n(2657),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E="oneself",O="enterprise",k=[{title:"发表澄清声明",image:"https://zhstatic.zhihu.com/assets/report/Statement@3x.png",description:(o={},C(o,E,"个人可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。"),C(o,O,"企业可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。"),o),defaultReasonIdMap:(r={},C(r,E,46),C(r,O,48),r)},{title:"提交侵权举报",image:"https://zhstatic.zhihu.com/assets/report/Infringement@3x.png",description:p.a.createElement("span",null,"您提交的侵权举报将会根据知乎侵权举报规范进行受理"),defaultReasonIdMap:(a={},C(a,E,47),C(a,O,49),a),memberReasonIdMap:(i={},C(i,E,12),C(i,O,13),i)}],P=(C(s={},O,"当您发现知乎上存在涉嫌侵犯您企业合法权益的内容时，您可以先尝试与作者沟通解决，如沟通无效，也可以通过以下方式向知乎提出诉求。"),C(s,E,"当您发现知乎上存在涉嫌侵犯您个人合法权益的内容时，您可以通过以下方式向知乎提出诉求。"),s),S=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){m.default.trackEvent(e,{id:3467})},w(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.a.Component),g(t,[{key:"componentDidMount",value:function(){m.default.trackCardShow(null,{id:3466})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onSubMenuEnter,o=t.onBackClick,r=t.activeId,a=t.isMobile,i=t.type,s=["answer","article","pin"].includes(i)?k:k.slice(1),l=function(e,t){return("member"===e?10===t:29===t)?E:O}(i,r);return p.a.createElement("section",{className:h()("ReportInfringement",{"ReportInfringement--mobile":a})},p.a.createElement("p",{className:"ReportInfringement-subtitle"},P[l]),p.a.createElement("ul",{className:"ReportInfringement-list"},s.map(function(t){var o=t.image,r=t.title,a=t.description,s=t.defaultReasonIdMap,c=t.memberReasonIdMap,u=("member"===i?c:s)[l],m=a[l]||a;return p.a.createElement("li",{className:"ReportInfringement-item",key:r,"data-za-module":"Content","data-za-detail-view-path-module_name":r,onClick:function(t){e.handleClick(t.currentTarget),n(u)}},p.a.createElement("img",{className:"ReportInfringement-image",src:o}),p.a.createElement("div",{className:"ReportInfringement-content"},p.a.createElement("h1",{className:"ReportInfringement-itemTitle"},r),p.a.createElement("p",{className:"ReportInfringement-itemDescription"},m)),p.a.createElement(v.a,{className:"ReportInfringement-arrow"}))})),p.a.createElement(b.a,{direction:"horizontal"},p.a.createElement(y.c,{"data-za-module":"Content","data-za-detail-path-view-module_name":"返回",onClick:function(t){e.handleClick(t.currentTarget),o()}},"返回")))}}]),t}(),_=n(26),j=function(e){return"https://www.zhihu.com/account/infringement?"+Object(_.stringify)(e)};n(2658);function N(e){var t=e.infringementType;return p.a.createElement("p",{className:"ReportOrgContent"},"若您已注册机构号，可使用",p.a.createElement("span",{className:"ReportOrgContent-highlight"},"机构号"),"declare"===t?"发表澄清声明":"提交侵权举报","，",p.a.createElement("span",{className:"ReportOrgContent-highlight"},"免提交资质材料"),"。")}n(2659);function T(e){var t=e.infringementType,n=e.isIndividualReason,o=e.onBackClick,r="declare"===t;return p.a.createElement("div",{className:"ReportInfringementMobile"},p.a.createElement("p",{className:"ReportInfringementMobile-text"},"1."," ",r?(n?"个人":"企业")+"可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。":"您提交的侵权举报将会根据知乎侵权举报规范进行受理。"),p.a.createElement("p",{className:"ReportInfringementMobile-text"},"2. 根据",p.a.createElement("a",{className:"ReportInfringementMobile-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，",r?"以发表澄清声明。":"并规范填写投诉说明。","若您已确认完毕，",p.a.createElement("span",{className:"ReportInfringementMobile-bold"},"请到桌面版网页进行诉求提交。")),!n&&p.a.createElement("p",{className:"ReportInfringementMobile-text"},"若您已注册机构号，可使用机构号"+(r?"发表澄清声明":"提交侵权举报")+"，免提交资质材料。"),p.a.createElement("img",{className:"ReportInfringementMobile-img",src:"https://zhstatic.zhihu.com/report/app_report.png"}),p.a.createElement(y.c,{color:y.a.Blue,preset:y.b.Primary,onClick:o,className:"ReportInfringementMobile-button"},"我知道了"))}n(2660);var R=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function I(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var x=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=I(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){m.default.trackEvent(null,{id:3469},{button:{text:e}})},I(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.a.Component),R(t,[{key:"componentDidMount",value:function(){m.default.trackCardShow(null,{id:3468})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,o=t.urlToken,r=t.type,a=46===t.activeId;return t.isMobile?p.a.createElement(T,{isIndividualReason:a,infringementType:"declare",onBackClick:n}):p.a.createElement("section",{className:"ReportDeclare"},p.a.createElement("div",{className:"ReportDeclare-description"},"当您发现知乎上有关于您",a?"个人":"企业","的侵权内容时，您可通过此方式发表澄清声明。",p.a.createElement("br",null),p.a.createElement("br",null),"申请发表澄清声明的流程如下：",p.a.createElement("ul",null,p.a.createElement("li",null,"1. 在站内写一篇",p.a.createElement("a",{href:"https://zhuanlan.zhihu.com/write",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("澄清声明文章")}},"澄清声明文章"),"并发布。",p.a.createElement("a",{href:"https://zhstatic.zhihu.com/assets/report/template-v2.png",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("查看模版")}},"查看模版"),p.a.createElement("br",null)),p.a.createElement("li",null,"2.返回此页面继续发表声明，您需按照提示提供完整、有效的证明材料。",p.a.createElement("br",null)),p.a.createElement("li",null,"3.审核通过后，侵权纠纷内容上会关联展示您的澄清声明，点击可跳转至您的声明全文。")),!a&&p.a.createElement(N,{infringementType:"declare"})),p.a.createElement(b.a,{direction:"horizontal"},p.a.createElement(y.c,{onClick:n},"返回"),p.a.createElement(y.c,{onClick:function(){return e.handleClick("继续发表声明")},component:"a",href:j({infringementType:"declare",resourceId:o,type:r,reasonType:a?"inflictIndividual":"enterprise"}),className:"ReportDeclare-continue",color:y.a.Blue,preset:y.b.Primary},"继续发表声明")))}}]),t}(),L=(n(2661),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function A(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var M,B,D=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=A(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){m.default.trackEvent(null,{id:3510},{button:{text:e}})},A(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.a.Component),L(t,[{key:"componentDidMount",value:function(){m.default.trackCardShow(null,{id:3509})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,o=t.urlToken,r=t.type,a=t.activeId,i="member"===r?12===a:47===a;return t.isMobile?p.a.createElement(T,{isIndividualReason:i,infringementType:"trespass",onBackClick:n}):p.a.createElement("section",{className:"ReportTrespass"},p.a.createElement("p",{className:"ReportTrespass-description"},"根据",p.a.createElement("a",{href:"https://www.zhihu.com/terms#sec-report",onClick:function(){e.handleClick("知乎侵权举报规范")}},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，并规范填写投诉说明。若您已确认完毕，请继续提交举报信息。"),!i&&p.a.createElement(N,{infringementType:"trespass"}),p.a.createElement(b.a,{direction:"horizontal"},p.a.createElement(y.c,{onClick:function(){e.handleClick("返回"),n()}},"返回"),p.a.createElement(y.c,{onClick:function(){e.handleClick("继续提交举报")},component:"a",href:j({resourceId:o,type:r,reasonType:i?"inflictIndividual":"enterprise"}),className:"ReportTrespass-continue",color:y.a.Blue,preset:y.b.Primary},"继续提交举报")))}}]),t}(),F=[{id:0,text:"举报",childIds:[1,2,3,4,5,21,7,8,9]},{id:1,text:"低质问题",types:["question"],childIds:[23,33,34,15,35,27,22]},{id:2,text:"垃圾广告信息",reason:"spam",copywriter:{title:"举报说明",placeholder:"举报详细说明（选填）",isRequired:!1},disabled:!0},{id:3,text:"不友善行为",types:["answer","comment","article","column","pin","book_review","favlist"],childIds:[40,41]},{id:4,text:"有害信息",childIds:[19,30,39,26,18,28]},{id:5,text:"涉嫌侵权",childIds:[20,29,12],types:["question","answer","comment","article","column","pin","book_review"],reason:"infringement",disabled:!0},{id:6,types:[]},{id:7,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:8,reason:"direction",shouldShow:function(e){return e.isColumnArticle}},{id:9,reason:"tipjar",shouldShow:function(e){return e.isTipjarEnabled}},{id:10,reason:"mention"},{id:11,reason:"privacy",disabled:!0},{id:12,reason:"enterprise",disabled:!0,customComponent:S},{id:13,reason:"copy",copywriter:{title:"原文链接或出处",placeholder:"填写原文链接或描述内容出处（必填）"},disabled:!0},{id:14,reason:"defamation",disabled:!0},{id:15,reason:"abuse"},{id:16,reason:"intention"},{id:17,reason:"spam"},{id:18,reason:"illegality",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:19,reason:"politics"},{id:20,reason:"repost",copywriter:{title:"举报说明",placeholder:"原文链接或补充说明（必填）"},types:["answer","article","column","pin","book_review"],disabled:!0},{id:21,reason:"temptation",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0,types:["answer","comment","article","column"]},{id:22,reason:"personal"},{id:23,reason:"ambiguity"},{id:24,reason:"worthless"},{id:25,reason:"rumour"},{id:26,reason:"suicide",types:["question","answer","article","column","pin","book_review","comment"]},{id:27,reason:"medicine"},{id:28,reason:"superstition"},{id:29,reason:"oneself",disabled:!0,customComponent:S},{id:30,reason:"porn"},{id:31,reason:"pirate"},{id:32,reason:"invalid"},{id:33,reason:"subjective"},{id:34,reason:"rumour"},{id:35,reason:"provoke"},{id:36,reason:"edit"},{id:37,reason:"harassment"},{id:38,reason:"hatred"},{id:39,text:"不实信息",types:["answer","comment","article","column","pin","book_review"],childIds:[42,43,44,45]},{id:40,reason:"abuse",text:"骚扰、辱骂、歧视等"},{id:41,reason:"unfriendly",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:42,reason:"untruth_science",text:"科学类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:43,reason:"untruth_rumor",text:"社会谣言类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:44,reason:"untruth_fake_profile",text:"编造经历类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:45,text:"诽谤等侵权信息",childIds:[20,29,12]},{id:46,customComponent:x,text:"发表澄清声明",reason:"declare",subtitle:"个人侵权"},{id:47,customComponent:D,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:48,customComponent:x,text:"发表澄清声明",reason:"declare",subtitle:"企业侵权"},{id:49,customComponent:D,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],z=[{id:0,text:"举报",childIds:[1,2,3,4]},{id:1,text:"垃圾广告信息",reason:"spam"},{id:2,text:"不友善行为",reason:"unkind"},{id:3,text:"有害信息",reason:"imitation"},{id:4,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0}],V=[{id:0,text:"举报",childIds:[1,2,3]},{id:1,reason:"abuse"},{id:2,reason:"harassment"},{id:3,reason:"spam"}],U=[{id:0,text:"举报",childIds:[1,4,6,7]},{id:1,text:"冒充我或他人",childIds:[8,9],reason:"fake",disabled:!0},{id:2,reason:"abuse",text:"发过辱骂我或他人的内容"},{id:3,reason:"illegality",text:"发过违反法律法规的内容"},{id:4,reason:"spam",text:"垃圾广告帐号"},{id:5,reason:"politics",text:"发过政治敏感内容"},{id:6,reason:"profile",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:7,reason:"old",text:"其他",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:8,text:"冒充我",subtitle:"请选择举报理由",reason:"oneself",disabled:!0,childIds:[10,11]},{id:9,reason:"impersonate",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},text:"冒充他人",disabled:!0},{id:10,text:"个人侵权",isRequired:!0,customComponent:S},{id:11,text:"企业侵权",isRequired:!0,customComponent:S},{id:12,isRequired:!0,customComponent:D,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:13,isRequired:!0,customComponent:D,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],q=n(59),W=n.n(q),H=n(195),G=n(2137),K=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Q,Y,$=(B=M=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleClick=e.handleClick.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),K(t,[{key:"handleClick",value:function(){var e=this.props,t=e.id,n=e.reason,o=e.disabled,r=e.onSubMenuEnter,a=e.onItemSelect;n&&!o?a(t):r(t)}},{key:"render",value:function(){var e=this.props,t=e.reason,n=e.text,o=e.disabled,r=e.isSelected,a=e.id,i=n||H.b[t];return Boolean(t&&!o)?p.a.createElement("label",{className:"ReportMenu-item",htmlFor:t},p.a.createElement("div",{className:"ReportMenu-itemValue needsclick"},i),p.a.createElement("input",{className:"ReportMenu-itemCheck",type:"radio",name:"report",value:a,id:t,checked:r,onChange:this.handleClick}),p.a.createElement(G.a,{size:18,className:"ReportMenu-itemCheckIcon",name:"checkRound"})):p.a.createElement("button",{className:"ReportMenu-item",onClick:this.handleClick},p.a.createElement("span",{className:"ReportMenu-itemValue"},i),p.a.createElement(v.a,{size:18}))}}]),t}(),M.propTypes={id:c.a.number.isRequired,reason:c.a.string,text:c.a.string,disabled:c.a.bool,isSelected:c.a.bool,onSubMenuEnter:c.a.func.isRequired,onItemSelect:c.a.func.isRequired},B),Z=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var X,J,ee=(Y=Q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),Z(t,[{key:"render",value:function(){switch(this.props.reason){case"privacy":return p.a.createElement("div",{className:"ReportMenu-inner"},p.a.createElement("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有泄漏您隐私的内容时，您可向知乎进行举报。 请您把以下内容通过邮件发送到 ",p.a.createElement("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"},"i@zhihu.com")," 邮箱，我们会尽快处理。"),p.a.createElement("ul",{className:"ReportMenu-paragraph"},p.a.createElement("li",null,"1. 您认为哪些内容泄露了您的隐私？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),p.a.createElement("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),p.a.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考",p.a.createElement("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"这里"),"；"));case"defamation":return p.a.createElement("div",{className:"ReportMenu-inner"},p.a.createElement("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有诽谤您的内容时，您可以向知乎进行举报。 请您把以下内容通过邮件发送到",p.a.createElement("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"}," ","i@zhihu.com"," "),"邮箱，我们会尽快处理。"),p.a.createElement("ul",{className:"ReportMenu-paragraph"},p.a.createElement("li",null,"1. 您举报的内容以及侵犯了您什么权益？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),p.a.createElement("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),p.a.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考 ",p.a.createElement("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"这里")," ；"));default:return null}}}]),t}(),Q.propTypes={reason:c.a.string.isRequired},Y),te=n(67),ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var oe=(J=X=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),ne(t,[{key:"render",value:function(){var e=this.props,t=e.copywriter.placeholder,n=e.onDetailInput,o=e.errorText,r=e.checkCustomReasonContent;return p.a.createElement("div",{className:"ReportMenu-inner"},p.a.createElement(te.a,{multiline:!0,grey:!0,rows:5,className:"ReportMenu-textarea",placeholder:t,onChange:function(e){return n(e.target.value)},onBlur:r}),p.a.createElement("div",{className:"ReportMenu-errorText"},o))}}]),t}(),X.propTypes={onDetailInput:c.a.func.isRequired,copywriter:c.a.object,errorText:c.a.string},J),re=(n(2662),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var ae,ie,se=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),re(t,[{key:"render",value:function(){var e=this.props,t=e.checked,n=e.onChange,o=e.name,r=e.text,a=e.desc,i=o||r;return p.a.createElement("div",null,p.a.createElement("label",{className:"ReportOption-check",htmlFor:i},p.a.createElement("input",{type:"checkbox",name:i,checked:t,onChange:n}),p.a.createElement("span",null,"同时",r)),a&&p.a.createElement("div",{className:"ReportOption-desc"},a))}}]),t}(),le=function(e){return e.length>150?{isLegal:!1,errorReason:H.a.contentTooLong}:/[\u4e00-\u9fa5a-zA-Z0-9]/.test(e)?{isLegal:!0,errorReason:""}:{isLegal:!1,errorReason:H.a.contentIllegal}},ce=(n(2663),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},pe=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function me(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var de,fe,he=(ie=ae=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=me(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={blockChecked:null,commentChecked:null,activeId:0,parentId:null,selectedId:null,errorText:"",isMobile:!1,isSubmiting:!1,isSubmited:!1,path:[]},o.menuItems={},o.getReportText=function(e){if(!e)return"";var t=o.props.nodes[e];return t&&(t.text||H.b[t.reason])||""},o.getReportLevel=function(){return"第 "+(o.state.path.length+1)+" 级"},o.handleItemSelect=function(e){var t=o.selectedId===e?null:e;o.setState({selectedId:t});var n=o.props,r=n.zaEnabled,a=n.type;t&&r&&m.default.trackEvent(null,{action:"Select",element:"Menu",id:2883,name:o.getReportLevel()},{button:{text:o.getReportText(e)},report:{id:e,type:a}})},o.handleSubMenuEnter=function(e){o.setState(function(t){var n=t.activeId,o=t.path;return{activeId:e,parentId:n,selectedId:null,path:o.concat([e])}});var t=o.props,n=t.zaEnabled,r=t.type;n&&m.default.trackEvent(null,{action:"Expand",element:"Menu",id:2883,name:o.getReportLevel()},{button:{text:o.getReportText(e)},report:{id:e,type:r}})},o.getCommentChecked=function(){var e=o.state,t=e.commentChecked,n=e.parentId,r=e.activeId;return"boolean"==typeof t?t:[2,3].includes(n||r)},o.handleDetailInput=function(e){o.setState({customReason:e,errorText:""})},o.handleBackClick=function(){var e=o.props.nodes,t=o.state,n=t.parentId,r=t.path,a=Object.keys(e).find(function(t){var o=e[t].childIds;return o&&o.includes(n)});o.setState({activeId:n,parentId:a&&Number(a),selectedId:null,hasWarning:!1,customReason:"",errorText:"",path:r.slice(0,-1)});var i=o.props,s=i.zaEnabled,l=i.type;s&&m.default.trackEvent(null,{action:"Back",element:"Button",id:2884,name:o.getReportLevel()},{report:{id:o.state.activeId,type:l}})},o.handleSubmitAppeal=function(){var e="",t=o.state.activeId,n=o.props,r=n.type,a=n.urlToken,i=n.nodes;"enterprise"===i[t].reason||13===t?e="org":"oneself"!==i[t].reason&&37!==t||(e="people"),window.open("//www.zhihu.com/account/complaints/"+e+"/"+r+"/"+a)},o.handleSubmit=function(){var e=o.state,t=e.selectedId,n=e.customReason,r=e.activeId,a=e.parentId,i=o.getCommentChecked();if(o.isSubmitEnabled()&&o.checkCustomReasonContent()){var s=o.props,l=s.nodes,c=s.onSubmit,u=s.onDeleteComment,p=l[t||r],d=p.reason,f=p.id;o.setState({isSubmiting:!0});var h=c({reason:d,customReason:n});h&&h.then?h.then(o.submitEnd):o.submitEnd();var v=u&&[2,3].includes(a||r),y=o.props,b=y.zaEnabled,g=y.type;b&&(m.default.trackEvent(null,{id:2885,name:o.getReportLevel()},{report:{type:g},button:{text:o.getReportText(f)}}),m.default.trackEvent(o,ue({action:"Report",element:"Button"},v&&{id:3039,name:d}),ue({report:{id:f,type:g}},v&&{button:{text:i?"举报并删除":"仅举报"}})))}},o.submitEnd=function(e){o.setState({isSubmiting:!1,isSubmited:!0});var t=o.state.blockChecked,n=o.props,r=n.onBlockUser,a=n.onDeleteComment,i=n.onEnd;Promise.all([t&&r&&r(),o.getCommentChecked()&&a&&a()].map(function(e){return Promise.resolve(e).catch(function(e){return e})})).then(function(t){var n=ce(t,2),o=n[0],r=n[1];i&&i({result:e,blockUserResult:o,commentDeleteResult:r})})},o.checkCustomReasonContent=function(){var e=o.state,t=e.activeId,n=e.customReason,r=o.props.nodes[t].copywriter;if((14===t||24===t||Boolean(r))&&n){var a=le(n),i=a.isLegal,s=a.errorReason;if(!i)return o.setState({errorText:s}),!1}return!0},me(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),pe(t,[{key:"componentDidMount",value:function(){var e=this.props.type,t=W()(navigator.userAgent);this.setState({isMobile:t.Mobile}),m.default.trackCardShow(null,{id:2890},{button:{text:e}})}},{key:"componentWillUpdate",value:function(e,t){var n=this.state.activeId,o=t.activeId,r=this.props,a=r.nodes,i=r.onContentChange;if(o!==n){var s=a[o],l=s.reason,c=s.text,u=s.childIds,p=s.copywriter,m=s.subtitle;i(c||H.b[l],m||p&&p.title||(u?void 0:""))}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.zaEnabled,n=e.type,o=this.state.isSubmited;t&&!o&&m.default.trackEvent(null,{id:4328,name:this.getReportLevel()},{report:{type:n}})}},{key:"isSubmitEnabled",value:function(){var e=this.state,t=e.selectedId,n=e.activeId,o=e.customReason,r=this.props.nodes;return t||(Boolean(r[n].copywriter)||14===n||24===n)&&(!1===r[n].copywriter.isRequired||o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,o=t.options,r=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["nodes","options"]),a=this.state,i=a.activeId,s=a.parentId,l=a.selectedId,c=a.errorText,u=a.isMobile,m=n[i],d=m.reason,f=m.childIds,v=m.copywriter,g=m.customComponent;if(void 0!==g)return p.a.createElement(g,ue({onBackClick:this.handleBackClick,onItemSelect:this.handleItemSelect,onSubMenuEnter:this.handleSubMenuEnter},this.props,this.state));var w=Boolean(f),C=14===i||24===i||Boolean(v),E=w&&p.a.createElement("div",{className:"ReportMenu-inner ReportMenu-options"},f.map(function(e){return n[e]}).filter(function(e){return e&&(!e.shouldShow||e.shouldShow(r))}).map(function(t){return p.a.createElement($,ue({ref:function(n){e.menuItems[t.id]=n},key:t.id},t,{isSelected:l===t.id,onSubMenuEnter:e.handleSubMenuEnter,onItemSelect:e.handleItemSelect}))})," ")||C&&p.a.createElement(oe,{onDetailInput:this.handleDetailInput,copywriter:v,errorText:c,checkCustomReasonContent:this.checkCustomReasonContent})||p.a.createElement(ee,{isMobile:u,reason:d}),O=w&&r.talkerToken&&p.a.createElement(se,{checked:this.state.blockChecked,text:"将此人屏蔽",onChange:function(t){return e.setState({blockChecked:t.target.checked})}}),k=s||i,P=r.onDeleteComment&&[2,3].includes(k)&&p.a.createElement(se,{checked:this.getCommentChecked(),desc:Boolean(k)&&"社区鼓励举报"+n[k].text+"，同时可以直接删除该评论，删除操作并不影响对违规内容和违规用户的处理。",onChange:function(t){return e.setState({commentChecked:t.target.checked})},text:"删除该评论"}),S=this.props.isSubmiting;return p.a.createElement("div",{className:h()("ReportMenu",{"ReportMenu-mobile":u})},E,(O||P)&&p.a.createElement("div",null,O,P,o),p.a.createElement(b.a,{direction:"horizontal"},"number"==typeof s&&p.a.createElement(y.c,{onClick:this.handleBackClick}," 返回 "),w||C?p.a.createElement(y.c,{className:"ReportMenu-button",disabled:S||!this.isSubmitEnabled(),onClick:this.handleSubmit,color:"blue",preset:"primary"},"举报"):!u&&p.a.createElement(y.c,{onClick:this.handleSubmitAppeal,preset:"primary",color:"blue"},"进入诉求提交页面")))}}]),t}(),ae.propTypes={nodes:c.a.object.isRequired,onContentChange:c.a.func.isRequired,onSubmit:c.a.func.isRequired,onEnd:c.a.func,onBlockUser:c.a.func,onDeleteComment:c.a.func,isColumnArticle:c.a.bool,isTipjarEnabled:c.a.bool},ie),ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function be(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ge,we,Ce=(fe=de=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=be(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.filterNodes=function(e,t,n){var o=e.filter(function(e){return!!e.isRequired||(-1!=["infringement","repost","oneself","enterprise","fake"].indexOf(e.reason)||0===e.id||("question"!==t||-1==["closed","suggested","evaluated","locked"].indexOf(n)||0===e.id)&&("member"!==t||-1==["ban","hang"].indexOf(n)||"profile"===e.reason))});return 1===o.length&&0===o[0].id&&(o=[]),o},be(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),ye(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.status,o=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["type","status"]),r=void 0;return r="message"===t?V:"member"===t?U:"favlist"===t?z:F.filter(function(e){return!e.types||e.types.includes(t)}),r=this.filterNodes(r,t,n),p.a.createElement(he,ve({nodes:r.reduce(function(e,t){return ve({},e,(n={},o=t.id,r=t,o in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,n));var n,o,r},{})},o,{type:t}))}}]),t}(),de.propTypes={type:c.a.string.isRequired},fe),Ee=n(2151),Oe=n(2152),ke=n(109),Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Se=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function _e(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var je="请选择举报理由",Ne="举报",Te=(we=ge=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=_e(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={title:void 0!==o.props.title?o.props.title:Ne,subtitle:void 0!==o.props.subtitle?o.props.subtitle:je},o.handleSubmit=function(e){var t=e.reason,n=e.customReason,r=o.props,a=r.urlToken,i=r.type;return o.props.doReport(a,i,t,n)},o.handleContentChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je;o.setState({title:e,subtitle:t})},o.handleClose=function(){o.props.zaEnabled&&m.default.trackEvent(o.container,{action:"Ok"},{button:{text:"知道了"}}),o.props.onClose()},_e(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),Se(t,[{key:"componentDidUpdate",value:function(e){if(!e.shown&&this.props.shown){var t=this.props,n=t.type,o=t.id;m.default.setModule(this.container,{module:"ReportDialog"},{card:{card_type:"Content",content:(r={type:Object(Oe.a)(n)},a="comment"===n?"id":"token",i=String(o),a in r?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i,r)}})}var r,a,i}},{key:"render",value:function(){var e=this,t=this.props,n=t.shown,o=t.onClose,r=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["shown","onClose"]),a=this.state,i=a.title,s=a.subtitle,l=Object(Ee.a)(r,Object.keys(d.b.propTypes)),c=l.selectedProps,u=l.dropedProps;return p.a.createElement(d.b,Pe({title:i,subtitle:s,onClose:this.handleClose,className:"ReportModal"},c),n&&p.a.createElement(Ce,Pe({ref:function(t){e.container=t},onSubmit:this.handleSubmit,onEnd:o,onContentChange:this.handleContentChange},u)))}}]),t}(),ge.propTypes={onClose:c.a.func.isRequired,type:c.a.oneOf(ke.a).isRequired,shown:c.a.bool.isRequired,isColumnArticle:c.a.bool,isTipjarEnabled:c.a.bool,onBlockUser:c.a.func,onDeleteComment:c.a.func,doReport:c.a.func.isRequired,zaEnabled:c.a.bool},ge.defaultTypes={zaEnabled:!1},we);n.d(t,"ReportModal",function(){return Te})},2830:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(1),i=n.n(a),s=n(13),l=n(2),c=n.n(l),u=n(423),p=n(1785),m=n(61),d=n(2645),f=n.n(d),h=n(1992),v=n(134),y=n(1796),b=n(202),g=n(212),w=n(17),C=n(15),E=n(9),O=n(688),k=n.n(O),P=n(21),S=n.n(P),_=n(4),j=n(407),N=n(168),T=n(409),R=n(70),I=n(213),x=n(1709),L=n(8),A=function(e){return r.a.createElement(L.a,e,r.a.createElement("path",{d:"M13.25 5.5H6.868c-.755 0-1.368.613-1.368 1.368v10.264c0 .755.613 1.368 1.368 1.368h10.264c.755 0 1.368-.613 1.368-1.368V10.75H20v6.467A2.783 2.783 0 0 1 17.217 20H6.783A2.783 2.783 0 0 1 4 17.217V6.783A2.783 2.783 0 0 1 6.783 4h6.467v1.5zM8.158 13.4a1.033 1.033 0 0 1 1.744-.078l.258.37a.782.782 0 0 0 1.303-.031l1.332-2.113a1.173 1.173 0 0 1 2.01.043l2.03 3.537A1.25 1.25 0 0 1 15.748 17H8.25a1.252 1.252 0 0 1-1.085-1.873l.992-1.728zM9.5 11a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3.75-5.5a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5zM18.5 4V2.25a.75.75 0 1 1 1.5 0V4h1.75a.75.75 0 1 1 0 1.5H20v1.75a.75.75 0 1 1-1.5 0V5.5h-1.75a.75.75 0 1 1 0-1.5h1.75zm.75 7.5a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5z"}))};A.defaultProps={name:"AddImage"};var M,B,D,F=A,z=n(1532),V=n(211),U=n(14),q=n(10),W="zhihu::comment_local_key",H=5,G=(q.I,1e3),K=980,Q=function(){return""},Y={error:"上传失败",success:"上传成功",uploadIng:"上传中",default:""},$=(n(2646),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),Z=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function X(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var J=Object(s.connect)(null,{showNotification:U.g,uploadImage:V.b})((D=B=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=X(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={uploadStatus:Y.default},o.triggerClick=function(e){var t=o.props.handleInputActive;o.uploadInput.click(),t(!0),e.preventDefault()},o.onError=function(){var e=o.props,t=e.showNotification,n=e.resetUploadImg;t("图片上传失败","red"),n()},o.onSuccess=function(){o.setState({uploadStatus:Y.default})},o.resetFileInput=function(){o.uploadInput.value=null},o.beforeUpload=function(e){var t=o.props.showNotification;return e?e.size>1024*q.I*1024?(t("请上传小于 "+q.I+"M 的图片。","red"),o.resetFileInput(),!1):(o.reactPopoverNode.open(),void o.setState({uploadStatus:Y.uploadIng})):(o.resetFileInput(),!1)},o.uploadImage=function(e){var t=e.file,n=o.props,r=n.uploadImage,a=n.handleImages,i=n.updatePublishStatus;r(t).then(function(e){a([$({},e.payload,{url:e.payload.src})]),i(!1),o.resetFileInput()}).catch(function(){o.setState({uploadStatus:Y.error}),a([])})},o.handleOnRef=function(e){var t=o.props.onRef;t&&t(e),o.reactPopoverNode=e},X(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Z(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.images,a=t.disableButton,i=t.resetUploadImg,s=this.state.uploadStatus,l=Boolean(n.length);return r.a.createElement(o.Fragment,null,r.a.createElement(R.a,{className:"ImagePopover",arrowed:!0,ref:this.handleOnRef,placement:"bottom",globalClose:!n.length,onClick:this.triggerClick,toggler:r.a.createElement(I.a,{label:"插入图片",icon:F,disabled:a})},r.a.createElement("div",{className:"ImagePopover-thumbnail"},l&&r.a.createElement(o.Fragment,null,r.a.createElement("img",{src:n[0].src}),r.a.createElement("div",{className:"closeButton",onClick:i},r.a.createElement(z.a,null))),s&&!l&&r.a.createElement("p",{className:"ImagePopover-uplodaStatus"},s))),r.a.createElement(x.a,{accept:"image/png,image/jpeg",onRef:function(t){e.uploadInput=t},beforeUpload:this.beforeUpload,customUpload:this.uploadImage,onSuccess:this.onSuccess,onError:this.onError}))}}]),t}(),B.propTypes={className:i.a.string,disableButton:i.a.bool},B.defaultProps={disableButton:!0},M=D))||M,ee=n(97),te=function(e){return r.a.createElement(L.a,e,r.a.createElement("path",{d:"M7.523 13.5h8.954c-.228 2.47-2.145 4-4.477 4-2.332 0-4.25-1.53-4.477-4zM12 21a9 9 0 1 1 0-18 9 9 0 0 1 0 18zm0-1.5a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15zm-3-8a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm6 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"}))};te.defaultProps={name:"Emotion"};var ne=te,oe=function(e){return r.a.createElement(L.a,e,r.a.createElement("path",{d:"M16.375 3.018C19.701 4.643 22 8.047 22 12a9.944 9.944 0 0 1-1.349 5c-1.73 2.986-4.952 5-8.651 5-3.7 0-6.921-2.014-8.651-5A9.944 9.944 0 0 1 2 12c0-3.951 2.298-7.357 5.625-8.982A9.95 9.95 0 0 1 12 2c1.571 0 3.051.373 4.375 1.018zm-4.322 11.17c1.5 0 2.911.662 3.871 1.817a.6.6 0 0 1-.514.978.599.599 0 0 1-.406-.214 3.823 3.823 0 0 0-2.951-1.385c-.605 0-1.185.136-1.723.407a3.85 3.85 0 0 0-1.321 1.093c-.039.05-.091.081-.141.116H8.19c-.006-.004-.013-.003-.018-.006a.6.6 0 0 1-.11-.839 5.074 5.074 0 0 1 1.73-1.433 4.988 4.988 0 0 1 2.26-.534zM8.875 10.75a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5zm6.25-2.5a1.25 1.25 0 1 1-.001 2.5 1.25 1.25 0 0 1 0-2.5zM19.17 17a8.695 8.695 0 0 0 1.58-5c0-3.23-1.764-6.05-4.375-7.566A8.698 8.698 0 0 0 12 3.25a8.69 8.69 0 0 0-4.375 1.184C5.014 5.95 3.25 8.77 3.25 12c0 1.859.586 3.581 1.579 5 1.583 2.264 4.205 3.75 7.171 3.75 2.965 0 5.586-1.486 7.17-3.75z",fillRule:"evenodd"}))};oe.defaultProps={name:"Sad"};var re,ae,ie=oe,se=(n(2647),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var le,ce,ue=(ae=re=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.state={isGifReady:!1,isGifError:!1},n.renderLoadStatus=function(){var e=n.state.isGifError;return r.a.createElement("div",{className:"CommentSticker-load"},e?r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{className:"CommentSticker-load-Icons"}),"加载失败"):r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,{className:"CommentSticker-load-Icons"}),"加载中"))};var o=n.props.src;return Object(ee.loadImage)(Object(ee.imgUrl)(o)).then(function(){n.setState({isGifReady:!0})}).catch(function(){n.setState({isGifError:!0})}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),se(t,[{key:"render",value:function(){var e=this.state.isGifReady,t=this.props,n=t.src,o=t.handleStickerClick;return r.a.createElement("div",{className:"CommentSticker"},e?r.a.createElement("img",{src:n,className:"CommentSticker-img",onClick:o}):this.renderLoadStatus())}}]),t}(),re.propsTypes={handleStickerClick:i.a.func},ae),pe=(n(2648),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function me(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var de,fe,he,ve,ye,be,ge=(ce=le=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=me(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleOnRef=function(e){var t=o.props.onRef;t&&t(e)},me(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),pe(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.sticker,o=e.stickers,a=e.disableButton,i=e.handleStickerPopoverOpen,s=e.handleStickerPopoverClose,l=e.resetStickers,c=e.addSticker,u=e.handleEmotionClick;return r.a.createElement(R.a,{className:t,arrowed:!0,ref:this.handleOnRef,globalClose:!n.length,preventCloseOnTarget:!0,onClick:u,onOpen:i,onClose:s,toggler:r.a.createElement(I.a,{label:"插入表情",icon:ne,disabled:a}),placement:"bottom"},Boolean(n.length)&&r.a.createElement("li",{className:"StickerPopover-stickers-item StickerPopover-stickers-item-single"},r.a.createElement("img",{src:Object(ee.imgUrl)(n[0].url),alt:n[0].title}),r.a.createElement("div",{className:"closeButton",onClick:l},r.a.createElement(z.a,null))),!n.length&&r.a.createElement("div",{className:"StickerPopover-stickers-wrap"},r.a.createElement("ul",{className:"StickerPopover-stickers-list"},o.map(function(e){var t=e.url,n=e.title,o=e.id;return r.a.createElement("li",{className:"StickerPopover-stickers-item",key:o},r.a.createElement(ue,{width:48,height:48,src:t,handleStickerClick:function(){return c(e)}}),r.a.createElement("p",null,n))}))))}}]),t}(),le.propTypes={className:i.a.string,disableButton:i.a.bool},le.defaultProps={disableButton:!0},ce),we=n(36),Ce=(n(2649),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),Ee=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Oe=(ye=["回复","",""],be=["回复","",""],Object.freeze(Object.defineProperties(ye,{raw:{value:Object.freeze(be)}})));function ke(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Pe=(de=Object(s.connect)(function(e){return{edition:Object(we.d)(e),referer:Object(we.g)(e),stickers:e.commentsV2.stickers||[],commentWithPicPermission:e.commentsV2.commentWithPicPermission||{}}},{showNotification:U.g}),Object(C.withRouter)(fe=de((ve=he=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=o=ke(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),o.state={active:!1,disabled:!0,shown:!1,value:{toHTML:Q},images:[],uploadIsFetchingNum:0,sticker:[],stickerIconActive:!1,toggleInputStyle:!1,commentTextLength:0},o.handleSubmit=o.context.authRequired(function(){var e=o.props,t=e.replyTo,n=e.onSubmit,r=e.onCancel,a=e.rootCommentId,i=e.isConversation,s=e.zaInfo.zaSubmitCommentId,l=o.state,c=l.images,u=l.sticker,p=o.input.toHTML();if(p||c.length||u.length){p&&o.saveLocalComment();var m=p;if(c.length||u.length){var d=c[0]||u[0];m+='<a class="'+(c[0]?c[0].url.includes(".gif")?"comment_gif":"comment_img":"comment_sticker")+"\" href='"+d.url+"' data-width='"+(d.dataRawwidth||"")+"' data-height='"+(d.dataRawheight||"")+"'>["+(d.title||"图片")+"]</a>"}var f=n(m,t,{rootCommentId:a,isConversation:i});f.then?f.then(function(){r&&r(),o.input?(o.input.reset(),o.resetImage(),o.setState({value:{toHTML:Q}},function(){return o.saveLocalComment()})):o.saveLocalComment({toHTML:Q})}):(r&&r(),o.input.reset()),E.default.trackEvent(o,Ce({action:"Comment",element:"Button"},s&&{id:s}))}},void 0,U.b),o.handleCommentShow=o.context.authRequired(function(){o.setState({shown:!0}),o.hiddenInput.focus()}),o.handleCommentHide=function(){o.setState({shown:!1})},o.initLocalComment=function(){var e=o.props,t=e.type,n=e.id;if(t&&n){var r=S.a.get(W)||[],a=t+"_"+n,i=r.find(function(e){return e.key===a}),s=i&&i.value;s&&o.setState({value:{toHTML:function(){return s}},disabled:!1})}},o.saveLocalComment=function(e){var t=o.props,n=t.type,r=t.id;if(n&&r){var a=e?e.toHTML():o.state.value.toHTML(),i=n+"_"+r,s=(S.a.get(W)||[]).filter(function(e){return e.key!==i}),l=a?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s.slice(0,H-1)),[{key:i,value:a}]):s;S.a.set(W,l)}},o.handleChange=function(e){var t=o.state,n=t.sticker,r=t.images;n.length||r.length?o.setState({value:e}):o.setState({value:e,disabled:e.isEmpty}),o.handleInputChange()},o.handleFocus=function(){o.setState({active:!0},o.handleInputChange)},o.handleBlur=function(){var e=o.state,t=e.sticker,n=e.images;t.length||n.length||(o.setState({active:!1}),o.handleInputChange())},o.handleMobileComment=function(){o.handleSubmit(),o.handleCommentHide()},o.handleEmotionClick=function(){var e=o.state.stickerIconActive;e&&o.setState({stickerIconActive:e},o.stickerPopover.close)},o.handleInputChange=function(){var e=Object(w.findDOMNode)(o.input);if(e){e.getBoundingClientRect().height>40?o.setState({toggleInputStyle:!0}):o.setState({toggleInputStyle:!1});var t=void 0;t="innerText"in document?e.innerText.length:e.textContent.length,o.setState({commentTextLength:t}),o.imgUploadPopover&&o.imgUploadPopover.position(),o.stickerPopover&&o.stickerPopover.position()}},o.handleStickerPopoverOpen=function(){o.setState({active:!0,stickerIconActive:!0},o.stickerPopover.position),setTimeout(o.stickerPopover.position,400)},o.handleStickerPopoverClose=function(){o.setState({stickerIconActive:!1})},o.handleImages=function(e){o.setState({images:e},o.imgUploadPopover.position)},o.handleInputActive=function(e){o.setState({active:e})},o.updatePublishStatus=function(e){o.setState({disabled:e})},o.resetStickers=function(){var e=o.state.value,t=void 0===e.isEmpty||e.isEmpty;o.stickerPopover&&o.stickerPopover.close(),o.setState({sticker:[],disabled:t})},o.resetImage=function(){o.resetStickers(),o.resetUploadImg()},o.resetUploadImg=function(){var e=o.state.value,t=void 0===e.isEmpty||e.isEmpty;o.imgUploadPopover&&o.imgUploadPopover.close(),o.setState({images:[],disabled:t})},o.addSticker=function(e){o.setState({sticker:[e],disabled:!1},o.stickerPopover.position)},o.focusInput=function(e){e.preventDefault(),o.input.focus()},o.createImageOnRef=function(e){o.imgUploadPopover=e},o.createStickerOnRef=function(e){o.stickerPopover=e},o.renderInput=function(e){var t=e.placeholder,n=e.className,a=o.props,i=a.autoFocus,s=a.stickers,l=a.commentWithPicPermission.commentWithPic,u=o.state,p=u.images,m=u.sticker,d=u.stickerIconActive,f=u.toggleInputStyle,h=u.active,v=u.disabled,y=u.commentTextLength,b=Boolean(m.length)||Boolean(p.length);return r.a.createElement("div",{className:c()("CommentEditorV2-inputWrap",{"CommentEditorV2-inputWrap--change":f,"CommentEditorV2-inputWrap--active":h||!v}),onClick:function(e){e.nativeEvent.stopImmediatePropagation()}},r.a.createElement(N.c,{keyMap:{FOCUS_COMMENT_INPUT:"shift+c"},handlers:{FOCUS_COMMENT_INPUT:o.focusInput}}),r.a.createElement(T.a,{className:c()("CommentEditorV2-input",n),defaultValue:o.state.value.toHTML(),richtext:!0,large:!0,spread:!0,allowMention:!0,allowPasteRichText:!1,autoFocus:i,outputBlockType:"div",onRef:function(e){o.input=e},placeholder:t,onFocus:o.handleFocus,onChange:o.handleChange,onSubmit:o.handleSubmit,minRows:5}),r.a.createElement("div",{className:c()("CommentEditorV2-inputUpload",{"CommentEditorV2-inputUpload--FlexEnd":f,"CommentEditorV2-inputUpload--SpaceBetween":f&&y>K})},f&&y>K&&r.a.createElement(j.a,{className:"CommentEditorV2-MaxLength",current:y,max:G}),r.a.createElement("div",{className:"CommentEditorV2-popoverWrap"},l&&r.a.createElement(J,{onRef:o.createImageOnRef,images:p,disableButton:b,resetUploadImg:o.resetUploadImg,handleInputActive:o.handleInputActive,updatePublishStatus:o.updatePublishStatus,handleImages:o.handleImages}),r.a.createElement(ge,{className:c()("CommentEditorV2-inputUpLoad-Icon",{"CommentEditorV2-inputUpLoad-Icon--active":d&&!m.length}),onRef:o.createStickerOnRef,disableButton:b,handleEmotionClick:o.handleEmotionClick,handleStickerPopoverOpen:o.handleStickerPopoverOpen,handleStickerPopoverClose:o.handleStickerPopoverClose,stickerIconActive:d,sticker:m,stickers:s,resetStickers:o.resetStickers,addSticker:o.addSticker}))))},ke(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Ee(t,[{key:"componentDidMount",value:function(){this.initLocalComment(),document.addEventListener("click",this.handleBlur)}},{key:"componentWillUnmount",value:function(){this.saveLocalComment(),document.removeEventListener("click",this.handleBlur)}},{key:"render",value:function(){var e=this.props,t=e.replyTo,n=e.commentNeedsReview,o=e.className,a=e.ownerAuthorIsOrg,i=e.ownerAuthorIsBrand,s=this.state,l=s.active,u=s.disabled,p=a?"机构":"作者",m={preset:"primary",color:"blue",children:"发布",disabled:u};if(t&&t.author){var d=k()(Oe,t.author.member.name,n?"，评论由"+p+"筛选后公开":"");return r.a.createElement("div",{className:c()(o,"CommentEditorV2--normal",{"CommentEditorV2--active":l||!u})},this.renderInput({placeholder:d}),r.a.createElement(_.c,Ce({},m,{className:"CommentEditorV2-singleButton",onClick:this.handleSubmit})))}var f="写下你的评论...";return n&&(f=i?"已开启预审评论，评论由品牌筛选后公开":a?"已开启预审评论，评论由机构筛选后公开":"评论由作者筛选后显示"),r.a.createElement("div",{className:c()(o,"CommentEditorV2--normal",{"CommentEditorV2--active":l||!u})},this.renderInput({placeholder:f}),r.a.createElement(_.c,Ce({},m,{className:"CommentEditorV2-singleButton",onClick:this.handleSubmit})))}}]),t}(),he.propTypes={className:i.a.string,defaultActive:i.a.bool,replyTo:i.a.object,inCommentItem:i.a.bool,commentNeedsReview:i.a.bool,canComment:i.a.object,onCancel:i.a.func,onSubmit:i.a.func.isRequired,zaInfo:i.a.object},he.defaultProps={defaultActive:!1,replyTo:null,inCommentItem:!1,autoFocus:!0,ownerAuthorIsOrg:!1,ownerAuthorIsBrand:!1,zaInfo:{}},he.contextTypes={authRequired:i.a.func},fe=ve))||fe)||fe),Se=n(2150),_e=n(1904),je=n(384),Ne=n(1996),Te=n(1816),Re=n(1551),Ie=n(2819),xe=n(2820),Le=n(2374),Ae=n(2430),Me=n(2818),Be=n(2502),De=n(58),Fe=n(1625),ze=n(206),Ve=n(133),Ue=n(1586),qe=n(1581),We=(n(2650),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function He(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Ge(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Ke,Qe,Ye,$e,Ze=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Ge(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={previewImg:null},o.handlePreview=function(e){var t=e.target;o.setState({previewImg:t})},Ge(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),We(t,[{key:"mount",value:function(){var e=this;this.imagesGifNode=this.root.getElementsByClassName("comment_gif"),this.imagesNode=this.root.getElementsByClassName("comment_img"),this.imagesStickerNode=this.root.getElementsByClassName("comment_sticker"),this.imgNode=this.root.getElementsByClassName("origin_image zh-lightbox-thumb"),this.imagesNodes=Array.from([].concat(He(this.imagesGifNode),He(this.imagesNode),He(this.imagesStickerNode),He(this.imgNode))).map(function(t){var n=t.dataset||{},o=n.width,r=n.height,a=n.rawwidth,i=n.rawheight,s=Number(o||a),l=Number(r||i),c=document.createElement("div");c.className="Richtext-content_img",t.parentNode.replaceChild(c,t);var u=t.getAttribute("href")||t.getAttribute("src"),p=new Image,m=t.getAttribute("class");return"comment_sticker"!==m&&c.addEventListener("click",e.handlePreview),p.className=m,p.src=u,p.dataset.original=Object(ee.imgUrl)(u,"r"),p.dataset.rawwidth=s,p.onload=function(){s===l||"comment_sticker"===m?c.classList.add("Richtext-content_img-square"):s>l?c.classList.add("Richtext-content_img-square--wideShape"):c.classList.add("Richtext-content_img-square--highShape"),c.appendChild(p)},c})}},{key:"unmount",value:function(){this.imagesNodes&&this.imagesNodes.forEach(function(e){Object(w.unmountComponentAtNode)(e)})}},{key:"componentDidMount",value:function(){this.mount()}},{key:"componentWillUpdate",value:function(e){this.props.html!==e.html&&this.unmount()}},{key:"componentDidUpdate",value:function(e){e.html!==this.props.html&&this.mount()}},{key:"componentWillUnmount",value:function(){this.unmount()}},{key:"render",value:function(){var e=this,t=this.state.previewImg,n=this.props,o=n.html,a=n.className;return r.a.createElement("div",{className:c()("CommentRichText",a),ref:function(t){return e.root=t}},r.a.createElement(qe.a,{html:o}),t&&r.a.createElement(Ue.a,{className:"CommentRichText-ImageView",img:t,onClose:function(){return e.setState({previewImg:null})}}))}}]),t}(),Xe=n(73),Je=n(445),et=(n(2651),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),tt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function nt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ot,rt,at=(Ke=Object(s.connect)(function(e){return{edition:Object(we.d)(e),referer:Object(we.g)(e),isWechat:e.env.userAgent.Wechat,permission:Object(De.H)(e)}}),Object(C.withRouter)(Qe=Ke(($e=Ye=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=nt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={reportModalShown:!1,isReplying:!1,collapsed:!0,guideShown:!1,deleteModal:!1},o.toggleReply=o.context.authRequired(function(){o.setState({isReplying:!o.state.isReplying})},void 0,U.b),o.openReportModal=o.context.authRequired(function(){o.setState({reportModalShown:!0})}),o.like=o.context.authRequired(function(e){var t=o.props;(0,t.onLike)(t.comment.id,e)},q.N.like,U.b),o.dislike=o.context.authRequired(function(){var e=o.props;(0,e.onDislike)(e.comment.id)},q.N.like,U.b),o.delete=function(){var e=o.props;return(0,e.onDelete)(e.comment.id)},o.feature=function(e){var t=o.props,n=t.onFeature,r=t.comment.id;n(e?r+"_featured":r)},o.collapse=function(){var e=o.props;(0,e.onCollapse)(e.comment.id)},o.approve=function(){var e=o.props;(0,e.onApprove)(e.comment.id)},o.reject=function(){var e=o.props;(0,e.onReject)(e.comment.id)},o.showConversation=function(e){var t=o.props;(0,t.onShowConversation)({commentId:t.comment.id,isAnchorComments:e})},o.stopReply=function(){o.setState({isReplying:!1})},o.closeReportModal=function(e){if(e){var t=e.result.payload,n=t&&t.message||t&&t.code&&"举报失败";e.commentDeleteResult&&!(e.commentDeleteResult.payload||{}).code?Fe.b.showModal({reportText:n}):Object(Xe.b)(n||"举报成功")}o.setState({reportModalShown:!1})},o.handleToggleGuide=function(){o.setState({guideShown:!o.state.guideShown})},o.handleCloseDelete=function(){return o.setState({deleteModal:!1})},o.handleDelete=function(){return o.setState({deleteModal:!0})},nt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),tt(t,[{key:"renderRoleInfo",value:function(e,t){return"normal"===e?null:r.a.createElement("span",{className:"CommentItemV2-roleInfo"},"ancestor"===e||"author"===e&&"question"===t?" (提问者) ":" (作者) ")}},{key:"renderReplyTo",value:function(){var e=this.props.comment,t=e.replyToAuthor,n=e.resourceType;if(!t)return null;var o=t.member,a=void 0===o?{}:o,i=t.role;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"CommentItemV2-reply"},"回复"),r.a.createElement(Ve.a,{noBadge:!0,noHoverCard:!0,user:a}),this.renderRoleInfo(i,n))}},{key:"renderItem",value:function(){var e=this,t=this.props,n=t.comment,o=n.isDelete,a=n.collapsed,i=t.isConversation,s=t.ownerAuthorIsOrg,l=a&&i&&this.state.collapsed,u=o||l,p=this.state,m=p.reportModalShown,d=p.isReplying,f=this.props,h=f.parent,v=h.canComment,y=(v=void 0===v?{status:!0}:v).status,b=h.questionType,g=f.commentNeedsReview,w=f.comment,C=f.onReply,E=f.status,O=f.type,k=f.canOperate,P=f.commentPattern,S=f.rootCommentId,j=f.byComment,N=f.isReverseAndStatusOpen,T=f.hasRecommend,R=f.permission.canBrandAdminEdit,I=w.id,x=w.author,L=w.content,A=w.voteCount,M=w.replyToAuthor,B=w.isAuthor,D=w.createdTime,F=w.featured,z=w.voting,V=w.reviewing,U=w.disliked,q=w.resourceType,W=w.childCommentCount,H=w.allowDelete,G=w.allowVote,K=w.canRecommend,Q=w.canCollapse,Y=w.collapsedReason,$=void 0===Y?"":Y,Z=a&&i?"该评论已被折叠":L,X=x||{},J=X.member,ee=X.role,te=Boolean(M),ne=F&&(W>0||te)&&!i||j&&te||N&&te,oe=void 0,re=B||H&&("question"!==O||"commercial"===b),ae=r.a.createElement("div",{className:"CommentItemV2-footer"},r.a.createElement(_.c,{className:c()("CommentItemV2-likeBtn",z&&"is-liked"),preset:"plain",onClick:this.like,disabled:B},r.a.createElement(Ne.a,{style:{marginRight:5},center:!0,size:16}),A>0?A:"赞"),a&&$&&r.a.createElement("div",{className:"CommentItemV2-walleTag"},"阴阳怪气自动折叠"===$&&r.a.createElement(Te.a,{size:16,className:"CommentItemV2-walleIcon"}),$),ne&&r.a.createElement(_.c,{preset:"plain",className:"CommentItemV2-talkBtn",onClick:function(){return e.showConversation(te)}},r.a.createElement(Re.a,{style:{marginRight:5},center:!0,size:16}),"查看回复"),!B&&y&&!a&&r.a.createElement(_.c,{preset:"plain",className:c()({"CommentItemV2-hoverBtn":!d}),onClick:this.toggleReply},r.a.createElement(Ie.a,{style:{marginRight:5},center:!0,size:16}),d?"取消回复":"回复"),K&&!T&&k&&r.a.createElement(_.c,{className:c()({"CommentItemV2-hoverBtn":!B&&!d}),preset:"plain",onClick:function(){return e.feature(F)}},r.a.createElement(xe.a,{style:{marginRight:5},center:!0,size:16}),F?"取消推荐":"推荐"),Q&&!B&&r.a.createElement(_.c,{className:c()({"CommentItemV2-hoverBtn":!B&&!d}),preset:"plain",onClick:this.collapse},r.a.createElement(Le.a,{style:{marginRight:5},center:!0,size:14}),a?"取消折叠":"折叠"),G&&!B&&k&&r.a.createElement(_.c,{className:c()({"CommentItemV2-hoverBtn":!d}),preset:"plain",onClick:this.dislike},r.a.createElement(Ne.a,{style:{transform:"rotate(180deg)",marginRight:5},size:16,center:!0}),U?"取消踩":"踩"),B||r.a.createElement(r.a.Fragment,null,r.a.createElement(_.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.openReportModal},r.a.createElement(Ae.a,{style:{marginRight:5},center:!0,size:16}),"举报"),"question"===O&&"commercial"===b&&R&&r.a.createElement(_.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.reject},r.a.createElement(Le.a,{style:{marginRight:5},center:!0,size:16}),"隐藏")),re&&r.a.createElement(_.c,{className:c()({"CommentItemV2-hoverBtn":!B&&!d&&!d}),preset:"plain",onClick:this.handleDelete},r.a.createElement(Me.a,{style:{marginRight:5},center:!0,size:16}),"删除"),r.a.createElement(Fe.a,{shown:this.state.deleteModal,id:I,onDelete:this.delete,onClose:this.handleCloseDelete}),r.a.createElement(ze.a,et({type:"comment",urlToken:I,shown:m,onClose:this.closeReportModal},re&&{onDeleteComment:this.delete},{notification:{failure:Je.a},zaEnabled:!0})));return oe=d?r.a.createElement("div",null,ae,r.a.createElement(Pe,{type:"comment",id:I,commentNeedsReview:g,className:"CommentItemV2-editor",defaultActive:!0,replyTo:w,onCancel:this.stopReply,onSubmit:C,rootCommentId:S,isConversation:i})):"reviewing"===E?r.a.createElement("div",{className:"CommentItemV2-footer"},r.a.createElement(_.c,{preset:"plain",onClick:this.approve},r.a.createElement(Be.a,{style:{marginRight:5},center:!0,size:14}),"公开"),r.a.createElement(_.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.handleDelete},r.a.createElement(Me.a,{style:{marginRight:5},center:!0,size:16}),"删除"),r.a.createElement(Fe.a,{shown:this.state.deleteModal,id:I,onDelete:this.delete,onClose:this.handleCloseDelete})):ae,r.a.createElement("div",null,r.a.createElement("div",{className:"CommentItemV2-meta"},J&&r.a.createElement(Ve.a,{className:"CommentItemV2-avatar",avatar:!0,noHoverCard:"fixed"===P,user:J}),J&&r.a.createElement(Ve.a,{noBadge:!0,noHoverCard:!0,user:J}),this.renderRoleInfo(ee,q),this.renderReplyTo(),V&&r.a.createElement(Le.a,{className:"CommentItemV2-reviewing","data-tooltip":!1===s?"评论未公开，由作者筛选后显示":"已开启预审评论，评论由机构筛选后公开",center:!0,size:14}),r.a.createElement("span",{className:"CommentItemV2-time"},Object(je.toRelativeString)(D))),r.a.createElement("div",{className:"CommentItemV2-metaSibling"},r.a.createElement(Ze,{className:c()("CommentItemV2-content",{"CommentItemV2-shield":u}),html:Z}),!u&&oe))}},{key:"render",value:function(){return this.renderItem()&&r.a.createElement("div",{className:"CommentItemV2",ref:this.props.onRef},this.renderItem())}}]),t}(),Ye.propTypes={comment:i.a.object.isRequired,parent:i.a.object.isRequired,commentNeedsReview:i.a.bool,type:i.a.string,isConversation:i.a.bool,onLike:i.a.func.isRequired,onShowConversation:i.a.func,onReply:i.a.func,onFeature:i.a.func,onDelete:i.a.func.isRequired,onCollapse:i.a.func,commentPattern:i.a.string},Ye.contextTypes={currentUser:i.a.object,authRequired:i.a.func},Qe=$e))||Qe)||Qe),it=(n(2652),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function st(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var lt,ct=5,ut=2,pt=(rt=ot=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=st(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={},o.handleClick=function(){var e,t,n,r=o.props,a=r.loadRestComments,i=r.onShowConversation,s=r.comment,l=s.id,c=s.childCommentCount,u=c<=ct&&c>ut;(u?a:i)({commentId:l}),u&&o.setState((n=!0,(t="hide_"+l)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e))},o.handleRef=function(e){var t=o.props.onRef;"function"==typeof t&&t(e)},st(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),it(t,[{key:"render",value:function(){var e=this.props,t=e.comment,n=t.id,o=t.childCommentCount,a=e.isFetching,i=e.className,s=this.state["hide_"+n],l=o<=ct&&o>ut?"展开其他 "+(o-ut)+" 条回复":"查看全部 "+o+" 条回复";return r.a.createElement("div",{className:i,ref:this.handleRef},!s&&r.a.createElement("div",{className:"CommentMoreReplyButton"},r.a.createElement(_.c,{preset:"plain",onClick:this.handleClick},l)),a&&r.a.createElement(v.a,{className:"CommentMoreReplyButton",small:!0}))}}]),t}(),ot.propTypes={comment:i.a.object.isRequired,isFetching:i.a.bool,onShowConversation:i.a.func,loadRestComments:i.a.func},rt),mt=(n(2653),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function dt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ft=Object(s.connect)(null,{loadConversation:u.g})(lt=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=dt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.loadRestComments=function(e){var t=e.commentId;(0,o.props.loadConversation)({id:t,isLoadRest:!0})},dt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),mt(t,[{key:"render",value:function(){var e=this.props,t=e.parent,n=t.type,a=t.author,i=(a=void 0===a?{isOrg:!1}:a).isOrg,s=e.parent,l=e.commentNeedsReview,u=e.onShowConversation,p=e.status,m=e.onItemLike,d=e.onItemDelete,f=e.onItemCollapse,h=e.onItemDislike,v=e.onItemApprove,y=e.onItemReject,b=e.canOperateItem,g=e.commentPattern,w=e.conversation,C=void 0===w?{}:w,E=e.entities,O=e.byComment,k=e.isReverseAndStatusOpen,P=e.comment,S=e.onReply,_=e.onFeature,j=e.ids,N=P.id,T=P.featured,R=P.childComments,I=void 0===R?[]:R,x=P.childCommentCount,L=void 0===x?0:x,A=T?N+"_featured":""+N,M=!T&&j.includes(N+"_featured"),B=Boolean(I.length)&&!k,D=L<=5&&L>2,F=I.map(function(e){return E.comments[e]}),z=!T&&L>2&&!k,V=(D&&C[N]||{isFetching:!1}).isFetching;return r.a.createElement(o.Fragment,null,r.a.createElement("li",{className:c()({"NestComment--rootCommentNoChild":!B,"NestComment--rootComment":B}),key:A},r.a.createElement(at,{key:A,comment:P,status:p,type:n,parent:s,canOperate:b,commentNeedsReview:l,onShowConversation:u,ownerAuthorIsOrg:i,onLike:m,onReply:S,onFeature:_,onDelete:d,onCollapse:f,onDislike:h,onApprove:v,onReject:y,commentPattern:g,rootCommentId:N,byComment:O,isReverseAndStatusOpen:k,hasRecommend:M})),B&&F.map(function(e){var t=e.id,o=e.featured,a=o?t+"_featured":""+t,c=!o&&j.includes(t+"_featured");return r.a.createElement("li",{className:"NestComment--child",key:a},r.a.createElement(at,{key:a,comment:e,status:p,type:n,parent:s,canOperate:b,commentNeedsReview:l,onShowConversation:u,ownerAuthorIsOrg:i,onLike:m,onReply:S,onFeature:_,onDelete:d,onCollapse:f,onDislike:h,onApprove:v,onReject:y,commentPattern:g,rootCommentId:N,hasRecommend:c}))}),z&&r.a.createElement(pt,{comment:P,isFetching:V,onShowConversation:u,loadRestComments:this.loadRestComments}))}}]),t}())||lt,ht=n(39),vt=n(392),yt=n(18);function bt(e){var t=e.id,n=e.replyTo,o=e.isConversation;if(e.isNotification)return{type:"notification"};if(o)return{type:"conversation"};if(!n)return{type:"comment"};var r=n.featured,a=n.replyToAuthor,i=n.id;return t===i&&r?a?{type:"replyToSubFeatured"}:{type:"replyToFeatured"}:t!==i||a?t!==i&&a?{type:"replyToSubCommon"}:{type:"comment"}:{type:"replyToCommon"}}n(2654);var gt,wt,Ct,Et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ot=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function kt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Pt=Object(s.connect)(function(e,t){var n=t.parent,o=t.parent,r=o.type,a=o.id,i=t.status,s=t.order,l=t.byComment,c=t.commentPattern,u=t.notificationId,p=e.entities,m=e.commentsV2,d=e.commentsV2,h=d.conversation,v=d.stickers,y=void 0===v?[]:v,b=d.commentWithPicPermission,g=d.notificationsComments,w=r+"_"+a,C=m.parent,E=p.comments[l],O=m.pagination;"reviewing"===i&&(O=m.reviewing);var k="reverse"===s&&"open"===i;k&&(O=m.reverse);var P=[],S=m.collapsed[w]||{};S.ids&&S.ids.length>0&&(P=S.ids.map(function(e){return p.comments[e]}));u&&(O=g,w=u);var _=O[w]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},j=_.isFetching,N=_.isPrevDrained,T=_.isDrained,R=_.ids,I=_.newIds,x=void 0===I?[]:I,L=_.totals,A="bottom"!==c?R:x,M=A.map(function(e){return p.comments[e]}),B=f()(A,function(e){return String(e).includes("_featured")});return{currentUser:Object(yt.c)(e),isFetching:j,isPrevDrained:N,isDrained:T,totals:u?M.length:L,collapsedInfo:S,collapsedComments:P,targetComment:E,conversation:h,entities:p,stickers:y,lastFeaturedIndex:B,comments:M,isReverseAndStatusOpen:k,commentWithPicPermission:b,ids:A,parent:Et({},n,C[w]),permission:Object(De.H)(e)}},{loadComments:u.f,loadConversation:u.g,addComment:u.a,loadStickers:u.j,clearNotification:U.e,getCommentWithPicPermission:u.e,loadNotificationComments:u.i,loadAnswerCommentPermission:ht.m,loadArticleCommentPermission:vt.b})((Ct=wt=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=o=kt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),o.state={collapsed:!0,current:1,packupButtonStatus:!1,packupButtonLeft:0},o.load=function(e,t,n){if(!o.props.isFetching&&!o.props.parent.adminClosedComment){var r=e||o.props,a=r.order,i=r.status,s=r.parent,l=s.id,c=s.type,u=r.commentPattern,p=r.needLoadCommentPermission,m=r.loadComments,d=r.notificationId,f=r.loadNotificationComments;if(d)return f(d);if(p&&o.loadCommentPermission(c,l),n){m(c,l,{order:a,isPrevious:t,status:"collapsed",commentPattern:u},!0)}else m(c,l,{order:a,isPrevious:t,status:i,commentPattern:u})}},o.addComment=function(e,t,n){var r=n.rootCommentId,a=n.isConversation,i=o.props,s=i.parent,l=s.id,c=s.type,u=i.commentId,p=i.addComment,m=i.notificationId;return p({parentType:c,parentId:l,content:e,replyTo:t,conversationId:u,rootCommentId:r,isConversation:a,notificationId:m,replyType:bt({id:r,replyTo:t,isConversation:a,isNotification:Boolean(m)}).type})},o.featureItem=function(e){(0,o.props.onItemFeature)(e,o.lastFeaturedIndex)},o.handleOpenCollapsed=function(){o.setState({collapsed:!1}),o.load(o.props,!1,!0)},o.handleScroll=function(){if(o.commentsElement&&o.commentsWithPaginationEl){var e=window.innerHeight,t=o.state.packupButtonStatus,n=o.commentsWithPaginationEl.getBoundingClientRect(),r=n.top,a=n.bottom,i=n.height;!t&&i>500&&a>e&&r<0?o.setState({packupButtonStatus:!0}):t&&(i<=500||a<=e||r>=0)&&o.setState({packupButtonStatus:!1})}},o.handlePageSelect=function(e){var t=o.props.onPaginationClick,n=o.state.current;t&&t(n,e),o.commentsElement.scrollIntoView(),o.setState({current:e}),o.loadByPagination(e)},o.loadByPagination=function(e,t){var n=t||o.props,r=n.order,a=n.status,i=n.parent,s=i.id,l=i.type,c=n.commentPattern,u=n.needLoadCommentPermission,p=n.loadComments;u&&o.loadCommentPermission(l,s),p(l,s,{order:r,isPrevious:!1,status:a,commentPattern:c,current:e})},o.renderComment=function(e){var t=e.id,n=e.featured?t+"_featured":t;return r.a.createElement("ul",{className:"NestComment",key:n},r.a.createElement(ft,Et({comment:e,onReply:o.addComment,onFeature:o.featureItem},o.props)))},o.renderNormalComments=function(e){var t=o.state.collapsed,n=o.props,a=n.byComment,i=n.lastFeaturedIndex,s=n.parent,l=s.featuredCounts,c=s.commonCounts,u=[],p=l>0;return o.lastFeaturedIndex=0,e.length>0&&e.forEach(function(n,s){if(a||!n.collapsed){var m=e[s-1];n.collapsed&&(m&&m.collapsed||u.push(o.renderCollapsedDivider()),t)||(s===i&&u.push(r.a.createElement("div",{className:"NestComment-nextSiblings--noBorder",key:"NestComment-nextSiblings--noBorder"})),p&&0===s&&-1!==i&&u.push(r.a.createElement("div",{className:"CommentListV2-header-divider",key:"divider-featured"},"精选评论（",l,"）")),u.push(o.renderComment(n)),s===i&&(o.lastFeaturedIndex=s,u.push(r.a.createElement("div",{className:"CommentListV2-header-divider",key:"divider-comment"},"评论（",c,"）"))))}}),u},o.renderCollapsedComments=function(){var e=[],t=o.props,n=t.collapsedComments,r=t.isDrained,a=t.parent,i=(a=void 0===a?{}:a).collapsedCounts;return!r||i<=0?[]:(e.push(n.map(function(e){return o.renderComment(e)})),e)},o.renderComments=function(e){return e.map(o.renderComment)},o.renderCollapsedDivider=function(){var e=o.props,t=e.isDrained,n=e.parent.collapsedCounts;return!t||n<=0?[]:o.state.collapsed?r.a.createElement("div",{className:"CommentListV2-action",key:"collapsed"},r.a.createElement("div",{className:"CommentListV2-expendCollapseButton"},r.a.createElement("span",{onClick:o.handleOpenCollapsed},Object(b.formatNumber)(n)," 条评论被折叠"),"（",r.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):r.a.createElement("div",{className:"CommentListV2-divider",key:"divider-collapsed"},r.a.createElement("div",{className:"CommentListV2-dividerLine"}),r.a.createElement("div",{className:"CommentListV2-dividerText"},Object(b.formatNumber)(n)," 条评论被折叠（",r.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))},o.renderCollapsedInfiLoader=function(){var e=o.state.collapsed;if(e)return[];var t=o.props.collapsedInfo,n=(t=void 0===t?{}:t).isFetching,a=t.isPrevDrained,i=t.isDrained;return r.a.createElement(v.b,{className:"CommentListV2",onRef:function(e){o.listEl=e},isLocal:!0,isLoading:n,isPrevDrained:a,isDrained:i,onLoad:function(t){return o.load(o.props,t,!e)},placeholder:r.a.createElement(v.a,{className:"CommentItem",small:!0})},o.renderCollapsedComments())},o.renderPatternContent=function(e){var t=o.props,n=t.isFetching,a=t.parent.adminClosedComment,i=t.byComment,s=t.status,l=t.order,c=t.totals,u=t.showPackupButton,m=t.handlePackupButton,d=Math.ceil(c/20),f=o.state,v=f.current,b=f.packupButtonStatus,g=f.packupButtonLeft;return a?null:n?r.a.createElement(Se.a,{onRef:function(e){o.commentsWithPaginationEl=e}}):r.a.createElement("div",{ref:function(e){o.commentsWithPaginationEl=e}},r.a.createElement("div",{className:"CommentListV2"},"normal"===l&&"open"===s?o.renderNormalComments(e):o.renderComments(e)),d>1&&r.a.createElement(y.a,{className:"CommentsV2-pagination",current:v,total:d,onSelect:o.handlePageSelect}),!i&&o.renderCollapsedDivider(),!i&&o.renderCollapsedInfiLoader(),r.a.createElement(p.CSSTransitionGroup,{transitionName:"CommentsV2-Packup-Button",transitionEnterTimeout:300,transitionLeaveTimeout:300},u&&b&&r.a.createElement("button",{onClick:m,className:"CommentsV2-Packup-Button",style:{left:g}},"收起评论",r.a.createElement(h.a,{center:!0}))))},o.renderModalContent=function(e){var t=o.props,n=t.collapsedInfo,a=t.parent.adminClosedComment,i=t.status,s=t.order,l=t.byComment,c=o.state.collapsed,u=c?o.props:n,p=u.isFetching,m=u.isDrained,d=u.isPrevDrained;if(m&&e.length<=0||a)return r.a.createElement("div",{className:"CommentsV2-empty"},r.a.createElement(g.a,{entityType:"comments"}));return r.a.createElement(v.b,Et({className:"CommentListV2",onRef:function(e){o.listEl=e},isLocal:!0,isLoading:p,isPrevDrained:d,isDrained:m,onLoad:function(e){return o.load(o.props,e,!c)},placeholder:r.a.createElement(v.a,{className:"CommentItemV2",small:!0})},{getContainer:function(e){return e}}),"normal"===s&&"open"===i?o.renderNormalComments(e):o.renderComments(e),!l&&o.renderCollapsedDivider(),!l&&o.renderCollapsedComments())},o.renderCommentEdit=function(){var e=o.props,t=e.parent,n=t.canComment,a=(n=void 0===n?{status:!0}:n).status,i=n.reason,s=t.author,l=(s=void 0===s?{isOrg:!1}:s).isOrg,u=t.type,p=t.id,m=t.adminClosedComment,d=t.questionType,f=e.byComment,h=e.autoFocus,v=e.commentNeedsReview,y=e.zaInfo,b=m?"当前内容暂时无法评论":i,g=h&&!f;return a&&!m?r.a.createElement(Pe,{className:"CommentsV2-footer",type:u,id:p,commentNeedsReview:v,onSubmit:o.addComment,autoFocus:g,ownerAuthorIsOrg:l,ownerAuthorIsBrand:"commercial"===d,zaInfo:y}):r.a.createElement("div",{className:c()("CommentsV2-disabledText")},r.a.createElement("div",{className:"CommentsV2-disabledReason"},b))},kt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Ot(t,[{key:"loadCommentPermission",value:function(e,t){var n=this.props,o=n.loadAnswerCommentPermission,r=n.loadArticleCommentPermission;switch(e){case"answer":return o(t);case"article":return r(t);default:return null}}},{key:"componentDidMount",value:function(){this.subscription=Object(m.subscribe)("scroll",this.handleScroll);var e=this.props,t=e.commentPattern,n=e.parent.adminClosedComment,o=e.stickers,r=e.loadStickers,a=e.getCommentWithPicPermission,i=e.commentWithPicPermission,s=e.currentUser,l=this.state.current;"bottom"!==t||n||(this.loadByPagination(l),this.commentsWithPaginationEl&&this.setState({packupButtonLeft:this.commentsWithPaginationEl.getBoundingClientRect().right-16})),!o.length&&r(),void 0===i.commentWithPic&&s&&a()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,o=t.status,r=t.targetComment,a=t.commentPattern;n===e.order&&o===e.status||("bottom"===a?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;!r&&i&&this.setState({collapsed:!i.collapsed})}},{key:"componentWillUnmount",value:function(){Object(U.e)(U.b),this.subscription&&this.subscription.unsubscribe()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.comments,a=t.commentPattern,i=t.commentInputPosition,s=t.isAuthor,l=t.parent,u=l.author,p=(u=void 0===u?{isOrg:!1}:u).isOrg,m=l.commentPermission,d=l.reviewingCounts,f=l.commentCount,h=l.adminClosedComment,v=t.totals,y=t.status,b=t.order,g=t.onStatusChange,w=t.onOrderChange,C=t.targetLink,E=t.shouldReverse,O=t.permission.canBrandAdminEdit,k="censor"===m&&(s||O),P=k?{isCommentReviewer:k,onStatusChange:g,status:y,reviewingCounts:d}:{status:y};return r.a.createElement("div",{className:c()("CommentsV2 CommentsV2--withEditor",{"CommentsV2-withPagination":"bottom"===a},n),ref:function(t){e.commentsElement=t}},r.a.createElement(_e.a,Et({commentCount:void 0!==f?f:v,shouldReverse:E,commentClosed:h,targetLink:C,order:b,onOrderChange:w,commentPattern:a,isOrg:p},P)),"top"===i&&this.renderCommentEdit(),"bottom"===a?this.renderPatternContent(o):this.renderModalContent(o),"bottom"===i&&this.renderCommentEdit())}}]),t}(),wt.propTypes={type:i.a.string,parent:i.a.object.isRequired,targetLink:i.a.node,commentNeedsReview:i.a.bool,byComment:i.a.oneOfType([i.a.number,i.a.string]),commentPattern:i.a.string,commentInputPosition:i.a.oneOf(["top","bottom"]),showPackupButton:i.a.bool,handlePackupButton:i.a.func,onPaginationClick:i.a.func,autoFocus:i.a.bool,shouldReverse:i.a.bool},wt.contextTypes={authRequired:i.a.func.isRequired},wt.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0,shouldReverse:!0},gt=Ct))||gt;var St,_t,jt,Nt=n(141),Tt=n.n(Nt),Rt=n(117),It=n.n(Rt),xt=n(132),Lt=n(1787),At=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Mt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Bt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Dt=Object(s.connect)(function(e,t){var n=t.conversationId,o=t.isAnchorComments,r=e.entities.comments,a=e.commentsV2,i=a.conversation,s=a.conversationMore,l=i[n]||{isFetching:!1,isDrained:!1,isPrevDrained:!1,ids:[]},c=l.isFetching,u=l.isDrained,p=l.isPrevDrained,m=l.ids,d=l.totals,f=l.topComments,h=(f=void 0===f?{}:f).paging,v=(h||{}).isEnd,y=s[n]||{isFetching:!1,isDrained:!1,ids:[]},b=y.isFetching,g=y.isDrained,w=y.ids,C=w.map(function(e){return r[e]}),E=m.map(function(e){return r[e]}),O=r[n+"_featured"]||r[n]||{},k=o?It()(w.length?[].concat(Mt(E.slice(0,4)),Mt(C),Mt(E.slice(4))):E,"id"):[O].concat(Mt(E)),P=h?[].concat(Mt(E.slice(0,3)),Mt(C)).length:-1;return{isFetching:c,isDrained:u,isPrevDrained:p,totals:d,comments:k,openComment:O,topCommentsPaging:h,isConversationMoreFetching:b,isConversationMoreDrained:v||g,offsetIndex:P}},{loadConversation:u.g,addComment:u.a,loadMoreAnchorComments:u.h})((jt=_t=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Bt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.load=function(){var e=o.props,t=e.isAnchorComments,n=e.conversationId;(0,e.loadConversation)({id:n,isAnchorComments:t})},o.addComment=function(e,t,n){var r=n.rootCommentId,a=n.isConversation,i=o.props,s=i.parent,l=s.type,c=s.id,u=i.conversationId,p=i.addComment,m=i.isAnchorComments;return p({parentType:l,parentId:c,content:e,replyTo:t,conversationId:u,rootCommentId:r,isConversation:a,replyType:bt({id:r,replyTo:t,isConversation:a}).type,isAnchorComments:m})},o.loadMoreAnchorComments=function(){var e=o.props,t=e.conversationId,n=e.topCommentsPaging,r=void 0===n?{}:n;(0,e.loadMoreAnchorComments)({conversationId:t,nextUrl:r.next})},o.createOnRef=Tt()(function(e){return function(t){var n=o.props.byComment;parseInt(e)===Number(n)&&(o.targetCommentEl=t)}}),o.scrollToTarget=function(){var e=o,t=e.targetCommentEl,n=e.listEl;if(n&&t){var r=t.getBoundingClientRect(),a=r.top,i=r.height,s=n.getBoundingClientRect(),l=s.top,c=s.height;o.listEl.scrollTop+=a-l-(c-i)/2,t.classList.add("CommentItemV2--highlighted"),setTimeout(function(){return t.classList.remove("CommentItemV2--highlighted")},2e3),t.tabIndex=-1,t.focus()}},Bt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),At(t,[{key:"componentDidMount",value:function(){this.props.byComment&&this.scrollToTarget()}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onItemLike,a=t.onItemDelete,i=t.onItemFeature,s=t.onItemApprove,l=t.onItemCollapse,c=t.onItemDislike,u=t.onNavBack,p=t.canOperateItem,m=t.isFetching,d=t.comments,f=void 0===d?[]:d,h=t.commentNeedsReview,y=t.openComment.collapsed,b=t.parent,g=t.commentPattern,w=t.totals,C=t.isDrained,E=t.isPrevDrained,O=t.isConversationMoreFetching,k=t.isConversationMoreDrained,P=t.offsetIndex,S=null;return m&&!f.length?S=r.a.createElement(o.Fragment,null,r.a.createElement(v.a,{className:"CommentItemV2",small:!0}),r.a.createElement("div",{className:"CommentsV2-openComment-divider"}),r.a.createElement("div",{className:"CommentsV2-replyNum"},w+" 条回复")):f.length&&(S=f.map(function(t,u){return u?k||u!==P||O?O&&u===P?r.a.createElement(o.Fragment,{key:t.id},r.a.createElement(at,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:p,parent:b,comment:t,onLike:n,onDelete:a,onFeature:i,onApprove:s,onCollapse:l,onDislike:c,collapsedShown:y,onReply:e.addComment}),r.a.createElement(v.a,{key:"NestCoomment-moreCommentButton-PlaceHolder",className:"NestCoomment-moreCommentButton ",small:!0})):r.a.createElement(at,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:p,parent:b,comment:t,onLike:n,onDelete:a,onFeature:i,onApprove:s,onCollapse:l,onDislike:c,collapsedShown:y,onReply:e.addComment}):r.a.createElement(o.Fragment,{key:t.id},r.a.createElement(at,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:p,parent:b,comment:t,onLike:n,onDelete:a,onFeature:i,onApprove:s,onCollapse:l,onDislike:c,collapsedShown:y,onReply:e.addComment}),r.a.createElement("div",{key:"NestCoomment-moreCommentButton",preset:"plain",className:"NestCoomment-moreCommentButton",onClick:e.loadMoreAnchorComments},r.a.createElement(Lt.a,null),r.a.createElement("p",null,"点击查看更多回复"))):r.a.createElement(o.Fragment,{key:t.id},r.a.createElement("div",{className:"CommentsV2-openComment"},r.a.createElement(at,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:p,parent:b,comment:t,onLike:n,onDelete:a,onFeature:i,onApprove:s,onCollapse:l,onDislike:c,collapsedShown:y,onReply:e.addComment})),r.a.createElement("div",{className:"CommentsV2-openComment-divider"}),r.a.createElement("div",{key:t.id+"-title"},r.a.createElement("div",{className:"CommentsV2-replyNum"},w+" 条回复")))})),"bottom"===g?r.a.createElement(xt.b,{size:"fullPage",onClose:u},r.a.createElement("div",{className:"CommentsV2"},r.a.createElement(_e.a,{isConversation:!0,commentPattern:g}),r.a.createElement(v.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:m,isDrained:C,isPrevDrained:E,onLoad:this.load,placeholder:r.a.createElement(v.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},S))):r.a.createElement("div",{className:"CommentsV2"},r.a.createElement(_e.a,{isConversation:!0,onNavBack:u}),r.a.createElement(v.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:m,isDrained:C,isPrevDrained:E,onLoad:this.load,placeholder:r.a.createElement(v.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},S))}}]),t}(),_t.propTypes={conversationId:i.a.number.isRequired,type:i.a.string,parent:i.a.object.isRequired,commentNeedsReview:i.a.bool},_t.contextTypes={currentUser:i.a.object,authRequired:i.a.func.isRequired},St=jt))||St;var Ft=n(205);n.d(t,"default",function(){return Gt});var zt,Vt,Ut,qt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Wt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Ht(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Gt=Object(s.connect)(null,{updateCommentLikeStatus:u.o,updateCommentFeatureStatus:u.n,deleteComment:u.d,updateCommentCollapsed:u.l,updateCommentDisliked:u.m,approveComment:u.b,rejectComment:u.k})(zt=Object(Ft.a)(null)((Ut=Vt=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Ht(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={openedCommentId:null,isAnchorComments:!1,status:"open",order:"normal"},o.showConversation=function(e){var t=e.commentId,n=e.isAnchorComments;o.setState({openedCommentId:t,isAnchorComments:n})},o.showComments=function(){o.setState({openedCommentId:null,isAnchorComments:!1})},o.delete=function(e){var t=o.props,n=t.parent;return(0,t.deleteComment)(e,n.type,n.id)},o.feature=function(e){var t=o.props,n=t.parent,r=t.updateCommentFeatureStatus,a=t.notificationId;r({id:o.state.openedCommentId,commentId:e,parentId:n.id,parentType:n.type,notificationId:a})},o.like=function(e,t){var n=o.props,r=n.onItemLike,a=n.updateCommentLikeStatus;r&&r(e,t),a(e)},o.collapse=function(e){var t=o.props,n=t.parent;(0,t.updateCommentCollapsed)(e,n.type,n.id)},o.dislike=function(e){(0,o.props.updateCommentDisliked)(e)},o.approve=function(e){var t=o.props,n=t.parent,r=t.type;(0,t.approveComment)(e,n.type||r,n.id)},o.reject=function(e){var t=o.props,n=t.parent,r=t.type;(0,t.rejectComment)(e,n.type||r,n.id)},o.handleStatusChange=function(e){o.setState({status:e})},o.handleOrderChange=function(e,t){var n=o.props.onOrderChange;n&&n(e,t),o.setState({order:e})},Ht(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),Wt(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.commentsContainerNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.parent,o=t.commentPattern,a=t.type,i=t.parent,s=(i=void 0===i?{}:i).commentPermission,l=i.relationship,u=void 0===l?{}:l,p=i.author,m=void 0===p?{}:p,d=t.needLoadCommentPermission,f=t.byComment,h=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["parent","commentPattern","type","parent","needLoadCommentPermission","byComment"]),v=this.context.currentUser,y=void 0===u.isAuthor?v&&m.urlToken&&v.urlToken===m.urlToken:u.isAuthor,b="censor"===s&&!y,g="answer"===a||"article"===a,w=this.state,C=w.openedCommentId,E=w.status,O=w.order,k=w.isAnchorComments,P=k&&(C||f)||f;return r.a.createElement("div",{className:"Comments-container",ref:function(t){return e.commentsContainerNode=t}},r.a.createElement(Pt,qt({className:c()({"CommentsV2--hidden":C&&"bottom"!==o})},h,{type:a,order:O,status:E,parent:n,commentPattern:o,commentNeedsReview:b,canOperateItem:g,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,byComment:P,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:d,isAuthor:y})),C&&r.a.createElement(Dt,qt({},h,{parent:n,type:a,canOperateItem:g,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,commentPattern:o,conversationId:C,onNavBack:this.showComments,byComment:P,isAnchorComments:k,commentNeedsReview:b,onShowConversation:this.showConversation})))}}]),t}(),Vt.propTypes={type:i.a.string.isRequired,parent:i.a.object.isRequired,onOrderChange:i.a.func,onItemLike:i.a.func,isAuthor:i.a.bool,onMount:i.a.func},Vt.defaultProps={type:"answer"},Vt.contextTypes={currentUser:i.a.object,authRequired:i.a.func.isRequired},zt=Ut))||zt)||zt},2832:function(e,t,n){"use strict";n.r(t);var o,r,a=n(1),i=n.n(a),s=n(0),l=n.n(s),c=n(4),u=(n(533),n(32)),p=n(9),m=n(132),d=n(67),f=n(407),h=function(e,t,n){return n&&void 0!==t&&(e||!t)},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var y=20,b=60,g=(r=o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.shouldSubmitIsDisabled=function(){var t=e.state,n=t.title,o=t.description;return!n||n.length>y||o.length>b},e.state={isPublic:!0,title:"",description:""},e.handleSubmit=e.handleSubmit.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),v(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state,n=t.isPublic,o=t.title,r=t.description;if(o){var a=this.props,i=a.onSubmit,s=a.onBack,l=a.authRequired,c=a.isActive,u={title:o,description:r,isPublic:n};h(n,c,l)?l(i)(u):(i(u),s())}}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,o=t.description,r=t.isPublic,a=this.props.onBack,i=this.shouldSubmitIsDisabled();return l.a.createElement("form",{className:"Favlists-content",onSubmit:this.handleSubmit},l.a.createElement("div",{className:"Favlists-addItems"},l.a.createElement("div",{className:"Favlists-addItem"},l.a.createElement(d.a,{className:"Favlists-titleInput",placeholder:"收藏标题",onChange:function(t){var n=t.target.value;e.setState({title:n})}}),l.a.createElement("div",{className:"Favlists-inputTips"},l.a.createElement(f.a,{name:"收藏标题",current:n?n.length:0,max:y}))),l.a.createElement("div",{className:"Favlists-addItem"},l.a.createElement(d.a,{multiline:!0,className:"Favlists-descritionInput",placeholder:"收藏描述（可选）",onChange:function(t){var n=t.target.value;e.setState({description:n})},rows:5}),l.a.createElement("div",{className:"Favlists-inputTips"},l.a.createElement(f.a,{name:"收藏描述",current:o?o.length:0,max:b}))),l.a.createElement("div",{className:"Favlists-addItem"},l.a.createElement("label",{className:"Favlists-privacyOption"},l.a.createElement("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"true",checked:r,onChange:function(){return e.setState({isPublic:!0})}}),l.a.createElement("span",null,"公开"),l.a.createElement("span",{className:"Favlists-privacyOptionTips"},"有其他人关注此收藏夹时不可设置为私密")),l.a.createElement("label",{className:"Favlists-privacyOption"},l.a.createElement("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"false",checked:!r,onChange:function(){return e.setState({isPublic:!1})}}),l.a.createElement("span",null,"私密"),l.a.createElement("span",{className:"Favlists-privacyOptionTips"},"只有你自己可以查看这个收藏夹")))),l.a.createElement(u.a,{direction:"horizontal",className:""},a&&l.a.createElement(c.c,{onClick:a},"返回"),l.a.createElement(c.c,{color:"blue",preset:"primary",type:"submit",disabled:i},"确认创建")))}}]),t}(),o.propTypes={onSubmit:i.a.func.isRequired,onBack:i.a.func,authRequired:i.a.func},r),w=n(134),C=n(1593),E=n(2565),O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},k=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function P(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S,_,j=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=P(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleChange=function(){var e=o.props;(0,e.onChange)(e.id,o.props.checked)},P(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),k(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.zaEnabled,n=e.id;t&&p.default.setModule(this,{module:"CollectionItem"},{card:{card_type:"Content",content:{type:"Collection",token:String(n)}}})}},{key:"render",value:function(){var e=this.props,t=e.answerCount,n=e.title,o=e.isPublic,r=e.checked,a=void 0!==r&&r?{preset:"primary",color:"grey",children:"已收藏"}:{color:"blue",children:"收藏"};return l.a.createElement("div",{className:"Favlists-item"},l.a.createElement("div",{className:"Favlists-itemInner"},l.a.createElement("div",{className:"Favlists-itemName"},l.a.createElement("span",{className:"Favlists-itemNameText"},n),!1===o&&l.a.createElement("span",{className:"Favlists-itemIcon"},l.a.createElement(E.a,{size:16}))),l.a.createElement("div",{className:"Favlists-itemContent"},t," 条内容")),l.a.createElement(c.c,O({},a,{className:"Favlists-updateButton",onClick:this.handleChange})))}}]),t}(),N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function R(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var I,x,L,A=(_=S=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=R(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.items={},o.handleFavlistItemChange=function(e,t){p.default.trackEvent(o.items[e],{action:t?"UnCollect":"Collect",element:"Button",is_intent:!1}),o.props.onUpdate(e,t)},R(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),T(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.relations,o=t.items,r=t.isFetching,a=t.isDrained,i=t.onAdd,s=t.onLoad;return l.a.createElement("div",{className:"Favlists-content"},l.a.createElement(w.b,{isLocal:!0,isLoading:r,isDrained:a,onLoad:s,placeholder:l.a.createElement(C.a,{title:!0}),getContainer:function(e){return e},className:"Favlists-items"},o.map(function(t){return l.a.createElement(j,N({key:t.id,onChange:e.handleFavlistItemChange,checked:n[t.id]},t,{ref:function(n){e.items[t.id]=n}}))})),!o.length&&r||l.a.createElement("div",{className:"Favlists-actions"},l.a.createElement(c.c,{className:"Favlists-addButton",onClick:i,preset:"primary",color:"blue"},"创建收藏夹")))}}]),t}(),S.propTypes={isFecthing:i.a.bool,relations:i.a.object,onUpdate:i.a.func.isRequired,onAdd:i.a.func.isRequired,onLoad:i.a.func.isRequired,items:i.a.array.isRequired,isDrained:i.a.bool,authRequired:i.a.func},_),M=n(2151),B=n(2152),D=(n(2655),n(2656),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),F=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var V={list:{title:"添加收藏",tips:function(e){return e?"请选择你想添加的收藏夹":"你可以创建多个收藏夹，将答案分类收藏"}},add:{title:"创建新收藏夹"}},U=(x=I=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=z(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),L.call(o),z(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),F(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.shown,o=t.items,r=t.id,a=t.type,i=t.onFetchRelations,s=e.items,l=e.relations;if(i&&(s.length!==o.length&&e.shown||s.length&&!n&&e.shown)){var c=(l?s.filter(function(e){return!{}.hasOwnProperty.call(l,e.id)}):s).map(function(e){return e.id});c.length&&i(r,a,c)}s.length>o.length&&this.setState({status:"list"})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.id,o=t.type,r=t.shown,a=t.zaEnabled;r&&!e.shown&&this.container&&a&&p.default.setModule(this.container,{module:"CollectionDialogue"},{card:{card_type:"Content",content:{type:Object(B.a)(o),token:String(n)}}})}},{key:"render",value:function(){var e=this,t=this.state.status,n=V[t],o=n.title,r=n.tips,a=this.props,i=a.shown,s=a.defaultStatus,p=a.relations,d=a.onFavlistAdd,f=a.onLoad,h=a.isFetching,v=a.isDrained,y=a.items,b=a.zaEnabled,w=a.authRequired,C=a.isUserActive,E=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(a,["shown","defaultStatus","relations","onFavlistAdd","onLoad","isFetching","isDrained","items","zaEnabled","authRequired","isUserActive"]),O=!(v&&!y.length),k=Object(M.a)(E,Object.keys(m.b.propTypes)).selectedProps,P=void 0;return P="list"===t?O?l.a.createElement(A,{ref:function(t){e.container=t},items:y,isFetching:h,isDrained:v,relations:p,onAdd:this.handleAdd,onUpdate:this.handleUpdate,onLoad:f,zaEnabled:b}):l.a.createElement(u.a,null,l.a.createElement(c.c,{preset:"primary",color:"blue",onClick:this.handleAdd},"创建收藏夹"),l.a.createElement(c.c,{onClick:this.handleCloseModal},"取消")):l.a.createElement(g,{onSubmit:d,isActive:C,onBack:"add"===s?this.handleCloseModal:this.handleBack,authRequired:w}),l.a.createElement(m.b,D({},k,{onClose:this.handleCloseModal,title:o,subtitle:r&&r(O),buttonGroupOnly:!O,className:"FavlistsModal",size:"large"}),i&&P)}}]),t}(),I.propTypes={id:i.a.oneOfType([i.a.string,i.a.number]),type:i.a.oneOf(["answer","article","pin"]),relations:i.a.object,onUpdateFav:i.a.func.isRequired,onFavlistAdd:i.a.func.isRequired,onFetchRelations:i.a.func,onClose:i.a.func.isRequired,shown:i.a.bool,zaEnabled:i.a.bool,authRequired:i.a.func,isUserActive:i.a.number},I.defaultProps={defaultStatus:"list",relations:{},authRequired:function(e){return e}},L=function(){var e=this;this.state={status:this.props.defaultStatus},this.handleCloseModal=function(){e.props.onClose&&e.props.onClose(),e.setState({status:"list"})},this.handleUpdate=function(t,n){var o=e.props,r=o.onUpdateFav,a=o.id,i=o.type,s=o.items,l=o.authRequired,c=o.isUserActive,u=s.find(function(e){return e.id===t})||{},p=[t,a,i,u.isPublic];return!n&&h(u.isPublic,c,l)?l(r).apply(void 0,p):r.apply(void 0,p)},this.handleAdd=function(){return e.setState({status:"add"})},this.handleBack=function(){return e.setState({status:"list"})}},x);n.d(t,"FavlistsModal",function(){return U})},2834:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(1),i=n.n(a),s=n(2),l=n.n(s),c=n(4),u=n(32),p=n(650),m=n(85),d=n(24),f=(n(2811),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var h=8,v=9,y=13,b=48,g=57;function w(e,t){return e?t?!0===t?"":t:e:""}var C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onInputFocus=n.onInputFocus.bind(n),n.onInputChange=n.onInputChange.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),f(t,[{key:"onInputFocus",value:function(){this.props.onFocus()}},{key:"onInputChange",value:function(e){var t=String(e.target.value);if(t){t=t[t.length-1];var n=this.props.chars,o=this.props.length;n.length===o?n=n.replace(/.$/,t):n+=t,this.props.onChange(n),n.length===o&&this.props.onFinish(n)}}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(!e.metaKey&&!e.ctrlKey&&t!==v&&t!==y){var n=this.props.chars;t===h?(n=n.slice(0,-1),this.props.onChange(n)):(t<b||t>g)&&(e.preventDefault(),this.props.onError(e))}}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e=this,t=this.props,n=t.length,o=t.chars,a=t.maskChar,i=t.autoFocus,s=t.className,c=t.children,u=o.length===n?n-1:o.length,p=o[u]||"";return r.a.createElement("label",{className:l()("TPass",s)},r.a.createElement("span",{className:"TPass-wrapper"},r.a.createElement(E,{length:n,chars:o,maskChar:a}),r.a.createElement("input",{className:"TPass-input",value:p,style:{left:60*u},onFocus:this.onInputFocus,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onPaste:function(e){return e.preventDefault()},type:"number",min:"0",max:"9",pattern:"[0-9]*",autoFocus:i,ref:function(t){e.input=t}})),c)}}]),t}();function E(e){for(var t,n=e.length,o=e.chars,a=e.maskChar,i=[],s=0;s<n;s+=1)t=o[s],i.push(r.a.createElement("span",{className:l()("TPassBox",{"TPassBox-mask":t&&Boolean(a)}),key:s},w(t,a)));return r.a.createElement("span",{className:"TPassBoxes"},i)}C.defaultProps={length:6,chars:"",maskChar:!1,autoFocus:!1,onFocus:function(){},onChange:function(){},onError:function(){},onFinish:function(){}},C.propTypes={length:i.a.number,chars:i.a.string,maskChar:i.a.oneOfType([i.a.bool,i.a.string]),autoFocus:i.a.bool,onFocus:i.a.func,onChange:i.a.func,onError:i.a.func,onFinish:i.a.func,className:i.a.string,children:i.a.node};var O,k,P=C,S=(n(2812),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var _=(k=O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),S(t,[{key:"render",value:function(){var e=this.props;return r.a.createElement("div",{className:l()("Spinner",e)},r.a.createElement("i",{className:"Spinner-loading"}))}}]),t}(),O.propTypes={className:i.a.string},k),j=n(86),N=(n(2813),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var I=11;function x(){this.payments={},this.chosePaymentName=null,this.codeUrl="",this.qrLoaded=!1,this.need=null,this.passcode="",this.needSMS=!1,this.smsTimer=0,this.isInProgress=!1,this.error=null}var L=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPasscodeFocus=function(){n.state.error&&(n.setState({error:null}),6===n.state.passcode.length&&n.setState({passcode:""}))},n.onPasscodeInput=function(e){"object"===(void 0===e?"undefined":T(e))&&(e=e.target.value),n.setState({passcode:e})},n.onPasscodeFinish=function(e){n.tpass.blur(),n.payWithBalance(e)},n.onSendSMSCode=function(){n.props.trade.resendSMSCode(function(){n.startSMSTimer(),n.smsInput.focus()},function(e){n.setState({error:e})})},n.onQrLoad=function(){n.setState({qrLoaded:!0})},n.onBalanceFormSubmit=function(e){e.preventDefault(),n.payWithBalance(n.state.passcode)},n.setPayments=function(e){n.setState({payments:e})},n.confirmPayment=function(){var e=n.state,t=e.choseName,o=e.payments,r=n.props.onConfirmPayment,a=t;if(t||(a=o.balance&&o.balance.enable?"balance":"wechat"),r(!a),n.setState({chosePaymentName:a}),"wechat"===a&&n.isInWechat){var i=n.props.tradeNumber,s=location.protocol+"//"+location.host+location.pathname,l="https://www.zhihu.com/pay/weixin/pay?service_id="+I+"&trade_number="+i+"&redirect_uri="+encodeURIComponent(s);window.location.replace(l)}else n.props.trade["wechat"===a?"initWechatPay":"initBalancePay"]()},n.pid=0,n.smsTimer=null,n.state=new x,n.isInWechat=e.ua.Wechat,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),R(t,[{key:"componentWillMount",value:function(){var e=this.props.trade;this.getPaymentsList(e),this.initListeners(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.trade!==this.props.trade&&(this.setState(new x),setTimeout(function(){t.getPaymentsList(e.trade)},300),this.initListeners(e.trade))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.smsTimer),this.props.trade.dispose()}},{key:"getPaymentsList",value:function(e){var t=this;if(e){var n=this.pid+=1;e.getPaymentsList(function(e){t.pid===n&&t.setPayments(e)})}}},{key:"initListeners",value:function(e){var t=this;e&&e.on("payInited",function(e,n){t.setState(N({},n))}).on("paySuccess",function(){t.setState({isInProgress:!1,error:null}),t.props.onSuccess()}).on("payCancel",function(){t.setState({isInProgress:!1,chosePaymentName:null})}).on("payFail",function(e){var n=e;"object"!==(void 0===e?"undefined":T(e))||e instanceof Error||(n=e.message),t.setState({isInProgress:!1,error:n}),t.props.onFail(e)}).on("needSMS",function(e){t.setState({isInProgress:!1,error:null,needSMS:e.message,passcode:""})}).on("needWechatCode",function(){t.props.onError("needWechatCode")}).on("error",function(e,n){t.props.onError(e,n)})}},{key:"startSMSTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;window.clearInterval(this.smsTimer),this.setState({smsTimer:t}),this.smsTimer=window.setInterval(function(){(t-=1)<=0?(window.clearInterval(e.smsTimer),e.smsTimer=null,e.setState({smsTimer:0})):e.setState({smsTimer:t})},1e3)}},{key:"payWithBalance",value:function(e){return 6!==e.length?(this.setState({error:"请输入 6 位支付密码"}),!1):(this.setState({isInProgress:!0,error:null}),this.props.trade.payWithBalance(e))}},{key:"renderPaymentsList",value:function(){var e=this,t=this.state,n=t.payments,o=t.chosePaymentName,a=t.choseName,i=this.props.trade;if(o)return null;var s=n.balance&&n.balance.amount,l=i.info.total,u=n.wechat&&n.wechat.enable,p=n.balance&&n.balance.enable,f=n.balance&&!n.balance.enable,h=s>=l?"使用余额（剩余 "+(s/100).toFixed(2)+"）":"微信支付",v=s>=l?"wallet":"wechatPayment",y="PaymentItem-"+(s>=l?"wallet":"wechatPayment");a&&(h="wechat"===a?"微信支付":"使用余额（剩余 "+(s/100).toFixed(2)+"）",v="wechat"===a?"wechatPayment":"wallet",y="PaymentItem-"+("wechat"===a?"wechatPayment":"wallet"));var b=r.a.createElement("div",null,r.a.createElement(d.a,{name:v,className:y}),r.a.createElement(c.c,{className:"Payment-Popover"},h),r.a.createElement(d.a,{className:"Select-arrow",name:"select"}));return r.a.createElement("div",{className:"PaymentsList"},r.a.createElement("span",{className:"Payment-Topline"}),r.a.createElement("span",{className:"PaymentWay"},"支付方式"),r.a.createElement(j.a,{placeholder:b},r.a.createElement(m.b,{plain:!0,className:"Payment-select",listClassName:"Payment-select-list",targetClassName:"Popover-targetContainer-verification",text:s>=l?"使用余额（剩余 "+(s/100).toFixed(2)+"）":"微信支付",menuToggler:b,onChange:function(t){"disabled"!==t&&e.setState({choseName:t})}},p&&r.a.createElement(m.a,{value:"balance",className:"PaymentItem"},r.a.createElement(d.a,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 "+(s/100).toFixed(2)+"）"),f&&r.a.createElement(m.a,{value:"disabled",className:"PaymentItem PaymentItem--disabled"},r.a.createElement(d.a,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 "+(s/100).toFixed(2)+"）"),u&&r.a.createElement(m.a,{value:"wechat",className:"PaymentItem"},r.a.createElement(d.a,{name:"wechatPayment",className:"PaymentItem-wechatPayment"}),"微信支付"))),r.a.createElement("span",{className:"Payment-Bottomline"}),r.a.createElement(c.c,{className:"Payment-CheckedButton",onClick:this.confirmPayment},"确认支付"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.trade,a=this.state,i=a.payments,s=a.chosePaymentName,u=a.codeUrl,p=a.needSMS,m=a.isInProgress;return o?r.a.createElement("div",{className:l()("Payment",n)},Object.keys(i).length?this.renderPaymentsList():r.a.createElement("div",{className:"Payment-placeholder"},r.a.createElement(_,null)),"wechat"===s&&r.a.createElement("div",{className:"Payment-wechatPay"},r.a.createElement("div",{className:"Payment-wechatPayTitle"},r.a.createElement("i",{className:"icon icon-ic_wechatpay PaymentIconWechat"}),"微信支付"),!this.isInWechat&&r.a.createElement("div",null,"使用微信扫描二维码完成支付"),this.state.qrLoaded?r.a.createElement("span",{className:"Payment-qrWrapper"},r.a.createElement("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url="+u,width:"150",height:"150"})):r.a.createElement("div",{className:"Payment-qrPlaceholder"},r.a.createElement(_,null),!this.isInWechat&&r.a.createElement("div",null,"正在生成二维码"),u&&r.a.createElement("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url="+u,width:"1",height:"1",onLoad:this.onQrLoad}))),"balance"===s&&r.a.createElement("form",{onSubmit:this.onBalanceFormSubmit,className:"Payment-balancePay"},r.a.createElement("div",{className:"Payment-balancePayTitle"},r.a.createElement("i",{className:"icon icon-wallet PaymentIconWallet"}),"余额支付"),!p&&r.a.createElement("div",null,r.a.createElement("div",{className:"Payment-description"},"请输入 6 位数知乎支付密码，用于支付验证。"),r.a.createElement(P,{chars:this.state.passcode,onFocus:this.onPasscodeFocus,onChange:this.onPasscodeInput,maskChar:!0,onFinish:this.onPasscodeFinish,className:l()("Payment-tpass",{"Payment-errorInput":this.state.error,"Payment-progressing":m}),autoFocus:!0,ref:function(t){e.tpass=t}},m&&r.a.createElement(_,{className:"Payment-balancePaySpinner"}))),Boolean(p)&&r.a.createElement("div",{className:"Payment-balancePaySms"},r.a.createElement("div",{className:"Payment-balancePaySmsText"},String(p)),r.a.createElement("input",{onChange:this.onPasscodeInput,value:this.state.passcode,className:l()("Payment-sms","SimpleInput",{"Payment-errorInput":this.state.error}),type:"text",pattern:"\\d{6}",minLength:"6",maxLength:"6",title:"验证码应为 6 位数字",placeholder:"输入 6 位数验证码",required:!0,autoFocus:!0,ref:function(t){e.smsInput=t}}),this.state.smsTimer?r.a.createElement("button",{className:"Payment-sendSms",type:"button",disabled:!0},this.state.smsTimer," 秒后可重发"):r.a.createElement("button",{onClick:this.onSendSMSCode,className:"Payment-sendSms",type:"button"},"发送验证码")),r.a.createElement("div",{className:"Payment-balancePayFooter"},r.a.createElement("p",{className:"Payment-errorTip",style:{visibility:this.state.error?"visible":"hidden"}},this.state.error),Boolean(p)&&r.a.createElement(c.c,{color:"blue",disabled:m,className:"Payment-balancePayConfirmBtn",type:"submit"},"确认")),!p&&r.a.createElement("div",{className:"Payment-balancePayForget"},"如果忘记密码请邮件联系"," ",r.a.createElement("email",{className:"Payment-email"},"i@zhihu.com")))):r.a.createElement("div",{className:l()("Payment",n)},r.a.createElement("div",{className:"Payment-placeholder Payment-placehoder--empty"},r.a.createElement(_,null)))}}]),t}();L.propTypes={trade:i.a.object,autoChooseSinglePayment:i.a.bool,onSuccess:i.a.func.isRequired,onFail:i.a.func,onError:i.a.func,onConfirmPayment:i.a.func},L.defaultProps={trade:null,onSuccess:function(){},onFail:function(){},onError:function(){},autoChooseSinglePayment:!0,className:""};var A=L,M=n(702),B="",D=null;var F=n(10);n(2814);n.d(t,"TipjarDialog",function(){return H});var z,V,U=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var q=[200,500,1e3,5e3,1e4,2e4],W=100,H=(V=z=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.lockScroll=function(){document.body.classList.add("scroll-locked"),n.scrollTop=window.scrollY,document.body.style.width="100%",document.body.style.position="fixed",document.body.style.top=-n.scrollTop+"px"},n.unlockScroll=function(){document.body.classList.remove("scroll-locked"),document.body.style.width=null,document.body.style.position=null,void 0!==n.scrollTop&&(window.scrollTo(0,n.scrollTop),n.scrollTop=void 0),document.body.style.top=null},n.onConfirmPayment=function(e){n.setState({chosePaymentName:e})},n.onPaySuccess=function(){n.props.onPaySuccess(),n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:"",customButton:!1})},n.handleCustomAmount=function(){n.state.trade&&n.state.trade.dispose(),n.setState({showCustom:!0})},n.handleCustomChange=function(e){var t=e.target.value;isNaN(t)?n.setState({customAmount:""}):n.setState({customAmount:parseInt(t)||""})},n.handleCustomKeyUp=function(e){13===e.keyCode&&n.handleSubmitCustom()},n.handleSubmitCustom=function(){var e=n.state.customAmount*W;e>0&&e<=5e4&&(n.setState({customButton:!0,showCustom:!1,colseTijarDialogStatus:!1}),n.createTrade(e))},n.closeModal=function(){n.state.trade&&n.state.trade.dispose(),n.setState(n.getDefaultState())},n.handleAmountButton=function(e){n.createTrade(e.currentTarget.dataset.amount),n.setState({colseTijarDialogStatus:!1,customButton:!1,showCustom:!1})},n.createTrade=function(e){n.setState({tradeLoading:!0,currentAmount:e});var t=n.props.ua;n.props.addReward(e,t.Wechat?"wechat":"normal"),n.setState({tradeLoading:!1})},n.colseTijarDialog=function(){n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:""}),n.props.colseTijarDialog()},n.state=n.getDefaultState(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),U(t,[{key:"componentDidMount",value:function(){this.showTip()}},{key:"componentDidUpdate",value:function(e){var t=e.TipjarRender,n=this.props,o=n.tradeNumber,r=n.type,a=n.isMobile,i=n.TipjarRender,s=this.state,l=s.trade,c=s.colseTijarDialogStatus,u="article"===r?11:17;if(o&&(!l||o!==l.tradeNo)&&!c){var p=new window.zhihu.pay.Trade(o,u);this.setState({trade:p})}a&&(!t&&i?this.lockScroll():t&&!i&&this.unlockScroll())}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.TipjarRender,n=e.isMobile;t&&this.props.removeTradeNumber(),t&&n&&this.unlockScroll()}},{key:"getDefaultState",value:function(){return{showCustom:!1,customAmount:"",currentAmount:"",showTipModal:!1,customButton:!1,chosePaymentName:!0,colseTijarDialogStatus:!1}}},{key:"showTip",value:function(){var e,t,n=this;e="https://pay.zhihu.com/api/js",t=function(){n.setState({showTipModal:!0})},B&&e&&e!==B&&t(new Error("A pay-sdk from different source has been load")),B=e,window.zhihu&&window.zhihu.pay?window.zhihu.pay.ready(t):(D||(D=Object(M.loadScript)(e)),D.then(function(){return window.zhihu.pay.ready(t)},function(e){t(e),D=null}))}},{key:"renderAmountCustom",value:function(){var e=this.state,t=e.showCustom,n=e.customAmount,o=e.currentAmount,a=e.customButton;return r.a.createElement("div",{className:"Reward-TipjarDialog-amountCustom"},t?r.a.createElement("div",{className:"Reward-TipjarDialog-amountInput"},r.a.createElement("input",{name:"",type:"text",className:"SimpleInput",placeholder:"你想赞赏的金额（不超过 500）",value:n,onChange:this.handleCustomChange,onKeyUp:this.handleCustomKeyUp,ref:function(e){e&&e.focus()}}),r.a.createElement(c.c,{disabled:n<=0||n>500,color:"blue",preset:"primary",onClick:this.handleSubmitCustom},"确定"),r.a.createElement("div",{className:"Reward-TipjarDialog-error",style:{display:n>500?"block":"none"}},"不能超过 500 元")):r.a.createElement(c.c,{preset:"plain",className:a?"TipjarDialog-customButton-cheked":"TipjarDialog-customButton",onClick:this.handleCustomAmount},a?"自定义金额： ￥ "+o/W:"自定义金额"))}},{key:"renderTipjarDialog",value:function(){var e=this,t=this.props,n=t.author,o=n.name,a=n.avatarUrl,i=n.isOrg,s=n.urlToken,u=n.id,p=t.tagline,m=this.state.currentAmount;return r.a.createElement("div",{className:"Reward-TipjarDialog"},r.a.createElement("div",{className:"Reward-TipjarDialog-user"},r.a.createElement("a",{href:"/"+(i?"org":"people")+"/"+(s||u),className:"Reward-UserAvatar"},r.a.createElement("img",{src:a.replace("_is","_l"),className:"Reward-Avatar",alt:"当前用户"})),o),r.a.createElement("div",{className:"Reward-TipjarDialog-tagLine"},p),r.a.createElement("div",{className:"Reward-TipjarDialog-selectAmount"},r.a.createElement("div",{className:"Reward-TipjarDialog-amountList"},q.map(function(t){return r.a.createElement(c.c,{key:t,"data-amount":t,onClick:e.handleAmountButton,color:"red",className:l()({"Reward-Button-checked":Number(m)===t})},r.a.createElement("b",null,Number(m)===t?t/W+" 元":"￥ "+t/W))})),this.renderAmountCustom()))}},{key:"render",value:function(){var e=this.props,t=e.ua,n=e.TipjarRender,o=e.isMobile,a=e.tradeNumber,i=this.state,s=i.showCustom,l=i.tradeLoading,c=i.showTipModal,m=i.trade,d=i.chosePaymentName,f=o?p.a:u.b,h=o?"small":"default";return r.a.createElement(f,{overlay:!0,size:h,onClose:this.colseTijarDialog,className:"Reward-TipjarDialogModal"},n&&r.a.createElement("div",null,c&&d&&this.renderTipjarDialog(),(m||l)&&!s&&r.a.createElement(A,{trade:m,tradeNumber:a,ua:t,onSuccess:this.onPaySuccess,onConfirmPayment:this.onConfirmPayment})))}}]),t}(),z.propTypes={author:i.a.object,tagline:i.a.string,colseTijarDialog:i.a.func,addReward:i.a.func,tradeNumber:i.a.number,removeTradeNumber:i.a.func,onPaySuccess:i.a.func,isMobile:i.a.bool,type:i.a.string},z.defaultProps={tagline:F.i},V)},2835:function(e,t,n){"use strict";n.r(t);var o,r,a,i,s,l,c=n(1),u=n.n(c),p=n(0),m=n.n(p),d=n(13),f=n(2),h=n.n(f),v=n(431),y=n(1785),b=n(9),g=n(61),w=n(141),C=n.n(w),E=n(1977),O=n(1992),k=n(396),P=n(134),S=n(1796),_=n(4),j=n(202),N=n(400),T=n(14),R=n(36),I=n(39),x=n(392),L=n(212),A=n(15),M=n(688),B=n.n(M),D=n(21),F=n.n(D),z=n(132),V=n(168),U=n(409),q=(n(2639),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),W=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),H=(s=["回复","",""],l=["回复","",""],Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(l)}})));var G="zhihu::comment_local_key",K=5,Q=function(){return""},Y=(o=Object(d.connect)(function(e){return{edition:Object(R.d)(e),referer:Object(R.g)(e),shouldOia:Object(R.h)(e)}}),Object(A.withRouter)(r=o((i=a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.initLocalComment=function(){var e=o.props,t=e.type,n=e.id;if(t&&n){var r=F.a.get(G)||[],a=t+"_"+n,i=r.find(function(e){return e.key===a}),s=i&&i.value;s&&o.setState({value:{toHTML:function(){return s}},disabled:!1})}},o.saveLocalComment=function(e){var t=o.props,n=t.type,r=t.id;if(n&&r){var a=e?e.toHTML():o.state.value.toHTML(),i=n+"_"+r,s=(F.a.get(G)||[]).filter(function(e){return e.key!==i}),l=a?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s.slice(0,K-1)),[{key:i,value:a}]):s;F.a.set(G,l)}},o.handleChange=function(e){o.setState({value:e,disabled:e.isEmpty})},o.handleCommentShow=o.context.authRequired(function(){o.setState({shown:!0}),o.hiddenInput.focus()}),o.handleCommentHide=function(){o.setState({shown:!1})},o.handleMobileComment=function(){o.onSubmit(),o.handleCommentHide()},o.focusInput=function(e){e.preventDefault(),o.input.focus()},o.onChange=o.handleChange.bind(o),o.onFocus=o.handleFocus.bind(o),o.onBlur=o.handleBlur.bind(o),o.onSubmit=o.context.authRequired(o.handleSubmit.bind(o),void 0,T.b),o.state={active:e.defaultActive,disabled:!0,shown:!1,value:{toHTML:Q}},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p["Component"]),W(t,[{key:"componentDidMount",value:function(){this.initLocalComment()}},{key:"componentWillUnmount",value:function(){this.saveLocalComment()}},{key:"handleFocus",value:function(){this.setState({active:!0})}},{key:"handleBlur",value:function(){var e=this;setTimeout(function(){return e.setState({active:!1})},100)}},{key:"handleSubmit",value:function(){var e=this,t=this.props,n=t.replyTo,o=t.onSubmit,r=t.onCancel,a=this.input.toHTML();if(a&&o){this.saveLocalComment();var i=o(a,n);i.then?i.then(function(){r&&r(),e.input?(e.input.reset(),e.setState({value:{toHTML:Q}},function(){return e.saveLocalComment()})):e.saveLocalComment({toHTML:Q})}):(r&&r(),this.input.reset()),b.default.trackEvent(this,{action:"Comment",element:"Button"})}}},{key:"renderInput",value:function(e){var t=this,n=e.placeholder,o=e.className,r=this.props.autoFocus;return m.a.createElement(m.a.Fragment,null,m.a.createElement(V.c,{keyMap:{FOCUS_COMMENT_INPUT:"shift+c"},handlers:{FOCUS_COMMENT_INPUT:this.focusInput}}),m.a.createElement(U.a,{className:h()("CommentEditor-input",o),defaultValue:this.state.value.toHTML(),richtext:!0,large:!0,spread:!0,allowMention:!0,allowPasteRichText:!1,autoFocus:Boolean(!1)||r,outputBlockType:"div",onRef:function(e){t.input=e},placeholder:n,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onSubmit:this.onSubmit,minRows:5}))}},{key:"render",value:function(){var e=this.props,t=e.replyTo,n=e.commentNeedsReview,o=e.className,r=(e.onClick,e.onCancel),a=e.ownerAuthorIsOrg,i=e.ownerAuthorIsBrand,s=(e.type,e.id,e.edition,e.shouldOia,e.location.query,e.referer,e.preset,this.state),l=s.active,c=s.disabled,u=a?"机构":"作者";if(t){var p=B()(H,t.author.member.name,n?"，评论由"+u+"筛选后公开":"");return m.a.createElement("div",{className:h()(o,"CommentEditor--inCommentItem",{"CommentEditor--active":l||!c})},this.renderInput({placeholder:p}),m.a.createElement("div",{className:"CommentEditor-actions"},m.a.createElement(_.c,{preset:"plain",onClick:r},"取消"),m.a.createElement(_.c,{preset:"primary",color:"blue",onClick:this.onSubmit,disabled:c},"评论")))}var d="写下你的评论...";n&&(d=i?"已开启预审评论，评论由品牌筛选后公开":a?"已开启预审评论，评论由机构筛选后公开":"评论由作者筛选后显示");h()(o,"CommentEditor--normal"),this.state.shown;var f={preset:"primary",color:"blue",children:"评论",disabled:c};return m.a.createElement("div",{className:h()(o,"CommentEditor--normal",{"CommentEditor--active":l||!c})},this.renderInput({placeholder:d}),m.a.createElement(_.c,q({},f,{className:"CommentEditor-singleButton",onClick:this.onSubmit})))}}]),t}(),a.contextTypes={authRequired:u.a.func},r=i))||r)||r);Y.defaultProps={defaultActive:!1,replyTo:null,inCommentItem:!1,autoFocus:!0,ownerAuthorIsOrg:!1,ownerAuthorIsBrand:!1},Y.propTypes={className:u.a.string,defaultActive:u.a.bool,replyTo:u.a.object,inCommentItem:u.a.bool,commentNeedsReview:u.a.bool,canComment:u.a.object,onCancel:u.a.func,onSubmit:u.a.func.isRequired};var $,Z,X,J,ee=Y,te=n(2502),ne=n(2818),oe=n(1996),re=n(1816),ae=n(1551),ie=n(2819),se=n(2820),le=n(2374),ce=n(2430),ue=(n(38),n(1640),n(384)),pe=n(10),me=n(206),de=n(1581),fe=n(133),he=n(1625),ve=n(73),ye=n(445),be=(n(2640),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),ge=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function we(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Ce,Ee,Oe=($=Object(d.connect)(function(e){return{edition:Object(R.d)(e),referer:Object(R.g)(e),isWechat:e.env.userAgent.Wechat}}),Object(A.withRouter)(Z=$((J=X=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=we(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={reportModalShown:!1,isReplying:!1,collapsed:!0,guideShown:!1},o.getRedirectUrl=function(){var e=o.props.parent;switch(e.type){case"answer":return"/question/"+e.question.id+"/answer/"+e.id;case"article":return"https://zhuanlan.zhihu.com/p/"+e.id;default:return""}},o.like=o.context.authRequired(function(e){var t=o.props;(0,t.onLike)(t.comment.id,e)},pe.N.like,T.b),o.dislike=o.context.authRequired(function(){var e=o.props;(0,e.onDislike)(e.comment.id)},pe.N.like,T.b),o.delete=function(){var e=o.props;(0,e.onDelete)(e.comment.id)},o.feature=function(){var e=o.props;(0,e.onFeature)(e.comment.id)},o.collapse=function(){var e=o.props;(0,e.onCollapse)(e.comment.id)},o.approve=function(){var e=o.props;(0,e.onApprove)(e.comment.id)},o.showConversation=function(){var e=o.props;(0,e.onShowConversation)(e.comment.id)},o.startReply=o.context.authRequired(function(){o.setState({isReplying:!0})},void 0,T.b),o.stopReply=function(){o.setState({isReplying:!1})},o.openReportModal=o.context.authRequired(function(){o.setState({reportModalShown:!0})}),o.closeReportModal=function(e){if(e){var t=e.result.payload,n=t&&t.message||t&&t.code&&"举报失败";e.commentDeleteResult&&!(e.commentDeleteResult.payload||{}).code?he.b.showModal({reportText:n}):Object(ve.b)(n||"举报成功")}o.setState({reportModalShown:!1})},o.handleExpand=function(){o.setState({collapsed:!1})},o.handleToggleGuide=function(){o.setState({guideShown:!o.state.guideShown})},o.handleDelete=function(){return o.setState({deleteModal:!0})},o.handleCloseDelete=function(){return o.setState({deleteModal:!1})},we(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p["PureComponent"]),ge(t,[{key:"renderRoleInfo",value:function(e,t){return"normal"===e?null:m.a.createElement("span",{className:"CommentItem-roleInfo"},"ancestor"===e||"author"===e&&"question"===t?" (提问者) ":" (作者) ")}},{key:"renderReplyTo",value:function(){var e=this.props.comment,t=e.replyToAuthor,n=e.resourceType;if(!t)return null;var o=t.member,r=void 0===o?{}:o,a=t.role;return m.a.createElement("span",null,m.a.createElement("span",{className:"CommentItem-reply"},"回复"),m.a.createElement(fe.a,{className:h()({"CommentItem-userLink":!1}),noBadge:!0,noHoverCard:!0,user:r}),this.renderRoleInfo(a,n))}},{key:"renderInner",value:function(){var e=this,t=this.props,n=t.comment,o=n.isDelete,r=n.collapsed,a=t.isConversation,i=t.ownerAuthorIsOrg;t.edition;if(o)return a?m.a.createElement("div",{className:"CommentItem-deletedContent"},"这里有一条已删除的评论"):null;if(r&&a&&this.state.collapsed)return m.a.createElement("div",{className:"CommentItem-deletedContent"},"这里有一条已折叠的评论，",m.a.createElement(_.c,{preset:"plain",onClick:this.handleExpand},"查看"));var s=this.state,l=s.reportModalShown,c=s.isReplying,u=this.props,p=u.parent,d=p.canComment,f=(d=void 0===d?{status:!0}:d).status,v=p.questionType,y=u.commentNeedsReview,b=u.comment,g=u.onReply,w=u.status,C=u.type,E=u.canOperate,O=u.commentPattern,k=u.isMobile,P=b.id,S=b.author,j=b.content,N=b.voteCount,T=b.replyToAuthor,R=b.isAuthor,I=b.isParentAuthor,x=b.createdTime,L=b.featured,A=b.voting,M=b.reviewing,B=b.disliked,D=b.resourceType,F=b.collapsedReason,z=void 0===F?"":F,V=S||{},U=V.member,q=V.role,W=void 0;if(c)W=m.a.createElement(ee,{type:"comment",id:P,commentNeedsReview:y,className:"CommentItem-editor",defaultActive:!0,replyTo:b,onCancel:this.stopReply,onSubmit:g});else if("reviewing"===w)W=m.a.createElement("div",{className:"CommentItem-footer"},m.a.createElement(_.c,{preset:"plain",onClick:this.approve},m.a.createElement(te.a,{style:{marginRight:5},center:!0,size:14}),"公开"),m.a.createElement(_.c,{className:h()({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.handleDelete},m.a.createElement(ne.a,{style:{marginRight:5},center:!0,size:16}),"删除"));else{var H=R||I&&("question"!==C||"commercial"===v);W=m.a.createElement("div",{className:h()("CommentItem-footer",{"CommentItem-mobileFooter":!1})},m.a.createElement(_.c,{className:h()("CommentItem-likeBtn",A&&"is-liked"),preset:"plain",onClick:this.like,disabled:R},m.a.createElement(oe.a,{style:{marginRight:5},center:!0,size:16}),N>0?N:"赞"),r&&z&&m.a.createElement("div",{className:"CommentItem-walleTag"},"阴阳怪气自动折叠"===z&&m.a.createElement(re.a,{size:16,className:"CommentItem-walleIcon"}),z),!a&&T&&m.a.createElement(_.c,{preset:"plain",className:"CommentItem-talkBtn",onClick:this.showConversation},m.a.createElement(ae.a,{style:{marginRight:5},center:!0,size:16}),"查看对话"),!a&&!R&&f&&!r&&m.a.createElement(_.c,{preset:"plain",className:h()({"CommentItem-hoverBtn":!0}),onClick:this.startReply},m.a.createElement(ie.a,{style:{marginRight:5},center:!0,size:16}),"回复"),I&&E&&!k&&m.a.createElement(_.c,{className:h()({"CommentItem-hoverBtn":!R}),preset:"plain",onClick:this.feature},m.a.createElement(se.a,{style:{marginRight:5},center:!0,size:16}),L?"取消推荐":"推荐"),I&&E&&!k&&m.a.createElement(_.c,{className:h()({"CommentItem-hoverBtn":!R}),preset:"plain",onClick:this.collapse},m.a.createElement(le.a,{style:{marginRight:5},center:!0,size:14}),r?"取消折叠":"折叠"),!I&&!R&&E&&!k&&m.a.createElement(_.c,{className:h()({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.dislike},m.a.createElement(oe.a,{style:{transform:"rotate(180deg)",marginRight:5},size:16,center:!0}),B?"取消踩":"踩"),R||m.a.createElement(_.c,{className:h()({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.openReportModal},m.a.createElement(ce.a,{style:{marginRight:5},center:!0,size:16}),"举报"),H&&m.a.createElement(_.c,{className:h()({"CommentItem-hoverBtn":!R}),preset:"plain",onClick:this.handleDelete},m.a.createElement(ne.a,{style:{marginRight:5},center:!0,size:16}),"删除"),!1,!1,m.a.createElement(he.a,{shown:this.state.deleteModal,id:P,onDelete:this.delete,onClose:this.handleCloseDelete}),m.a.createElement(me.a,be({type:"comment",urlToken:P,shown:l,onClose:this.closeReportModal},H&&{onDeleteComment:function(){return e.props.onDelete(P)}},{notification:{failure:ye.a},zaEnabled:!0})))}return m.a.createElement("div",null,m.a.createElement("div",{className:"CommentItem-meta"},U&&m.a.createElement(fe.a,{className:"CommentItem-avatar",avatar:!0,noHoverCard:"fixed"===O,user:U}),U&&m.a.createElement(fe.a,{className:h()({"CommentItem-userLink":!1}),noBadge:!0,noHoverCard:!0,user:U}),this.renderRoleInfo(q,D),this.renderReplyTo(),M&&m.a.createElement(le.a,{className:"CommentItem-reviewing","data-tooltip":!1===i?"评论未公开，由作者筛选后显示":"已开启预审评论，评论由机构筛选后公开",center:!0,size:14}),m.a.createElement("span",{className:"CommentItem-time"},Object(ue.toRelativeString)(x))),m.a.createElement(de.a,{className:"CommentItem-content",html:j}),W)}},{key:"render",value:function(){var e=this.renderInner(),t=this.props,n=t.parent;n.type,n.id,t.isWechat,t.edition,t.referer,t.location.query;return e&&m.a.createElement("div",{className:"CommentItem",ref:this.props.onRef},e,!1)}}]),t}(),X.propTypes={comment:u.a.object.isRequired,parent:u.a.object.isRequired,commentNeedsReview:u.a.bool,type:u.a.string,isConversation:u.a.bool,onLike:u.a.func.isRequired,onShowConversation:u.a.func,onReply:u.a.func,onFeature:u.a.func,onDelete:u.a.func.isRequired,onCollapse:u.a.func,commentPattern:u.a.string,isMobile:u.a.bool},X.contextTypes={currentUser:u.a.object,authRequired:u.a.func},Z=J))||Z)||Z),ke=n(2150),Pe=n(1904),Se=(n(2644),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}()),_e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function je(e,t){switch(e){case"answer":return Object(I.m)(t);case"article":return Object(x.b)(t);default:return null}}var Ne,Te,Re=(Ee=Ce=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.state={collapsed:!0,current:1,packupButtonStatus:!1,packupButtonLeft:0},o.handleOpenCollapsed=function(){o.setState({collapsed:!1}),o.load(o.props,!1,!0)},o.createOnRef=C()(function(e){return function(t){var n=o.props.byComment;e===Number(n)&&(o.targetCommentEl=t)}}),o.handlePageSelect=function(e){var t=o.props.onPaginationClick,n=o.state.current;t&&t(n,e),o.commentsElement.scrollIntoView(),o.setState({current:e}),o.loadByPagination(e)},o.renderComment=function(e){var t=o.props,n=t.parent,r=n.type,a=n.author,i=(a=void 0===a?{isOrg:!1}:a).isOrg,s=t.isMobile,l=t.parent,c=t.commentNeedsReview,u=t.onShowConversation,p=t.status,d=t.onItemLike,f=t.onItemDelete,h=t.onItemCollapse,v=t.onItemDislike,y=t.onItemApprove,b=t.canOperateItem,g=t.commentPattern;return m.a.createElement(Oe,{key:e.id,isMobile:s,comment:e,onRef:o.createOnRef(e.id),status:p,type:r,parent:l,canOperate:b,commentNeedsReview:c,onShowConversation:u,ownerAuthorIsOrg:i,onLike:d,onReply:o.addComment,onFeature:o.featureItem,onDelete:f,onCollapse:h,onDislike:v,onApprove:y,commentPattern:g})},o.renderNormalComments=function(e){var t=o.state.collapsed,n=o.props.byComment,r=[];if(o.lastFeaturedIndex=0,e.length>0){var a=e[0].featured,i=!1;e.forEach(function(s,l){if(n||!s.collapsed){var c=e[l-1];if(!s.collapsed||(c&&c.collapsed||r.push(o.renderCollapsedDivider()),!t)){r.push(o.renderComment(s));var u=e[l+1];a&&!i&&s.featured&&(!u||!u.featured)&&(i=!0,o.lastFeaturedIndex=l,r.push(m.a.createElement("div",{className:"CommentList-divider",key:"divider-featured"},m.a.createElement("div",{className:"CommentList-dividerLine"}),m.a.createElement("div",{className:"CommentList-dividerText"},"以上为精选评论",m.a.createElement(E.a,{className:"CommentList-questionMark","data-tooltip":"精选评论包含回答作者推荐的评论和部分高赞评论",center:!0,size:16})))))}}})}return r},o.renderCollapsedComments=function(){var e=[],t=o.props.collapsedComments;return o.state.collapsed||!t||t.length<=0?[]:(e.push(t.map(function(e){return o.renderComment(e)})),e)},o.renderComments=function(e){return e.map(o.renderComment)},o.renderBottomButton=function(){var e=o.props,t=e.params,n=t.id,r=t.answerId,a=e.location.query,i=e.edition,s=e.referer,l=Boolean(r);return m.a.createElement("div",{className:"Comments-footer CommentEditor--normal"},m.a.createElement(_.c,{className:"CommentEditor-startCommentButton",preset:"primary",color:"blue",onClick:function(e){return Object(k.b)(e,{href:Object(N.a)(l?{type:"answer",id:r}:{type:"question",id:n},{edition:i,query:a,referer:s,utm_content:"comment_area"}),zaProps:{id:3906}})}},"打开 App 参与站内讨论"))},o.load=o.load.bind(o),o.loadByPagination=o.loadByPagination.bind(o),o.addComment=o.addComment.bind(o),o.featureItem=o.featureItem.bind(o),o.handleScroll=o.handleScroll.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p["Component"]),Se(t,[{key:"componentDidMount",value:function(){this.subscription=Object(g.subscribe)("scroll",this.handleScroll);var e=this.props,t=e.byComment,n=e.commentPattern,o=e.parent.adminClosedComment,r=this.state.current;t&&this.scrollToTarget(),"bottom"!==n||o||(this.loadByPagination(r),this.commentsWithPaginationEl&&this.setState({packupButtonLeft:this.commentsWithPaginationEl.getBoundingClientRect().right-16}))}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,o=t.status,r=t.targetComment,a=t.commentPattern;n===e.order&&o===e.status||("bottom"===a?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;!r&&i&&this.setState({collapsed:!i.collapsed})}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(T.e)(T.b)),this.subscription&&this.subscription.unsubscribe()}},{key:"load",value:function(e,t,n){if(!this.props.isFetching&&!this.props.parent.adminClosedComment){var o=e||this.props,r=o.order,a=o.byComment,i=o.status,s=o.parent,l=s.id,c=s.type,u=o.dispatch,p=o.commentPattern;if(o.needLoadCommentPermission&&je(c,l)&&u(je(c,l)),n){u(Object(v.e)(c,l,{order:r,isPrevious:t,byComment:a,status:"collapsed",commentPattern:p},!0))}else u(Object(v.e)(c,l,{order:r,isPrevious:t,byComment:a,status:i,commentPattern:p}))}}},{key:"addComment",value:function(e,t){var n=this.props,o=n.parent,r=o.id,a=o.type,i=n.dispatch,s=[a,r,e];return t&&(s[3]=t.id),i(v.a.apply(void 0,s))}},{key:"featureItem",value:function(e){this.props.onItemFeature(e,this.lastFeaturedIndex)}},{key:"handleScroll",value:function(){if(this.commentsElement&&this.commentsWithPaginationEl){var e=window.innerHeight,t=this.state.packupButtonStatus,n=this.commentsWithPaginationEl.getBoundingClientRect(),o=n.top,r=n.bottom,a=n.height;!t&&a>500&&r>e&&o<0?this.setState({packupButtonStatus:!0}):t&&(a<=500||r<=e||o>=0)&&this.setState({packupButtonStatus:!1})}}},{key:"scrollToTarget",value:function(){var e=this.targetCommentEl,t=this.listEl;if(t&&e){var n=e.getBoundingClientRect(),o=n.top,r=n.height,a=t.getBoundingClientRect(),i=a.top,s=a.height;this.listEl.scrollTop+=o-i-(s-r)/2,e.classList.add("CommentItem--highlighted"),setTimeout(function(){return e.classList.remove("CommentItem--highlighted")},2e3),e.tabIndex=-1,e.focus()}}},{key:"loadByPagination",value:function(e,t){var n=t||this.props,o=n.order,r=n.byComment,a=n.status,i=n.parent,s=i.id,l=i.type,c=n.dispatch,u=n.commentPattern;n.needLoadCommentPermission&&je(l,s)&&c(je(l,s)),c(Object(v.e)(l,s,{order:o,isPrevious:!1,byComment:r,status:a,commentPattern:u,current:e}))}},{key:"renderCollapsedDivider",value:function(){var e=this.props,t=e.isDrained,n=e.parent.collapsedCounts;return!t||n<=0?[]:this.state.collapsed?m.a.createElement("div",{className:"CommentList-action",key:"collapsed"},m.a.createElement("div",{className:"CommentList-expendCollapseButton"},m.a.createElement("span",{onClick:this.handleOpenCollapsed},Object(j.formatNumber)(n)," 条评论被折叠"),"（",m.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):m.a.createElement("div",{className:"CommentList-divider",key:"divider-collapsed"},m.a.createElement("div",{className:"CommentList-dividerLine"}),m.a.createElement("div",{className:"CommentList-dividerText"},Object(j.formatNumber)(n)," 条评论被折叠（",m.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))}},{key:"renderCollapsedInfiLoader",value:function(){var e=this,t=this.state.collapsed;if(t)return[];var n=this.props.collapsedInfo,o=(n=void 0===n?{}:n).isFetching,r=n.isPrevDrained,a=n.isDrained;return m.a.createElement(P.b,{className:"CommentList",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:o,isPrevDrained:r,isDrained:a,onLoad:function(n){return e.load(e.props,n,!t)},placeholder:m.a.createElement(P.a,{className:"CommentItem",small:!0})},this.renderCollapsedComments())}},{key:"renderPatternContent",value:function(e){var t=this,n=this.props,o=n.isFetching,r=n.parent.adminClosedComment,a=n.byComment,i=n.status,s=n.order,l=n.totals,c=n.showPackupButton,u=n.handlePackupButton,p=Math.ceil(l/20),d=this.state,f=d.current,h=d.packupButtonStatus,v=d.packupButtonLeft;return r?null:o?m.a.createElement(ke.a,{onRef:function(e){t.commentsWithPaginationEl=e}}):m.a.createElement("div",{ref:function(e){t.commentsWithPaginationEl=e}},m.a.createElement("div",{className:"CommentList"},"normal"===s&&"open"===i?this.renderNormalComments(e):this.renderComments(e)),p>1&&m.a.createElement(S.a,{className:"comments-pagination",current:f,total:p,onSelect:this.handlePageSelect}),!a&&this.renderCollapsedDivider(),!a&&this.renderCollapsedInfiLoader(),m.a.createElement(y.CSSTransitionGroup,{transitionName:"Comments-Packup-Button",transitionEnterTimeout:300,transitionLeaveTimeout:300},c&&h&&m.a.createElement("button",{onClick:u,className:"Comments-Packup-Button",style:{left:v}},"收起评论",m.a.createElement(O.a,{center:!0}))))}},{key:"renderModalContent",value:function(e){var t=this,n=this.props,o=n.collapsedInfo,r=n.parent.adminClosedComment,a=n.status,i=n.order,s=n.byComment,l=this.state.collapsed,c=l?this.props:o,u=c.isFetching,p=c.isDrained,d=c.isPrevDrained;if(p&&e.length<=0||r)return m.a.createElement("div",{className:"Comments-empty"},m.a.createElement(L.a,{entityType:"comments"}));var f={getContainer:function(e){return e}};return m.a.createElement(P.b,_e({className:"CommentList",onRef:function(e){t.listEl=e},isLocal:!0,isLoading:u,isPrevDrained:d,isDrained:p,onLoad:function(e){return t.load(t.props,e,!l)},placeholder:m.a.createElement(P.a,{className:"CommentItem",small:!0})},f),"normal"===i&&"open"===a?this.renderNormalComments(e):this.renderComments(e),!s&&this.renderCollapsedDivider(),!s&&this.renderCollapsedComments())}},{key:"renderCommentEdit",value:function(e){var t=this.props,n=t.parent,o=n.canComment,r=(o=void 0===o?{status:!0}:o).status,a=o.reason,i=n.author,s=(i=void 0===i?{isOrg:!1}:i).isOrg,l=n.type,c=n.id,u=n.adminClosedComment,p=n.questionType,d=t.byComment,f=t.autoFocus,v=t.commentNeedsReview,y=u?"当前内容暂时无法评论":a,g=f&&!d;return r&&!u?m.a.createElement(ee,_e({className:"Comments-"+("top"===e?"top":"footer"),type:l,id:c,commentNeedsReview:v,onSubmit:this.addComment,autoFocus:g,ownerAuthorIsOrg:s,ownerAuthorIsBrand:"commercial"===p},"top"===e&&{preset:"default",onClick:function(e){b.default.trackEvent(e.target,{id:3905})}})):"top"!==e&&m.a.createElement("div",{className:h()("Comments-disabledText",{"Comments-disabledText--fixed":!1})},m.a.createElement("div",{className:"Comments-disabledReason"},y))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.isAuthor,r=t.comments,a=t.commentPattern,i=t.commentInputPosition,s=t.parent,l=s.canComment,c=(l=void 0===l?{status:!0}:l).status,u=s.author,p=(u=void 0===u?{isOrg:!1}:u).isOrg,d=s.commentPermission,f=s.reviewingCounts,v=s.commentCount,y=s.adminClosedComment,b=t.totals,g=t.status,w=t.order,C=t.onStatusChange,E=t.onOrderChange,O=t.targetLink,k=t.isBaidu,P=r.filter(function(e){return!e.isDelete}),S="censor"===d&&o,_=S?{isCommentReviewer:S,onStatusChange:C,status:g,reviewingCounts:f}:{status:g},j=h()({Comments:!0,"Comments--withEditor":!0,"Comments-withPagination":"bottom"===a},n);return m.a.createElement("div",{className:j,ref:function(t){e.commentsElement=t}},m.a.createElement(Pe.a,_e({commentCount:void 0!==v?v:b,commentClosed:y,targetLink:O,order:w,onOrderChange:E,commentPattern:a,isOrg:p,isBaidu:k,options:this.renderCommentEdit("top")},_)),"top"===i&&this.renderCommentEdit(),"bottom"===a?this.renderPatternContent(P):this.renderModalContent(P),"bottom"===i&&(!k||!c)&&this.renderCommentEdit(),"bottom"===i&&k&&c&&this.renderBottomButton())}}]),t}(),Ce.propTypes={type:u.a.string,parent:u.a.object.isRequired,targetLink:u.a.node,commentNeedsReview:u.a.bool,byComment:u.a.oneOfType([u.a.number,u.a.string]),commentPattern:u.a.string,commentInputPosition:u.a.oneOf(["top","bottom"]),showPackupButton:u.a.bool,handlePackupButton:u.a.func,onPaginationClick:u.a.func,autoFocus:u.a.bool},Ce.contextTypes={authRequired:u.a.func.isRequired},Ce.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0},Ee),Ie=Object(d.connect)(function(e,t){var n=t.parent,o=t.parent,r=o.type,a=o.id,i=t.status,s=t.order,l=t.byComment,c=t.commentPattern,u=e.entities,p=e.comments,m=e.env.userAgent.BaiduApp,d=r+"_"+a,f=p.parent,h=p.pagination;"reviewing"===i&&(h=p.reviewing),"reverse"===s&&"open"===i&&(h=p.reverse);var v=[],y=p.collapsed[d]||{};y.ids&&y.ids.length>0&&(v=y.ids.map(function(e){return u.comments[e]}));var b=h[d]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},g=b.isFetching,w=b.isPrevDrained,C=b.isDrained,E=b.ids,O=b.newIds,k=void 0===O?[]:O,P=b.totals,S=("bottom"!==c?E:k).map(function(e){return u.comments[e]}),_=Object(R.d)(e);return{isFetching:g,isPrevDrained:w,isDrained:C,totals:P,comments:S,collapsedInfo:y,collapsedComments:v,targetComment:u.comments[l],parent:_e({},n,f[d]),isBaidu:m||_.baidu||_.baiduBeijing,referer:Object(R.g)(e),edition:_}})(Re),xe=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Le,Ae,Me,Be,De=(Te=Ne=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.load=o.load.bind(o),o.addComment=n.authRequired(o.addComment.bind(o),void 0,T.b),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p["Component"]),xe(t,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){this.props.dispatch(Object(v.f)(this.props.commentId))}},{key:"addComment",value:function(e,t){var n=this.props,o=n.parent,r=o.type,a=o.id,i=n.commentId,s=n.dispatch,l=[r,a,e,t.id,i];return s(v.a.apply(void 0,l))}},{key:"render",value:function(){var e=this.props,t=e.onItemLike,n=e.onItemDelete,o=e.onItemFeature,r=e.onItemApprove,a=e.onItemCollapse,i=e.onItemDislike,s=e.onNavBack,l=e.canOperateItem,c=e.isFetching,u=e.comments,p=e.commentNeedsReview,d=e.openComment.collapsed,f=e.parent,h=e.parent.canComment,v=(h=void 0===h?{status:!0}:h).status,y=h.reason,b=e.commentPattern,g=e.commentId,w=this.context.currentUser,C=void 0,E=void 0;Boolean(w&&u.find(function(e){return e.author&&e.author.member.urlToken===w.urlToken}))&&(E=(C=u.filter(function(e){return e.author&&e.author.member.urlToken!==w.urlToken}))[C.length-1]);var O=void 0;return c&&!u.length?O=m.a.createElement(P.a,{className:"CommentItem",small:!0}):u.length&&(O=u.map(function(e,s){return m.a.createElement(Oe,{key:s,isConversation:!0,commentNeedsReview:p,canOperate:l,parent:f,comment:e,onLike:t,onDelete:n,onFeature:o,onApprove:r,onCollapse:a,onDislike:i,collapsedShown:d})})),"bottom"===b?m.a.createElement(z.b,{size:"fullPage",onClose:s},m.a.createElement("div",{className:"Comments"},m.a.createElement(Pe.a,{isConversation:!0,commentPattern:b}),m.a.createElement("div",{className:"CommentList"},O))):m.a.createElement("div",{className:"Comments"},m.a.createElement(Pe.a,{isConversation:!0,onNavBack:s}),m.a.createElement("div",{className:"CommentList"},O),E&&(v?m.a.createElement(ee,{id:g,type:"conversation",className:"Comments-footer",replyTo:E,commentNeedsReview:p,onSubmit:this.addComment}):m.a.createElement("div",{className:"Comments-disabledText"},y)))}}]),t}(),Ne.propTypes={commentId:u.a.number.isRequired,type:u.a.string,parent:u.a.object.isRequired,commentNeedsReview:u.a.bool},Ne.contextTypes={currentUser:u.a.object,authRequired:u.a.func.isRequired},Te),Fe=Object(d.connect)(function(e,t){var n=t.commentId,o=e.entities.comments,r=e.comments.conversation[n]||{isFetching:!1,isDrained:!1,ids:[]};return{isFetching:r.isFetching,isDrained:r.isDrained,comments:r.ids.map(function(e){return o[e]}),openComment:o[n]}})(De),ze=n(205),Ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ue=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var qe=Object(ze.a)(null)((Me=Ae=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));Be.call(n);var o=e.parent,r=e.dispatch;return n.feature=function(e,t){return r(Object(v.i)(e,o.id,o.type,t))},n.delete=function(e){return r(Object(v.d)(e,o.type,o.id))},n.showConversation=function(e){return n.setState({openedCommentId:e})},n.showComments=function(){return n.setState({openedCommentId:null})},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p["Component"]),Ue(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.domNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.parent,o=t.commentPattern,r=t.type,a=t.parent,i=(a=void 0===a?{}:a).commentPermission,s=a.relationship,l=void 0===s?{}:s,c=a.author,u=void 0===c?{}:c,p=t.needLoadCommentPermission,d=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["parent","commentPattern","type","parent","needLoadCommentPermission"]),f=this.context.currentUser,v=void 0===l.isAuthor?f&&u.urlToken&&f.urlToken===u.urlToken:l.isAuthor,y="censor"===i&&!v,b="answer"===r||"article"===r,g=this.state,w=g.openedCommentId,C=g.status,E=g.order,O={commentNeedsReview:y,parent:n,type:r,canOperateItem:b,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve};return m.a.createElement("div",{className:"Comments-container",ref:function(t){return e.domNode=t}},m.a.createElement(Ie,Ve({},d,O,{commentPattern:o,className:h()({"Comments--hidden":w&&"bottom"!==o}),order:E,status:C,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:p,isAuthor:v})),w&&m.a.createElement(Fe,Ve({},d,O,{commentPattern:o,commentId:w,onNavBack:this.showComments})))}}]),t}(),Ae.propTypes={type:u.a.string.isRequired,parent:u.a.object.isRequired,onOrderChange:u.a.func,onItemLike:u.a.func,isAuthor:u.a.bool,onMount:u.a.func},Ae.defaultProps={type:"answer"},Ae.contextTypes={currentUser:u.a.object,authRequired:u.a.func.isRequired},Be=function(){var e=this;this.state={openedCommentId:null,status:"open",order:"normal"},this.like=function(t,n){var o=e.props,r=o.onItemLike,a=o.dispatch;r&&r(t,n),a(Object(v.j)(t))},this.collapse=function(t){var n=e.props,o=n.dispatch,r=n.parent;o(Object(v.g)(t,r.type,r.id))},this.dislike=function(t){return e.props.dispatch(Object(v.h)(t))},this.approve=function(t){var n=e.props,o=n.dispatch,r=n.parent,a=n.type;o(Object(v.b)(t,r.type||a,r.id))},this.handleStatusChange=function(t){e.setState({status:t})},this.handleOrderChange=function(t,n){e.props.onOrderChange&&e.props.onOrderChange(t,n),e.setState({order:t})}},Le=Me))||Le;t.default=Object(d.connect)()(qe)}}]);
//# sourceMappingURL=main.modals.a7f5d6e9c0ab7dc3e26f.js.map